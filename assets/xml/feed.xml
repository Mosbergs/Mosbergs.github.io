<feed xmlns="http://www.w3.org/2005/Atom">
  <generator uri="https://jekyllrb.com/" version="4.2.0">Jekyll</generator>
  <link href="https://fabricmc.net/feed.xml" rel="self" type="application/atom+xml"/>
  <link href="https://fabricmc.net/" rel="alternate" type="text/html"/>
  <updated>2025-12-05T09:58:07+00:00</updated>
  <id>https://fabricmc.net/feed.xml</id>
  <title type="html">Fabric</title>
  <subtitle>The home of the Fabric mod development toolchain.</subtitle>
  <entry>
    <title type="html">Fabric for Minecraft 1.21.11</title>
    <link href="https://fabricmc.net/2025/12/05/12111.html" rel="alternate" type="text/html" title="Fabric for Minecraft 1.21.11"/>
    <published>2025-12-05T00:00:00+00:00</published>
    <updated>2025-12-05T00:00:00+00:00</updated>
    <id>https://fabricmc.net/2025/12/05/12111</id>
    <content type="html" xml:base="https://fabricmc.net/2025/12/05/12111.html">
      <p>A new version of Minecraft is coming soon with some changes that affect most mod makers. As always, <strong>we ask all players to be patient, and give mod developers time to update to this new version</strong>. We kindly ask everyone not to pester them. <strong>We also recommend all players make backups of their worlds</strong>.
      </p>
      <p>As you may be aware, we expect <a href="https://www.minecraft.net/en-us/article/removing-obfuscation-in-java-edition">1.21.11 to be the last version of Minecraft that is obfuscated</a>. The next snapshot will be the first version of Minecraft that will <strong>not</strong> be obfuscated.</p>
      <p>Mojang have also recently announced that they will be <a href="https://www.minecraft.net/en-us/article/minecraft-new-version-numbering-system">changing how the game is versioned</a>. The next version will be known as <code class="language-plaintext highlighter-rouge">26.1</code>. This new versioning nicely lines up with the unobfuscation process, as <code class="language-plaintext highlighter-rouge">1.21.11</code> will be the last obfuscated version.</p>
      <p>Here is a list of several major modder-facing changes in this version. Note that all code references are using Mojang’s mappings; modders using alternative mappings, including our previously default Yarn mappings, may need to use different names.</p>
      <h2 id="fabric-changes">Fabric changes</h2>
      <p>Developers should use Loom 1.14 (at the time of writing) to develop mods for Minecraft 1.21.11. Players should install the latest stable version of Fabric Loader (currently 0.18.1).</p>
      <h3 id="world-render-events">World Render Events</h3>
      <p>The World Render Events were recently reintroduced into Fabric API for 1.21.10. Mods that required them to port can now do so. The new World Render Events are intended to match with recent changes to Minecraft itself, focusing on separating extraction from rendering.</p>
      <p>Rendering in the world has been documented on the <a href="https://docs.fabricmc.net/develop/rendering/world">Fabric Docs</a>.
      </p>
      <h3 id="packet-splitter-and-recipe-sync-api">Packet Splitter and Recipe Sync API</h3>
      <p>Fabric now offers an opt-in packet splitter, allowing for mods that have packets that would exceed the size of a vanilla one to easily be split between multiple packets.</p>
      <p>Implementing the packet splitter is simple - use the new <code class="language-plaintext highlighter-rouge">registerLarge</code> method when registering your packet.</p>
      <div class="language-java highlighter-rouge">
        <div class="highlight">
          <pre class="highlight">
            <code>
              <span class="nc">PayloadTypeRegistry</span>
              <span class="o">.</span>
              <span class="na">playS2C</span>
              <span class="o">().</span>
              <span class="na">registerLarge</span>
              <span class="o">(</span>
              <span class="nc">YourPayload</span>
              <span class="o">.</span>
              <span class="na">ID</span>
              <span class="o">,</span>
              <span class="nc">YourPayload</span>
              <span class="o">.</span>
              <span class="na">CODEC</span>
              <span class="o">,</span>
              <span class="no">DATA_SIZE</span>
              <span class="o">);</span>
            </code>
          </pre>
        </div>
      </div>
      <p>Thanks to this API, Fabric also now offers a way for mods to synchronize recipes from the server to the client, comparable to the behavior prior to 1.21.1. This API has already been adopted by recipe viewers like JEI, but means that recipe viewers are required on the server.</p>
      <div class="language-java highlighter-rouge">
        <div class="highlight">
          <pre class="highlight">
            <code>
              <span class="nc">RecipeSynchronization</span>
              <span class="o">.</span>
              <span class="na">synchronizeRecipeSerializer</span>
              <span class="o">(</span>
              <span class="nc">YourRecipeSerializers</span>
              <span class="o">.</span>
              <span class="na">RECIPE_TYPE</span>
              <span class="o">);</span>
            </code>
          </pre>
        </div>
      </div>
      <h2 id="minecraft-changes">Minecraft changes</h2>
      <p>The following section details a few of the more notable changes to Minecraft that affected the Fabric API.</p>
      <h3 id="game-rules">Game rules</h3>
      <p>Game rules were refactored to use the Registry system; Mods should now use the new <code class="language-plaintext highlighter-rouge">GameRuleBuilder</code> API to create and register custom game rules.</p>
      <div class="language-java highlighter-rouge">
        <div class="highlight">
          <pre class="highlight">
            <code>
              <span class="kd">public</span>
              <span class="kd">static</span>
              <span class="kd">final</span>
              <span class="nc">GameRule</span>
              <span class="o">&lt;</span>
              <span class="nc">Boolean</span>
              <span class="o">&gt;</span>
              <span class="no">EXAMPLE</span>
              <span class="o">=</span>
              <span class="nc">GameRuleBuilder</span>
              <span class="o">.</span>
              <span class="na">forBoolean</span>
              <span class="o">(</span>
              <span class="kc">true</span>
              <span class="o">)</span>
              <span class="o">.</span>
              <span class="na">buildAndRegister</span>
              <span class="o">(</span>
              <span class="nc">Identifier</span>
              <span class="o">.</span>
              <span class="na">fromNamespaceAndPath</span>
              <span class="o">(</span>
              <span class="s">"fabric"</span>
              <span class="o">,</span>
              <span class="s">"example"</span>
              <span class="o">));</span>
            </code>
          </pre>
        </div>
      </div>
      <p>The above snippet creates and registers a new boolean game rule with the default value of <code class="language-plaintext highlighter-rouge">true</code>. The <code class="language-plaintext highlighter-rouge">GameRuleBuilder</code> API provides the following factory methods <code class="language-plaintext highlighter-rouge">forInteger</code>,        <code class="language-plaintext highlighter-rouge">forDouble</code>,        <code class="language-plaintext highlighter-rouge">forBoolean</code>, and <code class="language-plaintext highlighter-rouge">forEnum</code> to create game rules of different types. The builder also allows for additional configuration such as setting the category, required features and command result suppiler.</p>
      <p>The new version of Fabric API also includes a <code class="language-plaintext highlighter-rouge">GameRuleEvents</code> class that provides an event for listening to game rule changes. Mods can use this event to perform actions when a game rule is changed.</p>
      <div class="language-java highlighter-rouge">
        <div class="highlight">
          <pre class="highlight">
            <code>
              <span class="nc">GameRuleEvents</span>
              <span class="o">.</span>
              <span class="na">changeCallback</span>
              <span class="o">(</span>
              <span class="nc">GameRules</span>
              <span class="o">.</span>
              <span class="na">FIRE_DAMAGE</span>
              <span class="o">).</span>
              <span class="na">register</span>
              <span class="o">((</span>
              <span class="n">value</span>
              <span class="o">,</span>
              <span class="n">server</span>
              <span class="o">)</span>
              <span class="o">-&gt;</span>
              <span class="o">{</span>
              <span class="c1">// Your code here</span>
              <span class="o">});</span>
            </code>
          </pre>
        </div>
      </div>
      <h3 id="environment-attributes">Environment Attributes</h3>
      <p>The Biome Modification API has been updated to support the new Environment Attributes system. Mods can now modify environment attributes such as temperature, humidity, and altitude for biomes using the <code class="language-plaintext highlighter-rouge">BiomeModificationContext#AttributesContext</code> class. You can access the attributes context by using the <code class="language-plaintext highlighter-rouge">getAttributes()</code> method on the <code class="language-plaintext highlighter-rouge">BiomeModificationContext</code> object.</p>
      <h2 id="an-update-on-unobfuscation">An update on unobfuscation</h2>
      <p>Alongside updating to each 1.21.11 snapshot, Fabric has been working towards <a href="https://fabricmc.net/2025/10/31/obfuscation.html">making this transition as smooth as possible</a>. Currently, Mojang has been releasing experimental unobfuscated versions of Minecraft alongside the obfuscated ones, allowing us to test and prepare for the transition.</p>
      <p>With that in mind, this is a good time to begin <a href="https://docs.fabricmc.net/develop/migrating-mappings/">remapping your mods to the official Mojang Mappings</a>, as Yarn will not be available for the version of Minecraft after 1.21.11. The differences between Mojang mappings and the unobfuscated game do not affect compilation, so switching to Mojang mappings now will allow for an easier transition when porting to future snapshots. There is no immediate rush to do this, as we anticipate the first unobfuscated stable release will be a few months into 2026.</p>
      <p>The unobfuscation process has raised many questions. We’ve answered some of the more common ones here, but please reach out in the Fabric Discord if you have any specific questions.</p>
      <h3 id="is-12111-obfuscated-or-not">Is 1.21.11 obfuscated or not?</h3>
      <p>Yes, 1.21.11 is still obfuscated. The next version of Minecraft after 1.21.11, <a href="https://www.minecraft.net/en-us/article/minecraft-new-version-numbering-system">26.1</a>, will be the first unobfuscated version.</p>
      <h3 id="are-yarn-and-intermediary-still-going-to-be-updated-past-12111">Are Yarn and Intermediary still going to be updated past 1.21.11?</h3>
      <p>No, the plan is to stop updating Yarn and Intermediary after 1.21.11. Modders should begin migrating to Mojang Mappings as soon as possible.</p>
      <h3 id="what-if-i-want-to-use-custom-mappings">What if I want to use custom mappings?</h3>
      <p>You can still opt to use custom mappings, we plan to continue to maintain support for remapping in Loom. However, please be aware that using custom mappings may require additional work to ensure compatibility with the unobfuscated game and other mods.</p>
      <h3 id="will-my-simple-mod-still-work-on-261-without-changes">Will my simple mod still work on 26.1 without changes?</h3>
      <p>No, all mods that interact with Minecraft code will need to be recompiled to be compatible with the unobfuscated version of Minecraft.</p>
      <h3 id="my-mod-is-using-yarn-mappings-how-do-i-migrate">My mod is using Yarn mappings, how do I migrate?</h3>
      <p>We’ve put together an updated article on the <a href="https://docs.fabricmc.net/develop/migrating-mappings/">Fabric Docs site</a> that covers the process of migrating mappings. In short - Loom should be able to handle most mods, and is now able to remap mixins, and third-party tools like Ravel can be used for more complicated projects (like Fabric API itself) or mods using Kotlin.</p>
      <h3 id="what-is-intermediary">What is Intermediary?</h3>
      <p>Intermediary is a project we used to create stable names for Minecraft code across versions. This worked by giving each unique class, method, and field an ID that would remain the same across versions. This is not the same as the obfuscated names that Mojang uses as these change completely with each version. Intermediary allowed mods compiled against one version of Minecraft to continue working on future versions, as long as the underlying code did not change significantly.</p>
      <p>Once the game is unobfuscated, there will no longer be a need for Intermediary, as method names should no longer change drastically between releases.</p>
      <h3 id="what-changes-if-i-am-already-using-mojangs-mappings">What changes if I am already using Mojang’s mappings?</h3>
      <p>If you are already using Mojang Mappings, the transition to the unobfuscated version of Minecraft should be relatively smooth. You may need to adjust any code that relies on synthetic methods or fields (search for ‘method_’ or ‘field_’ in your project.). Any usage of Fabric Loader’s <code class="language-plaintext highlighter-rouge">MappingResolver</code> can likely be removed. You will need to migrate your build script to the new Loom variant that does not support remapping. We will provide more detailed guidance as we get closer to the release of the unobfuscated version of Minecraft.</p>
      <h3 id="will-fabric-be-quicker-to-update">Will Fabric be quicker to update?</h3>
      <p>Yes! With the removal of obfuscation, we no longer need to manually update Yarn and Intermediary for each new version of Minecraft. This means that Fabric Loader and Loom will be able to use new versions as soon as they are released by Mojang. Fabric API will still require updates to accommodate changes to Minecraft itself. For stable releases where Fabric API has already been updated to a release candidate, we expect there will be no delay in fully supporting the new version of Minecraft.</p>
      <h3 id="so-minecraft-is-open-source-now">So Minecraft is open source now?</h3>
      <p>No, nothing really changes in that regard. Mojang previously released their obfuscation mappings publicly allowing anyone to see the deobfuscated names of classes, methods, and fields if they remaped the code. This change simply means that the code itself that players use will no longer be obfuscated, making it easier for modders to work with without needing an extra step. The Minecraft <a href="https://www.minecraft.net/en-us/eula">EULA</a> has also not changed.</p>
      <h3 id="how-much-easier-will-modding-be">How much easier will modding be?</h3>
      <p>A little bit, as local variable names will now be available in the code, which helps to make debugging and understanding Minecraft’s code easier. Crash reports will no longer require translation. However, developing mods will still require a good understanding of Java, Minecraft’s systems and the modding APIs being used. This will not allow mods to do anything they weren’t able to do before.</p>
    </content>
    <author>
      <name/>
    </author>
    <summary type="html">A new version of Minecraft is coming soon with some changes that affect most mod makers. As always, we ask all players to be patient, and give mod developers time to update to this new version. We kindly ask everyone not to pester them. We also recommend all players make backups of their worlds.</summary>
  </entry>
  <entry>
    <title type="html">Removing Obfuscation from Fabric</title>
    <link href="https://fabricmc.net/2025/10/31/obfuscation.html" rel="alternate" type="text/html" title="Removing Obfuscation from Fabric"/>
    <published>2025-10-31T00:00:00+00:00</published>
    <updated>2025-10-31T00:00:00+00:00</updated>
    <id>https://fabricmc.net/2025/10/31/obfuscation</id>
    <content type="html" xml:base="https://fabricmc.net/2025/10/31/obfuscation.html">
      <p>Mojang recently published <a href="https://www.minecraft.net/en-us/article/removing-obfuscation-in-java-edition">a blog post</a> announcing that they will be removing obfuscation from Minecraft: Java Edition starting with the first snapshot after the <em>Mounts of Mayhem</em> launch later this year. There will also be supplementary “experimental” releases starting with next Tuesday’s snapshot to allow us time to prepare and migrate.</p>
      <p>This is a major change that will affect the entire modding community. This blog post will attempt to give a rundown of how the Fabric toolchain will be affected, and what this means for Fabric mod developers.</p>
      <h2 id="what-is-obfuscation">What is obfuscation?</h2>
      <p>Obfuscation is a practice by which the names of classes, methods, fields, etc. in the code of the game are hidden by changing them into meaningless sequences of letters that change every version. So, as an example, the class for Creepers may have been changed from <code class="language-plaintext highlighter-rouge">Creeper</code> to something like <code class="language-plaintext highlighter-rouge">brc</code>.
      </p>
      <p>This has been a practice used for practically the entire time Minecraft has existed, and has meant that people who want to mod the game needed to figure out what each part of the code did, and use tools to apply readable names back to the code.</p>
      <h3 id="what-has-been-done-about-obfuscation-before">What has been done about obfuscation before?</h3>
      <p>In the Fabric world, we have had projects called Intermediary and Yarn. Intermediary would take the obfuscated names and give them stable numbers - so <code class="language-plaintext highlighter-rouge">brc</code> might become <code class="language-plaintext highlighter-rouge">class_1548</code>. Yarn would then apply readable names to those numbers - so <code class="language-plaintext highlighter-rouge">class_1548</code> might become <code class="language-plaintext highlighter-rouge">CreeperEntity</code>. These Yarn names were created and determined by our community by analysing the code. (If you’ve seen things in the code named with the Intermediary numbers - those are things we didn’t get around to naming in Yarn!)</p>
      <p>Since 2019, while the code of the game itself has still used the scrambled letters, Mojang has released their own official set of readable names, colloquially known as ‘Mojmap’, which are the names they themselves use when developing the game. This set of names was different from Yarn, and many developers embraced them, though some continued using Yarn names out of preference. Fabric has supported the option to use either set of names.</p>
      <h3 id="what-does-it-mean-that-obfuscation-is-being-removed">What does it mean that obfuscation is being removed?</h3>
      <p>Now, the names in the actual code of the game will match those that Mojang has been releasing since 2019. What’s more, for the first time, mod developers will now be able to see official names for method parameters and local variables, which were previously missing from those names.</p>
      <p>However, as the Fabric toolchain has been built around the need to apply our own names, this means a lot of work will have to go into supporting this change.</p>
      <h2 id="what-is-fabric-going-to-do">What is Fabric going to do?</h2>
      <p>We have plans in place to update our toolchain, but there’s a lot to do, and this may take some time.</p>
      <h3 id="the-future-of-fabric-api">The future of Fabric API</h3>
      <p>Fabric API will <strong>not</strong> undergo major rewrites as a result of this, and all of your favourite APIs will stay on course. However, the naming of the APIs and their associated methods and javadoc will change to accurately reflect the official Mojang names.</p>
      <p>The first stage of this will be to migrate Fabric API to use the official Mojang names in a non API-breaking way. This will happen fairly quickly as it can be done with no impact to modders and players.</p>
      <p>When the new fully deobfuscated version is released, we will rename Fabric’s own API functions to match those of the official names.</p>
      <h3 id="loom">Loom</h3>
      <p>Development of a new Loom version has begun. The initial goal is to provide a solution for mod developers to begin using the new experimental releases for testing. This will likely take the form of Loom 1.13.</p>
      <p>In the long run we may look into making a totally new version of Loom that is more modular. Loom 2.0 may provide a slim version that contains no support for remapping. This will likely take some time, and is still in the design phase so please be patient.</p>
      <p>Support for modding older game versions with the latest Loom is a very high priority and something that we wish to continue to provide as we have done previously. We also understand that not everyone wishes to use the new official names, we hope to provide a remapping solution for those advanced users who wish to use their own names.</p>
      <h3 id="the-future-of-yarn">The future of Yarn</h3>
      <p align="center">
        <img src="/assets/rip_yarn.png" alt="Example Image" />
      </p>
      <p>The Fabric community as a whole thanks all 261 Yarn contributors for their 9 years, 2 months, and 17 days of <code class="language-plaintext highlighter-rouge">Identifier</code> glory. Your contributions have been and continue to be greatly appreciated.</p>
      <p>Unfortunately, given the current circumstances we can’t see a way to justify maintaining Yarn in its current state.</p>
      <p>Yarn for existing Minecraft versions will continue to welcome contributions.</p>
      <p>If you are a mod developer using Yarn mappings, you will likely need to migrate to Mojang’s names. See the ‘For mod developers’ section below.</p>
      <h2 id="what-do-i-need-to-do">What do I need to do?</h2>
      <h3 id="for-players">For players</h3>
      <p>Very little! This is largely only going to affect developers. We aim to keep supporting all existing launchers.</p>
      <p>In good news, this also means once all this is sorted, updates for some things like Fabric API will likely be quicker in the future, and crash logs might be slightly easier to read. Rejoice!</p>
      <p>And as always, we ask all players to be patient, and give mod developers time to update. We kindly ask everyone not to pester them. We also recommend all players make backups of their worlds before updating to any new version.</p>
      <h3 id="for-mod-developers">For mod developers</h3>
      <p>This is going to be a large change, especially for those that are using Yarn. There is no expectation to update your mods right away, but you may wish to prepare. Nothing will change until after the <em>Mounts of Mayhem</em> (1.21.11) drop.</p>
      <p>We recommend that all new mods should be created using the official Mojang mappings, this will provide an easier upgrade path in the future.</p>
      <p>If you have a mod using Yarn, don’t worry! Loom has existing automated tooling that will help you to rename your code. We are actively looking at ways to improve this tooling and plan to provide some resources in the future to help you.</p>
      <p>Once you have upgraded, you will benefit from a much simpler and faster toolchain, improved logs/crash reports and new debugging options.</p>
      <h2 id="tldr-what-will-affect-you">TL;DR: What will affect you</h2>
      <h3 id="players">Players</h3>
      <ul>
        <li>Be patient while mods update.</li>
        <li>Crash logs may be slightly easier to read.</li>
      </ul>
      <h3 id="modders">Modders</h3>
      <ul>
        <li>Don’t worry! There is no rush.</li>
        <li>Most Yarn users will need to migrate to the official names.</li>
        <li>Your build script will require some changes.</li>
        <li>Production crash logs may be slightly easier to debug.</li>
        <li>Intermediary will no longer exist; the game will use Mojang’s names at runtime.</li>
      </ul>
    </content>
    <author>
      <name/>
    </author>
    <summary type="html">Mojang recently published a blog post announcing that they will be removing obfuscation from Minecraft: Java Edition starting with the first snapshot after the Mounts of Mayhem launch later this year. There will also be supplementary “experimental” releases starting with next Tuesday’s snapshot to allow us time to prepare and migrate.</summary>
  </entry>
  <entry>
    <title type="html">Fabric for Minecraft 1.21.9 &amp; 1.21.10</title>
    <link href="https://fabricmc.net/2025/09/23/1219.html" rel="alternate" type="text/html" title="Fabric for Minecraft 1.21.9 &amp; 1.21.10"/>
    <published>2025-09-23T00:00:00+00:00</published>
    <updated>2025-09-23T00:00:00+00:00</updated>
    <id>https://fabricmc.net/2025/09/23/1219</id>
    <content type="html" xml:base="https://fabricmc.net/2025/09/23/1219.html">
      <p>A new version of Minecraft is coming soon with some changes that affect most mod makers. As always, <strong>we ask all players to be patient, and give mod developers time to update to this new version.</strong> We kindly ask everyone not to pester them. <strong>We also recommend all players make backups of their worlds.</strong>
      </p>
      <p>Here is a list of several major modder-facing changes in this version. Note that all code references are using Yarn mappings; modders using alternative mappings may need to use different names.</p>
      <h2 id="fabric-changes">Fabric changes</h2>
      <p>Developers should use Loom 1.11 (at the time of writing) to develop mods for Minecraft 1.21.9. Players should install the latest stable version of Fabric Loader (currently 0.17.2).</p>
      <h3 id="yarn-mappings">Yarn Mappings</h3>
      <p>In this update, several mapping name changes were forced by changes in the vanilla class hierarchy. While a full diff may be found <a href="https://github.com/FabricMC/yarn/compare/d9167974e1fc83c980cf3be9fb567b1ab67d1153..6f9f183d2908d05e67a89aa3558caf9fee207dc0">here</a>, there is one major change affecting almost all mods: <code class="language-plaintext highlighter-rouge">Entity#getWorld</code> was renamed to <code class="language-plaintext highlighter-rouge">Entity#getEntityWorld</code>.
      </p>
      <h3 id="world-render-events">World Render Events</h3>
      <p>The current event suite for rendering in the world has been removed. A suitable replacement is planned asap, but not ready yet. In the meantime, please use mixins to implement what your mod needs.</p>
      <h3 id="resource-loader-api-v1">Resource Loader API v1</h3>
      <p>A major rework of the resource loader API is present in the 1.21.9 version of Fabric API. This will make current functionality easier to acomplish, as well as opening doors for features like runtime resource generation in the future.</p>
      <p>The first part of this rework has just landed with the focus being on <code class="language-plaintext highlighter-rouge">ResourceReloader</code>. Historically this API based itself on the <code class="language-plaintext highlighter-rouge">IdentifiableResourceReloadListener</code> interface which allowed <code class="language-plaintext highlighter-rouge">ResourceReloader</code> to both be identifiable and specify dependencies. However this API had limits, which prevented to run before another <code class="language-plaintext highlighter-rouge">ResourceReloader</code> or was difficult to use in multiloader environments. This has been fixed with this new iteration of the API.</p>
      <p>From now on, <code class="language-plaintext highlighter-rouge">ResourceReloader</code> do not need to implement a Fabric-provided interface, instead they can be registered with an identifier directly:</p>
      <div class="language-diff highlighter-rouge">
        <div class="highlight">
          <pre class="highlight">
            <code>
              <span class="gd">- ResourceManagerHelper.get(ResourceType.SERVER_DATA).registerReloadListener(new CustomResourceReloader()) </span>
              <span class="gi">+ ResourceLoader.get(ResourceType.SERVER_DATA).registerReloader(Identifier.of("modid", "custom_resource_reloader"), new CustomResourceReloader()); </span>
            </code>
          </pre>
        </div>
      </div>
      <p>Ordering is now specified akin to events:</p>
      <div class="language-java highlighter-rouge">
        <div class="highlight">
          <pre class="highlight">
            <code>
              <span class="nc">ResourceLoader</span>
              <span class="o">.</span>
              <span class="na">get</span>
              <span class="o">(</span>
              <span class="nc">ResourceType</span>
              <span class="o">.</span>
              <span class="na">SERVER_DATA</span>
              <span class="o">).</span>
              <span class="na">addReloaderOrdering</span>
              <span class="o">(</span>
              <span class="nc">Identifier</span>
              <span class="o">.</span>
              <span class="na">of</span>
              <span class="o">(</span>
              <span class="s">"other"</span>
              <span class="o">,</span>
              <span class="s">"other_reloader_to_depend"</span>
              <span class="o">),</span>
              <span class="c1">// Triggers first</span>
              <span class="nc">Identifier</span>
              <span class="o">.</span>
              <span class="na">of</span>
              <span class="o">(</span>
              <span class="s">"modid"</span>
              <span class="o">,</span>
              <span class="s">"custom_resource_reloader"</span>
              <span class="o">)</span>
              <span class="c1">// Triggers second</span>
              <span class="o">);</span>
            </code>
          </pre>
        </div>
      </div>
      <p>You can also order based on Vanilla reloaders thanks to <code class="language-plaintext highlighter-rouge">ResourceReloaderKeys</code>, which provides both per-resource-reloader an identifier, and two global keys: before and after vanilla.</p>
      <p>Thanks to 1.21.9 Vanilla changes the way to register reloaders which need registry access has been simplified, instead of using a specialized registration method, now you can get registries and feature flags in <code class="language-plaintext highlighter-rouge">ResourceType.SERVER_DATA</code> reloaders via the shared state <code class="language-plaintext highlighter-rouge">Store</code>:
      </p>
      <div class="language-java highlighter-rouge">
        <div class="highlight">
          <pre class="highlight">
            <code>
              <span class="kd">class</span>
              <span class="nc">DataReloader</span>
              <span class="kd">implements</span>
              <span class="nc">ResourceReloader</span>
              <span class="o">{</span>
              <span class="nd">@Override</span>
              <span class="kd">public</span>
              <span class="nc">CompletableFuture</span>
              <span class="o">&lt;</span>
              <span class="nc">Void</span>
              <span class="o">&gt;</span>
              <span class="nf">reload</span>
              <span class="o">(</span>
              <span class="nc">Store</span>
              <span class="n">store</span>
              <span class="o">,</span>
              <span class="nc">Executor</span>
              <span class="n">prepareExecutor</span>
              <span class="o">,</span>
              <span class="nc">Synchronizer</span>
              <span class="n">reloadSynchronizer</span>
              <span class="o">,</span>
              <span class="nc">Executor</span>
              <span class="n">applyExecutor</span>
              <span class="o">)</span>
              <span class="o">{</span>
              <span class="nc">RegistryWrapper</span>
              <span class="o">.</span>
              <span class="na">WrapperLookup</span>
              <span class="n">registries</span>
              <span class="o">=</span>
              <span class="n">store</span>
              <span class="o">.</span>
              <span class="na">getOrThrow</span>
              <span class="o">(</span>
              <span class="nc">ResourceLoader</span>
              <span class="o">.</span>
              <span class="na">RELOADER_REGISTRY_LOOKUP_KEY</span>
              <span class="o">);</span>
              <span class="nc">FeatureSet</span>
              <span class="n">featureSet</span>
              <span class="o">=</span>
              <span class="n">store</span>
              <span class="o">.</span>
              <span class="na">getOrThrow</span>
              <span class="o">(</span>
              <span class="nc">ResourceLoader</span>
              <span class="o">.</span>
              <span class="na">RELOADER_FEATURE_SET_KEY</span>
              <span class="o">);</span>
              <span class="c1">// Code</span>
              <span class="o">}</span>
              <span class="o">}</span>
            </code>
          </pre>
        </div>
      </div>
      <p>This change also allows for <code class="language-plaintext highlighter-rouge">ResourceReloader</code>s to communicate data between them.</p>
      <p>See <a href="https://github.com/FabricMC/fabric/issues/4574">#4574</a> for more details about what else is planned and the current progress.</p>
      <h3 id="enchantments">Enchantments</h3>
      <p>Transitive access wideners have been added for all of the utility methods in <code class="language-plaintext highlighter-rouge">EnchantmentHelper</code> and <code class="language-plaintext highlighter-rouge">Enchantment</code>. We hope that this will make it easier for developers to implement custom enchantment effect components. See <a href="https://github.com/FabricMC/fabric/pull/4819">#4819</a> for more details.</p>
      <h3 id="serialization">Serialization</h3>
      <p>We have added a new module for utilities related to serialization. Currently, this module includes additional methods in <code class="language-plaintext highlighter-rouge">ReadView</code> and <code class="language-plaintext highlighter-rouge">WriteView</code>, and provides <code class="language-plaintext highlighter-rouge">Codec</code>s for some types that base vanilla doesn’t. Please feel free to suggest anything else that may be useful in this area. See <a href="https://github.com/FabricMC/fabric/pull/4745">#4745</a> for more details.</p>
      <h3 id="block-conversions">Block Conversions</h3>
      <p>To closer align with vanilla code flow, <code class="language-plaintext highlighter-rouge">OxidizableBlocksRegistry</code> now supports registering a <code class="language-plaintext highlighter-rouge">CopperBlockSet</code> direclty. Simply call <code class="language-plaintext highlighter-rouge">OxidizableBlocksRegistry.registerCopperBlockSet(set)</code> to register. The prior methods for block pairs are still avalible for those that prefer them. See <a href="https://github.com/FabricMC/fabric/pull/4807">#4807</a> for more details.</p>
      <p>
        <code class="language-plaintext highlighter-rouge">StrippableBlockRegistry</code> now provides multiple overloads to satisfy all your stripping needs. As before, simple conversions can be registered by calling <code class="language-plaintext highlighter-rouge">StrippableBlockRegistry.register(Block, Block)</code>. You may also call <code class="language-plaintext highlighter-rouge">StrippableBlockRegistry.registerCopyState(Block, Block)</code> to register a stripping conversion that automatically copies all properties from the previous state, or <code class="language-plaintext highlighter-rouge">register(Block, Block, StrippingTransformer)</code> to have full control over the stripping process. See <a href="https://github.com/FabricMC/fabric/pull/4829">#4829</a> for more details.</p>
      <h3 id="gui-rendering">GUI Rendering</h3>
      <p>When using a custom <code class="language-plaintext highlighter-rouge">RenderPipeline</code> to render in the GUI, vanilla may assume that the <code class="language-plaintext highlighter-rouge">VertexFormat</code> being used is <code class="language-plaintext highlighter-rouge">QUADS</code>. Fabric now provides a way to override this behavior with <code class="language-plaintext highlighter-rouge">RenderPipeline.Builder.withUsePipelineDrawModeForGui</code>.
      </p>
      <div class="language-java highlighter-rouge">
        <div class="highlight">
          <pre class="highlight">
            <code>
              <span class="kt">var</span>
              <span class="n">pipeline</span>
              <span class="o">=</span>
              <span class="nc">RenderPipeline</span>
              <span class="o">.</span>
              <span class="na">builder</span>
              <span class="o">(</span>
              <span class="n">snippet1</span>
              <span class="o">,</span>
              <span class="n">snippet1</span>
              <span class="o">)</span>
              <span class="o">.</span>
              <span class="na">withUsePipelineDrawModeForGui</span>
              <span class="o">(</span>
              <span class="kc">true</span>
              <span class="o">)</span>
              <span class="o">.</span>
              <span class="na">build</span>
              <span class="o">();</span>
              <span class="c1">// ...</span>
              <span class="n">fictionalRenderInGuiInNonGuads</span>
              <span class="o">(</span>
              <span class="n">pipeline</span>
              <span class="o">);</span>
              <span class="c1">// will respect the VertexFormat set in the pipeline</span>
            </code>
          </pre>
        </div>
      </div>
      <p>See <a href="https://github.com/FabricMC/fabric/pull/4824">#4824</a> for more details.</p>
      <h3 id="mixin--mixinextras">Mixin &amp; MixinExtras</h3>
      <p>With version 0.17.0 of Fabric Loader, MixinExtras 5.0.0 and Fabric Mixin 0.16.3+mixin.0.8.7 are now bundled.</p>
      <ul>
        <li>MixinExtras 5.0.0 brings expressions, a new way to discribe mixins to java code in a syntax that mirrors the target, leading to mixins that are easier to maintain, more expressive, and potentially even more compatible with other mixins. See the <a href="https://github.com/LlamaLad7/MixinExtras/releases/tag/0.5.0">release notes</a> and <a href="https://github.com/LlamaLad7/MixinExtras/wiki/Expressions">wiki pages</a> for more details.</li>
        <li>Fabric Mixin 0.16.3 brings many bug fixes, along with scaffolding in mixin for potential widespread performance increases.</li>
      </ul>
      <h3 id="screen-key-events">Screen Key Events</h3>
      <p>With many breaking changes from mojang regarding keybindings, we’ve taken the opportunity to improve our events. Most parameters in the event have been consolidated into a context object known as a <code class="language-plaintext highlighter-rouge">KeyInput</code>. The <em>afterMouseX</em> style events now also take and return a <code class="language-plaintext highlighter-rouge">boolean</code> representing whether the event has been consumed. Returning <code class="language-plaintext highlighter-rouge">true</code> from these events will prevent further vanilla handling.</p>
      <p>See <a href="https://github.com/FabricMC/fabric/pull/4846/">#4846</a> and <a href="https://github.com/FabricMC/fabric/pull/4620">#4620</a> for more details.</p>
      <h2 id="minecraft-changes">Minecraft Changes</h2>
      <h3 id="rendering">Rendering</h3>
      <p>Almost all world rendering has been reworked to group objects with similar rendering requirements together. Most places now use <code class="language-plaintext highlighter-rouge">OrderedRenderCommandQueue</code> to submit things to be drawn later, when all objects of a similar type have been rendered.</p>
      <h4 id="block-entities">Block Entities</h4>
      <p>Block entities now use <code class="language-plaintext highlighter-rouge">OrderedRenderCommandQueue</code>. The following example shows rendering text on the block using the queue.</p>
      <div class="language-java highlighter-rouge">
        <div class="highlight">
          <pre class="highlight">
            <code>
              <span class="kd">public</span>
              <span class="kd">class</span>
              <span class="nc">TestBlockEntityRenderer</span>
              <span class="kd">implements</span>
              <span class="nc">BlockEntityRenderer</span>
              <span class="o">&lt;</span>
              <span class="nc">TestBlockEntity</span>
              <span class="o">,</span>
              <span class="nc">BlockEntityRenderState</span>
              <span class="o">&gt;</span>
              <span class="o">{</span>
              <span class="kd">public</span>
              <span class="nf">TestBlockEntityRenderer</span>
              <span class="o">(</span>
              <span class="nc">BlockEntityRendererFactory</span>
              <span class="o">.</span>
              <span class="na">Context</span>
              <span class="n">context</span>
              <span class="o">)</span>
              <span class="o">{</span>
              <span class="o">}</span>
              <span class="nd">@Override</span>
              <span class="kd">public</span>
              <span class="nc">BlockEntityRenderState</span>
              <span class="nf">createRenderState</span>
              <span class="o">()</span>
              <span class="o">{</span>
              <span class="k">return</span>
              <span class="k">new</span>
              <span class="nf">BlockEntityRenderState</span>
              <span class="o">();</span>
              <span class="o">}</span>
              <span class="nd">@Override</span>
              <span class="kd">public</span>
              <span class="kt">void</span>
              <span class="nf">render</span>
              <span class="o">(</span>
              <span class="nc">BlockEntityRenderState</span>
              <span class="n">state</span>
              <span class="o">,</span>
              <span class="nc">MatrixStack</span>
              <span class="n">matrices</span>
              <span class="o">,</span>
              <span class="nc">OrderedRenderCommandQueue</span>
              <span class="n">queue</span>
              <span class="o">,</span>
              <span class="nc">CameraRenderState</span>
              <span class="n">cameraRenderState</span>
              <span class="o">)</span>
              <span class="o">{</span>
              <span class="n">queue</span>
              <span class="o">.</span>
              <span class="na">submitText</span>
              <span class="o">(</span>
              <span class="n">matrices</span>
              <span class="o">,</span>
              <span class="mi">0</span>
              <span class="o">,</span>
              <span class="mi">0</span>
              <span class="o">,</span>
              <span class="nc">Text</span>
              <span class="o">.</span>
              <span class="na">literal</span>
              <span class="o">(</span>
              <span class="s">"Hello, world!"</span>
              <span class="o">).</span>
              <span class="na">asOrderedText</span>
              <span class="o">(),</span>
              <span class="kc">false</span>
              <span class="o">,</span>
              <span class="nc">TextRenderer</span>
              <span class="o">.</span>
              <span class="na">TextLayerType</span>
              <span class="o">.</span>
              <span class="na">NORMAL</span>
              <span class="o">,</span>
              <span class="n">state</span>
              <span class="o">.</span>
              <span class="na">lightmapCoordinates</span>
              <span class="o">,</span>
              <span class="nc">Colors</span>
              <span class="o">.</span>
              <span class="na">WHITE</span>
              <span class="o">,</span>
              <span class="mi">0</span>
              <span class="o">,</span>
              <span class="nc">Colors</span>
              <span class="o">.</span>
              <span class="na">BLACK</span>
              <span class="o">);</span>
              <span class="o">}</span>
              <span class="o">}</span>
            </code>
          </pre>
        </div>
      </div>      <!-- this looks like the old way of doing this, should probably mention that -->
      <div class="language-java highlighter-rouge">
        <div class="highlight">
          <pre class="highlight">
            <code>
              <span class="kd">public</span>
              <span class="kd">class</span>
              <span class="nc">TestBlockEntityRenderer</span>
              <span class="kd">implements</span>
              <span class="nc">BlockEntityRenderer</span>
              <span class="o">&lt;</span>
              <span class="nc">TestBlockEntity</span>
              <span class="o">&gt;</span>
              <span class="o">{</span>
              <span class="kd">public</span>
              <span class="nf">TestBlockEntityRenderer</span>
              <span class="o">(</span>
              <span class="nc">BlockEntityRendererFactory</span>
              <span class="o">.</span>
              <span class="na">Context</span>
              <span class="n">context</span>
              <span class="o">)</span>
              <span class="o">{</span>
              <span class="o">}</span>
              <span class="nd">@Override</span>
              <span class="kd">public</span>
              <span class="kt">void</span>
              <span class="nf">render</span>
              <span class="o">(</span>
              <span class="nc">TestBlockEntity</span>
              <span class="n">entity</span>
              <span class="o">,</span>
              <span class="kt">float</span>
              <span class="n">tickProgress</span>
              <span class="o">,</span>
              <span class="nc">MatrixStack</span>
              <span class="n">matrices</span>
              <span class="o">,</span>
              <span class="nc">VertexConsumerProvider</span>
              <span class="n">vertexConsumers</span>
              <span class="o">,</span>
              <span class="kt">int</span>
              <span class="n">light</span>
              <span class="o">,</span>
              <span class="kt">int</span>
              <span class="n">overlay</span>
              <span class="o">,</span>
              <span class="nc">Vec3d</span>
              <span class="n">cameraPos</span>
              <span class="o">)</span>
              <span class="o">{</span>
              <span class="nc">MinecraftClient</span>
              <span class="o">.</span>
              <span class="na">getInstance</span>
              <span class="o">().</span>
              <span class="na">textRenderer</span>
              <span class="o">.</span>
              <span class="na">drawWithOutline</span>
              <span class="o">(</span>
              <span class="nc">Text</span>
              <span class="o">.</span>
              <span class="na">literal</span>
              <span class="o">(</span>
              <span class="s">"Hello, world!"</span>
              <span class="o">).</span>
              <span class="na">asOrderedText</span>
              <span class="o">(),</span>
              <span class="mi">0</span>
              <span class="o">,</span>
              <span class="mi">0</span>
              <span class="o">,</span>
              <span class="nc">Colors</span>
              <span class="o">.</span>
              <span class="na">WHITE</span>
              <span class="o">,</span>
              <span class="nc">Colors</span>
              <span class="o">.</span>
              <span class="na">BLACK</span>
              <span class="o">,</span>
              <span class="n">matrices</span>
              <span class="o">.</span>
              <span class="na">peek</span>
              <span class="o">().</span>
              <span class="na">getPositionMatrix</span>
              <span class="o">(),</span>
              <span class="n">vertexConsumers</span>
              <span class="o">,</span>
              <span class="n">light</span>
              <span class="o">);</span>
              <span class="o">}</span>
              <span class="o">}</span>
            </code>
          </pre>
        </div>
      </div>
      <h4 id="particles">Particles</h4>
      <p>Particle rendering has been changed to use the same queue system as above. Many good examples for implementing custom rendering via the queue can be found in the vanilla particle classes.         <!-- no examples, I'm not awake enough to be trusted with a buffer. --></p>
      <h4 id="entities">Entities</h4>
      <p>Entity rendering has changed to use the same queue as shown above. Changes will be similar.</p>
      <h3 id="keybinding-changes">Keybinding Changes</h3>
      <p>Keybinding categories have become more structured. You could do the following before:</p>
      <div class="language-java highlighter-rouge">
        <div class="highlight">
          <pre class="highlight">
            <code>
              <span class="kd">public</span>
              <span class="kd">class</span>
              <span class="nc">ModKeybindings</span>
              <span class="o">{</span>
              <span class="kd">private</span>
              <span class="kd">static</span>
              <span class="kd">final</span>
              <span class="nc">KeyBinding</span>
              <span class="no">RANDOM_KEYBIND</span>
              <span class="o">=</span>
              <span class="k">new</span>
              <span class="nc">KeyBinding</span>
              <span class="o">(</span>
              <span class="s">"key.test.random_keybind"</span>
              <span class="o">,</span>
              <span class="nc">InputUtil</span>
              <span class="o">.</span>
              <span class="na">Type</span>
              <span class="o">.</span>
              <span class="na">KEYSYM</span>
              <span class="o">,</span>
              <span class="nc">InputUtil</span>
              <span class="o">.</span>
              <span class="na">UNKNOWN_KEY</span>
              <span class="o">.</span>
              <span class="na">getCode</span>
              <span class="o">(),</span>
              <span class="s">"key.category.test.main"</span>
              <span class="o">);</span>
              <span class="kd">private</span>
              <span class="kd">static</span>
              <span class="kt">void</span>
              <span class="nf">tickKeybindings</span>
              <span class="o">(</span>
              <span class="nc">MinecraftClient</span>
              <span class="n">client</span>
              <span class="o">)</span>
              <span class="o">{</span>
              <span class="k">while</span>
              <span class="o">(</span>
              <span class="no">RANDOM_KEYBIND</span>
              <span class="o">.</span>
              <span class="na">wasPressed</span>
              <span class="o">())</span>
              <span class="o">{</span>
              <span class="nc">System</span>
              <span class="o">.</span>
              <span class="na">out</span>
              <span class="o">.</span>
              <span class="na">println</span>
              <span class="o">(</span>
              <span class="s">"Random keybind pressed!"</span>
              <span class="o">);</span>
              <span class="o">}</span>
              <span class="o">}</span>
              <span class="kd">public</span>
              <span class="kd">static</span>
              <span class="kt">void</span>
              <span class="nf">init</span>
              <span class="o">()</span>
              <span class="o">{</span>
              <span class="nc">ClientTickEvents</span>
              <span class="o">.</span>
              <span class="na">END_CLIENT_TICK</span>
              <span class="o">.</span>
              <span class="na">register</span>
              <span class="o">(</span>
              <span class="nl">ModKeybindings:</span>
              <span class="o">:</span>
              <span class="n">tickKeybindings</span>
              <span class="o">);</span>
              <span class="o">}</span>
              <span class="o">}</span>
            </code>
          </pre>
        </div>
      </div>
      <p>Now you could do:</p>
      <div class="language-java highlighter-rouge">
        <div class="highlight">
          <pre class="highlight">
            <code>
              <span class="kd">public</span>
              <span class="kd">class</span>
              <span class="nc">ModKeybindings</span>
              <span class="o">{</span>
              <span class="kd">private</span>
              <span class="kd">static</span>
              <span class="kd">final</span>
              <span class="nc">KeyBinding</span>
              <span class="o">.</span>
              <span class="na">Category</span>
              <span class="no">TEST_CATEGORY</span>
              <span class="o">=</span>
              <span class="nc">KeyBinding</span>
              <span class="o">.</span>
              <span class="na">Category</span>
              <span class="o">.</span>
              <span class="na">create</span>
              <span class="o">(</span>
              <span class="nc">Identifier</span>
              <span class="o">.</span>
              <span class="na">of</span>
              <span class="o">(</span>
              <span class="s">"test"</span>
              <span class="o">,</span>
              <span class="s">"main"</span>
              <span class="o">));</span>
              <span class="kd">private</span>
              <span class="kd">static</span>
              <span class="kd">final</span>
              <span class="nc">KeyBinding</span>
              <span class="no">RANDOM_KEYBIND</span>
              <span class="o">=</span>
              <span class="k">new</span>
              <span class="nc">KeyBinding</span>
              <span class="o">(</span>
              <span class="s">"key.test.random_keybind"</span>
              <span class="o">,</span>
              <span class="nc">InputUtil</span>
              <span class="o">.</span>
              <span class="na">Type</span>
              <span class="o">.</span>
              <span class="na">KEYSYM</span>
              <span class="o">,</span>
              <span class="nc">InputUtil</span>
              <span class="o">.</span>
              <span class="na">UNKNOWN_KEY</span>
              <span class="o">.</span>
              <span class="na">getCode</span>
              <span class="o">(),</span>
              <span class="no">TEST_CATEGORY</span>
              <span class="o">);</span>
              <span class="c1">// ...</span>
              <span class="o">}</span>
            </code>
          </pre>
        </div>
      </div>
      <p>Each category may only be registered once; Registering a category twice, or two categories with the same id will lead to an exception.</p>
      <p>When Fabric API is installed, mod-provided categories will be sorted by alphabetically according to their identifiers, first by namespace, and then by path. All vanilla categories will remain in their natural order.</p>
      <h3 id="debug-text-api">Debug Text API</h3>
      <p>It is now possible to register debug HUD entries to be added to the debug (F3) overlay. The debug overlay is now also available outside of a world. Use <code class="language-plaintext highlighter-rouge">DebugHudEntries</code> to register entries to be rendered as follows:</p>
      <div class="language-java highlighter-rouge">
        <div class="highlight">
          <pre class="highlight">
            <code>
              <span class="nc">DebugHudEntries</span>
              <span class="o">.</span>
              <span class="na">register</span>
              <span class="o">(</span>
              <span class="nc">Identifier</span>
              <span class="o">.</span>
              <span class="na">of</span>
              <span class="o">(</span>
              <span class="s">"test"</span>
              <span class="o">,</span>
              <span class="s">"example"</span>
              <span class="o">),</span>
              <span class="k">new</span>
              <span class="nf">DebugHudEntry</span>
              <span class="o">()</span>
              <span class="o">{</span>
              <span class="nd">@Override</span>
              <span class="kd">public</span>
              <span class="kt">void</span>
              <span class="nf">render</span>
              <span class="o">(</span>
              <span class="nc">DebugHudLines</span>
              <span class="n">lines</span>
              <span class="o">,</span>
              <span class="nd">@Nullable</span>
              <span class="nc">World</span>
              <span class="n">world</span>
              <span class="o">,</span>
              <span class="nd">@Nullable</span>
              <span class="nc">WorldChunk</span>
              <span class="n">clientChunk</span>
              <span class="o">,</span>
              <span class="nd">@Nullable</span>
              <span class="nc">WorldChunk</span>
              <span class="n">chunk</span>
              <span class="o">)</span>
              <span class="o">{</span>
              <span class="k">if</span>
              <span class="o">(</span>
              <span class="n">world</span>
              <span class="o">!=</span>
              <span class="kc">null</span>
              <span class="o">)</span>
              <span class="n">lines</span>
              <span class="o">.</span>
              <span class="na">addLine</span>
              <span class="o">(</span>
              <span class="s">"Example in-world line :)"</span>
              <span class="o">);</span>
              <span class="k">else</span>
              <span class="n">lines</span>
              <span class="o">.</span>
              <span class="na">addLine</span>
              <span class="o">(</span>
              <span class="s">"Example out-of-world line :("</span>
              <span class="o">);</span>
              <span class="o">}</span>
              <span class="nd">@Override</span>
              <span class="kd">public</span>
              <span class="kt">boolean</span>
              <span class="nf">canShow</span>
              <span class="o">(</span>
              <span class="kt">boolean</span>
              <span class="n">reducedDebugInfo</span>
              <span class="o">)</span>
              <span class="o">{</span>
              <span class="c1">// return false if your debug text </span>
              <span class="c1">// is not applicable with reduced debug info</span>
              <span class="k">return</span>
              <span class="kc">true</span>
              <span class="o">;</span>
              <span class="o">}</span>
              <span class="o">}</span>
              <span class="o">);</span>
            </code>
          </pre>
        </div>
      </div>
      <h3 id="misc">Misc</h3>
      <h4 id="macos">MacOS</h4>
      <p>
        <code class="language-plaintext highlighter-rouge">MinecraftClient.IS_SYSTEM_MAC</code> has been replaced by <code class="language-plaintext highlighter-rouge">SystemKeycodes.IS_MAC_OS</code>.
      </p>
    </content>
    <author>
      <name/>
    </author>
    <summary type="html">A new version of Minecraft is coming soon with some changes that affect most mod makers. As always, we ask all players to be patient, and give mod developers time to update to this new version. We kindly ask everyone not to pester them. We also recommend all players make backups of their worlds.</summary>
  </entry>
  <entry>
    <title type="html">Fabric for Minecraft 1.21.6, 1.21.7 &amp; 1.21.8</title>
    <link href="https://fabricmc.net/2025/06/15/1216.html" rel="alternate" type="text/html" title="Fabric for Minecraft 1.21.6, 1.21.7 &amp; 1.21.8"/>
    <published>2025-06-15T00:00:00+00:00</published>
    <updated>2025-06-15T00:00:00+00:00</updated>
    <id>https://fabricmc.net/2025/06/15/1216</id>
    <content type="html" xml:base="https://fabricmc.net/2025/06/15/1216.html">
      <p>A new version of Minecraft is coming soon with some changes that affect most mod makers. As always, <strong>we ask all players to be patient, and give mod developers time to update to this new version.</strong> We kindly ask everyone not to pester them. <strong>We also recommend all players make backups of their worlds.</strong>
      </p>
      <p>Here is a list of several major modder-facing changes in this version. Note that all code references are using Yarn mappings; modders using alternative mappings may need to use different names.</p>
      <h2 id="fabric-changes">Fabric changes</h2>
      <p>Developers should use Loom 1.10 (at the time of writing) to develop mods for Minecraft 1.21.6. Players should install the latest stable version of Fabric Loader (currently 0.16.14).</p>
      <h3 id="deprecations-and-removals">Deprecations and removals</h3>
      <p>The following previously deprecated modules have been removed (<a href="https://github.com/FabricMC/fabric/pull/4651">#4651</a>):
      </p>
      <ul>
        <li>
          <code class="language-plaintext highlighter-rouge">fabric-command-api-v1</code>
        </li>
        <li>
          <code class="language-plaintext highlighter-rouge">fabric-commands-v0</code> (Deprecated almost 5 years ago!)</li>
        <li>
          <code class="language-plaintext highlighter-rouge">fabric-keybindings-v0</code>
        </li>
        <li>
          <code class="language-plaintext highlighter-rouge">fabric-rendering-data-attachment-v1</code>
        </li>
      </ul>
      <p>The following modules have been merged into other modules for simplicity:</p>
      <ul>
        <li>
          <code class="language-plaintext highlighter-rouge">fabric-client-tags-api-v1</code> was merged into <code class="language-plaintext highlighter-rouge">fabric-tag-api-v1</code> (          <a href="https://github.com/FabricMC/fabric/pull/4647">#4647</a>)
        </li>
        <li>
          <code class="language-plaintext highlighter-rouge">fabric-blockrenderlayer-v1</code> was merged into <code class="language-plaintext highlighter-rouge">fabric-rendering-v1</code> (          <a href="https://github.com/FabricMC/fabric/pull/4675">#4675</a>)
        </li>
      </ul>
      <p>The tag API changes are technically breaking for some developers who explicitly depend on these modules. The removal and merging of these modules has been done to help improve peformance when setting up a new development environment.</p>
      <p>The Fabric Rendering API previously provided a Material API, to allow modders more control of the way their models rendered. This has been removed.</p>
      <blockquote>
        <p>Materials were removed … because they were deemed to be an unnecessary part of the API design, and the breaking change induced by changes in 1.21.6 was related to materials, which made this the perfect time to remove them - PepperCode1</p>
      </blockquote>
      <p>See (<a href="https://github.com/FabricMC/fabric/pull/4675">#4675</a>) for more info.</p>
      <p>In addition to being relocated, the <code class="language-plaintext highlighter-rouge">BlockRenderLayerMap</code> API was also updated to be more consistent out current API style:</p>
      <div class="language-diff highlighter-rouge">
        <div class="highlight">
          <pre class="highlight">
            <code>
              <span class="gd">- import net.fabricmc.fabric.api.blockrenderlayer.v1.BlockRenderLayerMap; </span>
              <span class="gi">+ import net.fabricmc.fabric.api.client.rendering.v1.BlockRenderLayerMap; </span> ...              <span class="gd">- BlockRenderLayerMap.INSTANCE.putBlock(ModBlocks.MY_EPIC_BLOCK, BlockRenderLayer.CUTOUT) </span>
              <span class="gi">+ BlockRenderLayerMap.putBlock(ModBlocks.MY_EPIC_BLOCK, BlockRenderLayer.CUTOUT) </span>
            </code>
          </pre>
        </div>
      </div>
      <p>See (<a href="https://github.com/FabricMC/fabric/pull/4664">#4664</a>) for more info.</p>
      <h3 id="breaking-changes">Breaking changes</h3>
      <p>Fabric’s brand new HUD API had to be totally rewritten in 1.21.6. The new <code class="language-plaintext highlighter-rouge">HudElementRegistry</code> provides all of the functionality provided by the old API. The following basic example shows how you can draw text after all of the vanilla HUD layers:</p>
      <div class="language-java highlighter-rouge">
        <div class="highlight">
          <pre class="highlight">
            <code>
              <span class="nc">HudElementRegistry</span>
              <span class="o">.</span>
              <span class="na">addLast</span>
              <span class="o">(</span>
              <span class="nc">Identifier</span>
              <span class="o">.</span>
              <span class="na">of</span>
              <span class="o">(</span>
              <span class="s">"example"</span>
              <span class="o">,</span>
              <span class="s">"hud"</span>
              <span class="o">),</span>
              <span class="o">(</span>
              <span class="n">context</span>
              <span class="o">,</span>
              <span class="n">tickCounter</span>
              <span class="o">)</span>
              <span class="o">-&gt;</span>
              <span class="o">{</span>
              <span class="n">context</span>
              <span class="o">.</span>
              <span class="na">drawTextWithShadow</span>
              <span class="o">(</span>
              <span class="nc">MinecraftClient</span>
              <span class="o">.</span>
              <span class="na">getInstance</span>
              <span class="o">().</span>
              <span class="na">textRenderer</span>
              <span class="o">,</span>
              <span class="s">"This is an example"</span>
              <span class="o">,</span>
              <span class="mi">10</span>
              <span class="o">,</span>
              <span class="mi">10</span>
              <span class="o">,</span>
              <span class="nc">Colors</span>
              <span class="o">.</span>
              <span class="na">WHITE</span>
              <span class="o">);</span>
              <span class="o">});</span>
            </code>
          </pre>
        </div>
      </div>
      <p>If you wish to render your custom hud element before the vanilla chat you can do the following:</p>
      <div class="language-java highlighter-rouge">
        <div class="highlight">
          <pre class="highlight">
            <code>
              <span class="nc">HudElementRegistry</span>
              <span class="o">.</span>
              <span class="na">attachElementBefore</span>
              <span class="o">(</span>
              <span class="nc">VanillaHudElements</span>
              <span class="o">.</span>
              <span class="na">CHAT</span>
              <span class="o">,</span>
              <span class="nc">Identifier</span>
              <span class="o">.</span>
              <span class="na">of</span>
              <span class="o">(</span>
              <span class="s">"example"</span>
              <span class="o">,</span>
              <span class="s">"ud"</span>
              <span class="o">),</span>
              <span class="o">(</span>
              <span class="n">context</span>
              <span class="o">,</span>
              <span class="n">tickCounter</span>
              <span class="o">)</span>
              <span class="o">-&gt;</span>
              <span class="o">{</span>
              <span class="c1">// ...</span>
              <span class="o">});</span>
            </code>
          </pre>
        </div>
      </div>
      <h3 id="new-fabric-api-features">New Fabric API features</h3>
      <p>Since <code class="language-plaintext highlighter-rouge">Item#appendTooltip</code> has become deprecated, Fabric API now provides the <code class="language-plaintext highlighter-rouge">ComponentTooltipAppenderRegistry</code>. This registry provides <code class="language-plaintext highlighter-rouge">addAfter</code>,        <code class="language-plaintext highlighter-rouge">addBefore</code>,        <code class="language-plaintext highlighter-rouge">addFirst</code>, and <code class="language-plaintext highlighter-rouge">addLast</code> to allow you to position your tooltips relative to vanilla and other mods.</p>
      <div class="language-java highlighter-rouge">
        <div class="highlight">
          <pre class="highlight">
            <code>
              <span class="n">record</span>
              <span class="nf">MyAmazingComponent</span>
              <span class="o">()</span>
              <span class="kd">implements</span>
              <span class="nc">TooltipAppender</span>
              <span class="o">{</span>
              <span class="nd">@Override</span>
              <span class="kd">public</span>
              <span class="kt">void</span>
              <span class="nf">appendTooltip</span>
              <span class="o">(</span>
              <span class="nc">Item</span>
              <span class="o">.</span>
              <span class="na">TooltipContext</span>
              <span class="n">context</span>
              <span class="o">,</span>
              <span class="nc">Consumer</span>
              <span class="o">&lt;</span>
              <span class="nc">Text</span>
              <span class="o">&gt;</span>
              <span class="n">textConsumer</span>
              <span class="o">,</span>
              <span class="nc">TooltipType</span>
              <span class="n">type</span>
              <span class="o">,</span>
              <span class="nc">ComponentsAccess</span>
              <span class="n">components</span>
              <span class="o">)</span>
              <span class="o">{</span>
              <span class="n">textConsumer</span>
              <span class="o">.</span>
              <span class="na">accept</span>
              <span class="o">(</span>
              <span class="nc">Text</span>
              <span class="o">.</span>
              <span class="na">literal</span>
              <span class="o">(</span>
              <span class="s">"Amazingness Awaits!"</span>
              <span class="o">));</span>
              <span class="o">}</span>
              <span class="o">}</span>
              <span class="nc">ComponentType</span>
              <span class="o">&lt;</span>
              <span class="nc">MyAmazingComponent</span>
              <span class="o">&gt;</span>
              <span class="n">myAmazingComponentComponentType</span>
              <span class="o">=</span>
              <span class="cm">/*...*/</span>
              <span class="o">;</span>
              <span class="nc">ComponentTooltipAppenderRegistry</span>
              <span class="o">.</span>
              <span class="na">addAfter</span>
              <span class="o">(</span>
              <span class="nc">DataComponentTypes</span>
              <span class="o">.</span>
              <span class="na">DAMAGE</span>
              <span class="o">,</span>
              <span class="n">myAmazingComponentComponentType</span>
              <span class="o">);</span>
            </code>
          </pre>
        </div>
      </div>
      <p>Any <code class="language-plaintext highlighter-rouge">ItemStack</code> that has your component applied will call your component’s <code class="language-plaintext highlighter-rouge">appendTooltip</code> method, allowing you to append as you wish. (<a href="https://github.com/FabricMC/fabric/pull/4587">#4587</a>)
      </p>
      <p>The LootTable API has been expanded to make certain extreme usages more convenient. The <code class="language-plaintext highlighter-rouge">LootTableEvents.MODIFY_DROPS</code> event allows modders to customize the collective output of <code class="language-plaintext highlighter-rouge">LootTable</code>s. The <code class="language-plaintext highlighter-rouge">LootTableEvents.MODIFY</code> event should still be preferred when possible, for mod compatibility reasons. This event may also recurse if you generate loot from within a listener. (<a href="https://github.com/FabricMC/fabric/pull/4643">#4643</a>)
      </p>
      <div class="language-java highlighter-rouge">
        <div class="highlight">
          <pre class="highlight">
            <code>
              <span class="kt">var</span>
              <span class="n">matchGetter</span>
              <span class="o">=</span>
              <span class="nc">ServerRecipeManager</span>
              <span class="o">.</span>
              <span class="na">createCachedMatchGetter</span>
              <span class="o">(</span>
              <span class="nc">RecipeType</span>
              <span class="o">.</span>
              <span class="na">SMELTING</span>
              <span class="o">);</span>
              <span class="c1">// smelt any smeltable drops from blocks broken with a diamond pickaxe</span>
              <span class="nc">LootTableEvents</span>
              <span class="o">.</span>
              <span class="na">MODIFY_DROPS</span>
              <span class="o">.</span>
              <span class="na">register</span>
              <span class="o">((</span>
              <span class="n">entry</span>
              <span class="o">,</span>
              <span class="n">context</span>
              <span class="o">,</span>
              <span class="n">drops</span>
              <span class="o">)</span>
              <span class="o">-&gt;</span>
              <span class="o">{</span>
              <span class="k">if</span>
              <span class="o">(!</span>
              <span class="n">context</span>
              <span class="o">.</span>
              <span class="na">hasParameter</span>
              <span class="o">(</span>
              <span class="nc">LootContextParameters</span>
              <span class="o">.</span>
              <span class="na">TOOL</span>
              <span class="o">))</span>
              <span class="k">return</span>
              <span class="o">;</span>
              <span class="k">if</span>
              <span class="o">(!</span>
              <span class="n">context</span>
              <span class="o">.</span>
              <span class="na">hasParameter</span>
              <span class="o">(</span>
              <span class="nc">LootContextParameters</span>
              <span class="o">.</span>
              <span class="na">BLOCK_STATE</span>
              <span class="o">))</span>
              <span class="k">return</span>
              <span class="o">;</span>
              <span class="nc">ItemStack</span>
              <span class="n">tool</span>
              <span class="o">=</span>
              <span class="n">context</span>
              <span class="o">.</span>
              <span class="na">get</span>
              <span class="o">(</span>
              <span class="nc">LootContextParameters</span>
              <span class="o">.</span>
              <span class="na">TOOL</span>
              <span class="o">);</span>
              <span class="k">if</span>
              <span class="o">(!</span>
              <span class="n">tool</span>
              <span class="o">.</span>
              <span class="na">isOf</span>
              <span class="o">(</span>
              <span class="nc">Items</span>
              <span class="o">.</span>
              <span class="na">DIAMOND_PICKAXE</span>
              <span class="o">))</span>
              <span class="k">return</span>
              <span class="o">;</span>
              <span class="kt">var</span>
              <span class="n">world</span>
              <span class="o">=</span>
              <span class="n">context</span>
              <span class="o">.</span>
              <span class="na">getWorld</span>
              <span class="o">();</span>
              <span class="kt">var</span>
              <span class="n">lookup</span>
              <span class="o">=</span>
              <span class="n">world</span>
              <span class="o">.</span>
              <span class="na">getRegistryManager</span>
              <span class="o">();</span>
              <span class="n">drops</span>
              <span class="o">.</span>
              <span class="na">replaceAll</span>
              <span class="o">(</span>
              <span class="n">drop</span>
              <span class="o">-&gt;</span>
              <span class="n">matchGetter</span>
              <span class="o">.</span>
              <span class="na">getFirstMatch</span>
              <span class="o">(</span>
              <span class="k">new</span>
              <span class="nc">SingleStackRecipeInput</span>
              <span class="o">(</span>
              <span class="n">drop</span>
              <span class="o">),</span>
              <span class="n">world</span>
              <span class="o">)</span>
              <span class="o">.</span>
              <span class="na">map</span>
              <span class="o">(</span>
              <span class="nl">RecipeEntry:</span>
              <span class="o">:</span>
              <span class="n">value</span>
              <span class="o">)</span>
              <span class="o">.</span>
              <span class="na">map</span>
              <span class="o">(</span>
              <span class="n">recipe</span>
              <span class="o">-&gt;</span>
              <span class="n">recipe</span>
              <span class="o">.</span>
              <span class="na">craft</span>
              <span class="o">(</span>
              <span class="n">input</span>
              <span class="o">,</span>
              <span class="n">lookup</span>
              <span class="o">))</span>
              <span class="o">.</span>
              <span class="na">orElse</span>
              <span class="o">(</span>
              <span class="n">drop</span>
              <span class="o">)</span>
              <span class="o">);</span>
              <span class="o">});</span>
            </code>
          </pre>
        </div>
      </div>
      <p>Continuing with our conventional tag API, we added new biome tags, allowing modders to differentiate biomes based on their primary wood type. The <code class="language-plaintext highlighter-rouge">ServerChunkEvents.CHUNK_LEVEL_TYPE_CHANGE</code> event was added to allow more control over the timing of chunk events. This event fires for changes in chunk loading level, to react to changes not previously possible without mixins. (<a href="https://github.com/FabricMC/fabric/pull/4541">#4541</a>)
      </p>
      <p>An event was added for attachment changes, allowing reaction to an attachment value changing. This event can be recursive in nature, as if you set an attachment value from within a listener, the event will be invoked again. Modders should use proper recursion techniques to prevent infinite recursion. (<a href="https://github.com/FabricMC/fabric/pull/4606">#4606</a>)
      </p>
      <p>Two more events were added for players joining and leaving the game:</p>
      <div class="language-java highlighter-rouge">
        <div class="highlight">
          <pre class="highlight">
            <code>
              <span class="nc">AttachmentType</span>
              <span class="o">&lt;</span>
              <span class="nc">Instant</span>
              <span class="o">&gt;</span>
              <span class="no">JOINED_TIME</span>
              <span class="o">=</span>
              <span class="cm">/*...*/</span>
              <span class="o">;</span>
              <span class="nc">ServerPlayerEvents</span>
              <span class="o">.</span>
              <span class="na">JOIN</span>
              <span class="o">.</span>
              <span class="na">register</span>
              <span class="o">(</span>
              <span class="n">player</span>
              <span class="o">-&gt;</span>
              <span class="o">{</span>
              <span class="c1">// runs on the main thread, no need to use player.getServer().execute(() -&gt; ...);</span>
              <span class="n">player</span>
              <span class="o">.</span>
              <span class="na">setAttached</span>
              <span class="o">(</span>
              <span class="no">JOINED_TIME</span>
              <span class="o">,</span>
              <span class="nc">Instant</span>
              <span class="o">.</span>
              <span class="na">now</span>
              <span class="o">());</span>
              <span class="o">});</span>
            </code>
          </pre>
        </div>
      </div>
      <div class="language-java highlighter-rouge">
        <div class="highlight">
          <pre class="highlight">
            <code>
              <span class="nc">List</span>
              <span class="o">&lt;</span>
              <span class="nc">ServerPlayerEntity</span>
              <span class="o">&gt;</span>
              <span class="n">activePlayers</span>
              <span class="o">=</span>
              <span class="cm">/*...*/</span>
              <span class="o">;</span>
              <span class="nc">ServerPlayerEvents</span>
              <span class="o">.</span>
              <span class="na">LEAVE</span>
              <span class="o">.</span>
              <span class="na">register</span>
              <span class="o">(</span>
              <span class="nl">activePlayers:</span>
              <span class="o">:</span>
              <span class="n">remove</span>
              <span class="o">);</span>
            </code>
          </pre>
        </div>
      </div>
      <p>These events are designed for initializing and de-initializing state related to players, and run along vanilla code with the same purpose on the main thread, unlike the current events. (<a href="https://github.com/FabricMC/fabric/pull/4642">#4642</a>)
      </p>
      <p>The <code class="language-plaintext highlighter-rouge">FabricSoundsProvider</code> class was added to allow convenient creation of <code class="language-plaintext highlighter-rouge">sounds.json</code> from within datagen. (<a href="https://github.com/FabricMC/fabric/pull/4560">#4560</a>)
      </p>
      <p>The Client Game Test API has been tweaked to support filtering tests run by model, allowing more precise and efficient testing. (<a href="https://github.com/FabricMC/fabric/pull/4597">#4597</a>)
      </p>
      <p>The Model Loading API now supports registering extra unbound models (<a href="https://github.com/FabricMC/fabric/pull/4565">#4565</a>)
      </p>
      <div class="language-java highlighter-rouge">
        <div class="highlight">
          <pre class="highlight">
            <code>
              <span class="c1">// A ModelKey is a unique identifier for a model you want to bake.</span>
              <span class="kd">public</span>
              <span class="kd">static</span>
              <span class="kd">final</span>
              <span class="nc">ModelKey</span>
              <span class="o">&lt;</span>
              <span class="nc">BlockStateModel</span>
              <span class="o">&gt;</span>
              <span class="no">HALF_RED_SAND_MODEL_KEY</span>
              <span class="o">=</span>
              <span class="nc">ModelKey</span>
              <span class="o">.</span>
              <span class="na">create</span>
              <span class="o">();</span>
              <span class="kd">public</span>
              <span class="kd">static</span>
              <span class="kd">final</span>
              <span class="nc">Identifier</span>
              <span class="no">HALF_RED_SAND_MODEL_ID</span>
              <span class="o">=</span>
              <span class="n">id</span>
              <span class="o">(</span>
              <span class="s">"half_red_sand"</span>
              <span class="o">);</span>
              <span class="kd">public</span>
              <span class="kd">static</span>
              <span class="kt">void</span>
              <span class="nf">init</span>
              <span class="o">()</span>
              <span class="o">{</span>
              <span class="nc">ModelLoadingPlugin</span>
              <span class="o">.</span>
              <span class="na">register</span>
              <span class="o">(</span>
              <span class="n">pluginContext</span>
              <span class="o">-&gt;</span>
              <span class="o">{</span>
              <span class="n">pluginContext</span>
              <span class="o">.</span>
              <span class="na">addModel</span>
              <span class="o">(</span>
              <span class="no">HALF_RED_SAND_MODEL_KEY</span>
              <span class="o">,</span>
              <span class="no">HALF_RED_SAND_MODEL_ID</span>
              <span class="o">,</span>
              <span class="o">(</span>
              <span class="n">model</span>
              <span class="o">,</span>
              <span class="n">baker</span>
              <span class="o">)</span>
              <span class="o">-&gt;</span>
              <span class="o">{</span>
              <span class="nc">ModelTextures</span>
              <span class="n">textures</span>
              <span class="o">=</span>
              <span class="n">model</span>
              <span class="o">.</span>
              <span class="na">getTextures</span>
              <span class="o">();</span>
              <span class="k">return</span>
              <span class="k">new</span>
              <span class="nf">SimpleBlockStateModel</span>
              <span class="o">(</span>
              <span class="k">new</span>
              <span class="nc">GeometryBakedModel</span>
              <span class="o">(</span>
              <span class="n">model</span>
              <span class="o">.</span>
              <span class="na">bakeGeometry</span>
              <span class="o">(</span>
              <span class="n">textures</span>
              <span class="o">,</span>
              <span class="n">baker</span>
              <span class="o">,</span>
              <span class="nc">ModelRotation</span>
              <span class="o">.</span>
              <span class="na">X0_Y0</span>
              <span class="o">),</span>
              <span class="n">model</span>
              <span class="o">.</span>
              <span class="na">getAmbientOcclusion</span>
              <span class="o">(),</span>
              <span class="n">model</span>
              <span class="o">.</span>
              <span class="na">getParticleTexture</span>
              <span class="o">(</span>
              <span class="n">textures</span>
              <span class="o">,</span>
              <span class="n">baker</span>
              <span class="o">)</span>
              <span class="o">));</span>
              <span class="o">});</span>
              <span class="o">})</span>
              <span class="o">}</span>
              <span class="kd">public</span>
              <span class="kd">static</span>
              <span class="nc">BlockStateModel</span>
              <span class="nf">getModel</span>
              <span class="o">()</span>
              <span class="o">{</span>
              <span class="k">return</span>
              <span class="nc">MinecraftClient</span>
              <span class="o">.</span>
              <span class="na">getInstance</span>
              <span class="o">().</span>
              <span class="na">getBakedModelManager</span>
              <span class="o">().</span>
              <span class="na">getModel</span>
              <span class="o">(</span>
              <span class="no">HALF_RED_SAND_MODEL_KEY</span>
              <span class="o">);</span>
              <span class="o">}</span>
            </code>
          </pre>
        </div>
      </div>
      <p>
        <code class="language-plaintext highlighter-rouge">FabricTrackedDataRegistry</code> has been added to allow registering tracked data handlers for entities. This removes conflicts between mods registering tracked data handlers and ensures that the order is consistent between the client and server. If you previously used the vanilla API the following 1 line change is all you need to take advantage of this new API:</p>
      <div class="language-diff highlighter-rouge">
        <div class="highlight">
          <pre class="highlight">
            <code>
              <span class="gd">- TrackedDataHandlerRegistry.register(TRACKED_DATA_HANDLER); </span>
              <span class="gi">+ FabricTrackedDataRegistry.registerHandler(TRACKED_DATA_HANDLER_ID, TRACKED_DATA_HANDLER); </span>
            </code>
          </pre>
        </div>
      </div>
      <h3 id="bug-fixes">Bug Fixes</h3>
      <p>Thanks to the diligent developers and players, many bugs in Fabric API were reported and patched during this update cycle. See <a href="https://github.com/FabricMC/fabric/pulls?q=is%3Apr+is%3Aclosed+label%3Abug">The Fabric Github</a> for more info.</p>
      <h2 id="minecraft-changes">Minecraft changes</h2>
      <h3 id="rendering">Rendering</h3>
      <p>Mojang is currently working on separating Minecraft’s rendering pipeline into two stages:</p>
      <ol>
        <li>The extraction stage, where all renderable data is seperated from the game</li>
        <li>The render phase, where the previously extracted data is rendered.</li>
      </ol>
      <p>This process began in 1.21.2, and is still incomplete as of this update. Chunk, GUI and HUD rendering have all been converted to use the new separate rendering style. The ultimate goal of this separation is to enable the game to render one frame while the next is being extracted.</p>
      <p>Many methods in <code class="language-plaintext highlighter-rouge">RenderSystem</code> have been removed without direct replacement. In most cases, there isn’t a one-to-one translation from the old code to the new, but the same capabilities exist by combining the new <code class="language-plaintext highlighter-rouge">RenderPipeline</code>s with <code class="language-plaintext highlighter-rouge">RenderLayer</code>s.</p>
      <h3 id="nbt">NBT</h3>
      <p>
        <code class="language-plaintext highlighter-rouge">BlockEntity</code>s now abstract saving to NBT through <code class="language-plaintext highlighter-rouge">ReadView</code>s and <code class="language-plaintext highlighter-rouge">WriteView</code>s. These views are responsible for storing errors from encoding / decoding, and keeping track of registries throughout the serialization process. You can read from a <code class="language-plaintext highlighter-rouge">ReadView</code> using the <code class="language-plaintext highlighter-rouge">read</code> method, passing in a <code class="language-plaintext highlighter-rouge">Codec</code> for the desired type. Likewise, you can write to a <code class="language-plaintext highlighter-rouge">WriteView</code> by using the <code class="language-plaintext highlighter-rouge">put</code> method, passing in a <code class="language-plaintext highlighter-rouge">Codec</code> for the type, and the value in question. there are also methods for primitives, under <code class="language-plaintext highlighter-rouge">get(Int, Short, Boolean, ...)</code> and <code class="language-plaintext highlighter-rouge">put(Int, Short, Boolean, ...)</code>. The View also provides methods for working with lists, nullable types, and nested objects.</p>
      <div class="language-java highlighter-rouge">
        <div class="highlight">
          <pre class="highlight">
            <code>
              <span class="kd">class</span>
              <span class="nc">BE</span>
              <span class="kd">extends</span>
              <span class="nc">BlockEntity</span>
              <span class="o">{</span>
              <span class="kd">private</span>
              <span class="kt">int</span>
              <span class="n">anInt</span>
              <span class="o">;</span>
              <span class="kd">private</span>
              <span class="nc">String</span>
              <span class="n">aString</span>
              <span class="o">;</span>
              <span class="kd">private</span>
              <span class="nc">Extra</span>
              <span class="n">extra</span>
              <span class="o">;</span>
              <span class="c1">// Ctor excluded for brevity</span>
              <span class="nd">@Override</span>
              <span class="kd">public</span>
              <span class="nc">NbtCompound</span>
              <span class="nf">toInitialChunkDataNbt</span>
              <span class="o">(</span>
              <span class="nc">RegistryWrapper</span>
              <span class="o">.</span>
              <span class="na">WrapperLookup</span>
              <span class="n">registries</span>
              <span class="o">)</span>
              <span class="o">{</span>
              <span class="k">return</span>
              <span class="nf">createNbt</span>
              <span class="o">(</span>
              <span class="n">registries</span>
              <span class="o">);</span>
              <span class="c1">// createNbt takes care of adapting to / from WriteView</span>
              <span class="o">}</span>
              <span class="nd">@Override</span>
              <span class="kd">protected</span>
              <span class="kt">void</span>
              <span class="nf">writeData</span>
              <span class="o">(</span>
              <span class="nc">WriteView</span>
              <span class="n">view</span>
              <span class="o">)</span>
              <span class="o">{</span>
              <span class="kd">super</span>
              <span class="o">.</span>
              <span class="na">writeData</span>
              <span class="o">(</span>
              <span class="n">view</span>
              <span class="o">);</span>
              <span class="n">view</span>
              <span class="o">.</span>
              <span class="na">putNullable</span>
              <span class="o">(</span>
              <span class="s">"extra"</span>
              <span class="o">,</span>
              <span class="nc">Extra</span>
              <span class="o">.</span>
              <span class="na">CODEC</span>
              <span class="o">,</span>
              <span class="k">this</span>
              <span class="o">.</span>
              <span class="na">extra</span>
              <span class="o">);</span>
              <span class="k">if</span>
              <span class="o">(</span>
              <span class="n">aString</span>
              <span class="o">!=</span>
              <span class="kc">null</span>
              <span class="o">)</span>
              <span class="c1">// putString will eventually throw if we pass null</span>
              <span class="n">view</span>
              <span class="o">.</span>
              <span class="na">putString</span>
              <span class="o">(</span>
              <span class="s">"aString"</span>
              <span class="o">,</span>
              <span class="n">aString</span>
              <span class="o">);</span>
              <span class="n">view</span>
              <span class="o">.</span>
              <span class="na">putInt</span>
              <span class="o">(</span>
              <span class="s">"anInt"</span>
              <span class="o">,</span>
              <span class="n">anInt</span>
              <span class="o">);</span>
              <span class="o">}</span>
              <span class="nd">@Override</span>
              <span class="kd">protected</span>
              <span class="kt">void</span>
              <span class="nf">readData</span>
              <span class="o">(</span>
              <span class="nc">ReadView</span>
              <span class="n">view</span>
              <span class="o">)</span>
              <span class="o">{</span>
              <span class="kd">super</span>
              <span class="o">.</span>
              <span class="na">readData</span>
              <span class="o">(</span>
              <span class="n">view</span>
              <span class="o">);</span>
              <span class="n">view</span>
              <span class="o">.</span>
              <span class="na">read</span>
              <span class="o">(</span>
              <span class="s">"extra"</span>
              <span class="o">,</span>
              <span class="nc">Extra</span>
              <span class="o">.</span>
              <span class="na">CODEC</span>
              <span class="o">).</span>
              <span class="na">ifPresent</span>
              <span class="o">(</span>
              <span class="n">extra</span>
              <span class="o">-&gt;</span>
              <span class="k">this</span>
              <span class="o">.</span>
              <span class="na">extra</span>
              <span class="o">=</span>
              <span class="n">extra</span>
              <span class="o">);</span>
              <span class="n">view</span>
              <span class="o">.</span>
              <span class="na">getOptionalString</span>
              <span class="o">(</span>
              <span class="s">"aString"</span>
              <span class="o">).</span>
              <span class="na">ifPresent</span>
              <span class="o">(</span>
              <span class="n">aString</span>
              <span class="o">-&gt;</span>
              <span class="k">this</span>
              <span class="o">.</span>
              <span class="na">aString</span>
              <span class="o">=</span>
              <span class="n">aString</span>
              <span class="o">);</span>
              <span class="n">view</span>
              <span class="o">.</span>
              <span class="na">getOptionalInt</span>
              <span class="o">(</span>
              <span class="s">"anInt"</span>
              <span class="o">).</span>
              <span class="na">ifPresent</span>
              <span class="o">(</span>
              <span class="n">anInt</span>
              <span class="o">-&gt;</span>
              <span class="k">this</span>
              <span class="o">.</span>
              <span class="na">anInt</span>
              <span class="o">=</span>
              <span class="n">anInt</span>
              <span class="o">);</span>
              <span class="o">}</span>
              <span class="n">record</span>
              <span class="nf">Extra</span>
              <span class="o">(</span>
              <span class="kt">int</span>
              <span class="n">i</span>
              <span class="o">,</span>
              <span class="kt">int</span>
              <span class="n">j</span>
              <span class="o">)</span>
              <span class="o">{</span>
              <span class="kd">public</span>
              <span class="kd">static</span>
              <span class="kd">final</span>
              <span class="nc">Codec</span>
              <span class="o">&lt;</span>
              <span class="nc">Extra</span>
              <span class="o">&gt;</span>
              <span class="no">CODEC</span>
              <span class="o">=</span>
              <span class="nc">RecordCodecBuilder</span>
              <span class="o">.</span>
              <span class="na">create</span>
              <span class="o">(</span>
              <span class="n">instance</span>
              <span class="o">-&gt;</span>
              <span class="n">instance</span>
              <span class="o">.</span>
              <span class="na">group</span>
              <span class="o">(</span>
              <span class="nc">Codec</span>
              <span class="o">.</span>
              <span class="na">INT</span>
              <span class="o">.</span>
              <span class="na">fieldOf</span>
              <span class="o">(</span>
              <span class="s">"i"</span>
              <span class="o">).</span>
              <span class="na">forGetter</span>
              <span class="o">(</span>
              <span class="n">extra</span>
              <span class="o">-&gt;</span>
              <span class="n">extra</span>
              <span class="o">.</span>
              <span class="na">i</span>
              <span class="o">),</span>
              <span class="nc">Codec</span>
              <span class="o">.</span>
              <span class="na">INT</span>
              <span class="o">.</span>
              <span class="na">fieldOf</span>
              <span class="o">(</span>
              <span class="s">"j"</span>
              <span class="o">).</span>
              <span class="na">forGetter</span>
              <span class="o">(</span>
              <span class="n">extra</span>
              <span class="o">-&gt;</span>
              <span class="n">extra</span>
              <span class="o">.</span>
              <span class="na">j</span>
              <span class="o">)).</span>
              <span class="na">apply</span>
              <span class="o">(</span>
              <span class="n">instance</span>
              <span class="o">,</span>
              <span class="nl">Extra:</span>
              <span class="o">:</span>
              <span class="k">new</span>
              <span class="o">));</span>
              <span class="o">}</span>
              <span class="o">}</span>
            </code>
          </pre>
        </div>
      </div>
      <h3 id="data-generation">Data Generation</h3>
      <ul>
        <li>
          <code class="language-plaintext highlighter-rouge">getOrCreateTagBuilder</code> should be replaced with the new <code class="language-plaintext highlighter-rouge">valueLookupBuilder</code>.
        </li>
      </ul>
    </content>
    <author>
      <name/>
    </author>
    <summary type="html">A new version of Minecraft is coming soon with some changes that affect most mod makers. As always, we ask all players to be patient, and give mod developers time to update to this new version. We kindly ask everyone not to pester them. We also recommend all players make backups of their worlds.</summary>
  </entry>
  <entry>
    <title type="html">Fabric for Minecraft 1.21.5</title>
    <link href="https://fabricmc.net/2025/03/24/1215.html" rel="alternate" type="text/html" title="Fabric for Minecraft 1.21.5"/>
    <published>2025-03-24T00:00:00+00:00</published>
    <updated>2025-03-24T00:00:00+00:00</updated>
    <id>https://fabricmc.net/2025/03/24/1215</id>
    <content type="html" xml:base="https://fabricmc.net/2025/03/24/1215.html">
      <p>A new version of Minecraft is coming soon with some changes that affect most mod makers. As always, <strong>we ask all players to be patient, and give mod developers time to update to this new version.</strong> We kindly ask everyone not to pester them. <strong>We also recommend all players make backups of their worlds.</strong>
      </p>
      <p>Here is a list of several major modder-facing changes in this version. Note that all code references are using Yarn mappings; modders using alternative mappings may need to use different names.</p>
      <h2 id="fabric-changes">Fabric changes</h2>
      <p>Developers should use Loom 1.10 (at the time of writing) to develop mods for Minecraft 1.21.5. Players should install the latest stable version of Fabric Loader (currently 0.16.10).</p>
      <h3 id="loom-110">Loom 1.10</h3>
      <p>Loom 1.10 requires Gradle 8.12, and comes with performance improvements and enhanced testing setup support. You can checkout the new Loom documentation <a href="https://docs.fabricmc.net/develop/loom/">here</a>.
      </p>
      <h3 id="deprecations-and-removals">Deprecations and removals</h3>
      <p>In Content Registries, <code class="language-plaintext highlighter-rouge">VillagerInteractionsRegistries#registerGiftLootTable</code> overload that takes an <code class="language-plaintext highlighter-rouge">Identifier</code> was removed. This method was previously deprecated.</p>
      <p>In Object Builder, two deprecated classes, namely <code class="language-plaintext highlighter-rouge">VillagerProfessionBuilder</code> and <code class="language-plaintext highlighter-rouge">VillagerTypeHelper</code>, have been removed. Use the <code class="language-plaintext highlighter-rouge">VillagerProfession</code> constructor and <code class="language-plaintext highlighter-rouge">VillagerType#create</code> instead. <code class="language-plaintext highlighter-rouge">TradeOfferHelper#refreshOffers</code>, which had been deprecated and did nothing, was also removed.</p>
      <p>
        <code class="language-plaintext highlighter-rouge">HudRenderCallback</code> has been deprecated in favor of newly added <code class="language-plaintext highlighter-rouge">HudLayerRegistrationCallback</code>.
      </p>
      <h3 id="breaking-changes">Breaking changes</h3>
      <p>When a mod creates a new dynamic registry, the data pack JSON files for the registry must now be placed inside namespaced directories. For example, if the new registry is <code class="language-plaintext highlighter-rouge">example:potato_variant</code>, the file for variant <code class="language-plaintext highlighter-rouge">test:tiny</code> will be placed in <code class="language-plaintext highlighter-rouge">data/test/example/potato_variant/tiny.json</code>.        <!-- https://github.com/FabricMC/fabric/pull/4180 --></p>
      <p>
        <code class="language-plaintext highlighter-rouge">BiomeModificationContext#addSpawn</code> has a new parameter, <code class="language-plaintext highlighter-rouge">weight</code>. This was previously part of <code class="language-plaintext highlighter-rouge">SpawnEntry</code>.
      </p>
      <p>
        <code class="language-plaintext highlighter-rouge">TradeOfferHelper</code> now takes a <code class="language-plaintext highlighter-rouge">RegistryKey</code> of the profession instead of <code class="language-plaintext highlighter-rouge">VillagerProfession</code>. Wandering trader trades must now be added via the builder, which was previously used for the Rebalance experiment. (The rebalanced trades are now used in all worlds.)</p>
      <h3 id="new-fabric-api-changes">New Fabric API changes</h3>
      <p>With the help of many contributors, Fabric API has received some new features since the last update blog post:</p>
      <ul>
        <li>New module: Client Game Test API, which can be used to automatically test client rendering and GUI (Earthcomputer)</li>
        <li>New module: Fabric Tag API, which currently handles tag aliases (Juxxel)</li>
        <li>Convention Tags: Sync remaining <code class="language-plaintext highlighter-rouge">c</code> tags with NeoForge (TelepathicGrunt)</li>
        <li>Convention Tags: Add <code class="language-plaintext highlighter-rouge">c:flowers</code>,          <code class="language-plaintext highlighter-rouge">c:flowers/tall</code>, and <code class="language-plaintext highlighter-rouge">c:flowers/small</code> block and item tags (TelepathicGrunt)</li>
        <li>Convention Tags: Add <code class="language-plaintext highlighter-rouge">TagKey</code> for <code class="language-plaintext highlighter-rouge">c:tools/wrench</code> (TelepathicGrunt)</li>
        <li>Convention Tags: Convention Drink Tags (TheDeathlyCow)</li>
        <li>Convention Tags: Add Pumpkin Block and Item Tags (JT122406)</li>
        <li>Data Generation: Add vararg helper methods for multi-tag support in <code class="language-plaintext highlighter-rouge">FabricTagBuilder</code> (Starexify)</li>
        <li>Data Generation: Add <code class="language-plaintext highlighter-rouge">FabricEntityLootTableProvider</code> (Antikyth)</li>
        <li>Item API: Add a method for overriding modelId in item settings (Patbox)</li>
        <li>Item API: Add <code class="language-plaintext highlighter-rouge">contains</code> method to <code class="language-plaintext highlighter-rouge">FabricComponentMapBuilder</code> (TheDeathlyCow)</li>
        <li>Item Group API: Change Creative Buttons Texture (matthewperiut)</li>
        <li>Item Group API: Use page up/down to change creative inventory pages (modmuss50)</li>
        <li>Model Loading API: Allow retrieving model loading plugins (PepperCode1)</li>
        <li>Networking API: Add <code class="language-plaintext highlighter-rouge">ServerPlayNetworking.reconfigure</code> (modmuss50)</li>
        <li>Object Builder: Allow setting <code class="language-plaintext highlighter-rouge">canPotentiallyExecuteCommands</code> in builders (PepperCode1)</li>
        <li>Recipe API: Add <code class="language-plaintext highlighter-rouge">getAllMatches</code> and <code class="language-plaintext highlighter-rouge">getAllOfType</code> methods to <code class="language-plaintext highlighter-rouge">ServerRecipeManager</code> (Patbox)</li>
        <li>Registry Sync: Add <code class="language-plaintext highlighter-rouge">RegistryAttribute#OPTIONAL</code> that can be used to not disconnect clients lacking an entire registry; note that optional registry values are still unsupported (modmuss50)</li>
        <li>Registry Sync: Registry aliasing (Syst3ms)</li>
        <li>Rendering: Add <code class="language-plaintext highlighter-rouge">SpecialBlockRendererRegistry</code> (PepperCode1)</li>
        <li>Rendering: Add HUD Render Events (kevinthegreat1)</li>
        <li>Resource Loader: Implement builtin mod resource/data pack sorting (Apollo)</li>
      </ul>
      <h3 id="tag-and-registry-aliases">Tag and registry aliases</h3>
      <p>The new tag and registry alias APIs allow for mods to seemlessly migrate their tags and registry aliases to new names. Thanks to Juuxel and Syst3ms respectively for implementing these new APIs.</p>
      <div class="language-java highlighter-rouge">
        <div class="highlight">
          <pre class="highlight">
            <code>
              <span class="nc">Registries</span>
              <span class="o">.</span>
              <span class="na">BLOCK</span>
              <span class="o">.</span>
              <span class="na">addAlias</span>
              <span class="o">(</span>
              <span class="nc">Identifier</span>
              <span class="o">.</span>
              <span class="na">of</span>
              <span class="o">(</span>
              <span class="s">"my_mod"</span>
              <span class="o">,</span>
              <span class="s">"old"</span>
              <span class="o">),</span>
              <span class="nc">Registries</span>
              <span class="o">.</span>
              <span class="na">BLOCK</span>
              <span class="o">.</span>
              <span class="na">get</span>
              <span class="o">(</span>
              <span class="nc">Identifier</span>
              <span class="o">.</span>
              <span class="na">of</span>
              <span class="o">(</span>
              <span class="s">"my_mod"</span>
              <span class="o">,</span>
              <span class="s">"new"</span>
              <span class="o">)));</span>
            </code>
          </pre>
        </div>
      </div>
      <p>Registry aliases are really simple; with the code above, any access to the old ID in the registry is redirected to the new ID. This allows worlds to be upgraded to use the new ID; for example, a block with the old ID becomes the one with the new ID.</p>
      <p>Tag aliases are defined in data packs like tags. For example, a block tag alias group for fences would be located at <code class="language-plaintext highlighter-rouge">data/my_mod/fabric/tag_aliases/block/fences.json</code> with the contents:</p>
      <div class="language-json highlighter-rouge">
        <div class="highlight">
          <pre class="highlight">
            <code>
              <span class="p">{</span>
              <span class="w"></span>
              <span class="nl">"tags"</span>
              <span class="p">:</span>
              <span class="w"></span>
              <span class="p">[</span>
              <span class="w"></span>
              <span class="s2">"minecraft:fences"</span>
              <span class="p">,</span>
              <span class="w"></span>
              <span class="s2">"c:fences"</span>
              <span class="w"></span>
              <span class="p">]</span>
              <span class="w"></span>
              <span class="p">}</span>
              <span class="w"></span>
            </code>
          </pre>
        </div>
      </div>
      <h3 id="client-gametest">Client GameTest</h3>
      <p>For a long time, Fabric has had an internal client test framework that was used for testing that Fabric API was working correctly on the client. In a series of PRs, Earthcomputer has worked to expand and expose this framework to mod developers. The new experimental API has the following features:</p>
      <ul>
        <li>World creation API, for specifying options used to generate the test world.</li>
        <li>Screenshot API, with support for comparing against golden images.</li>
        <li>Input API, to simulate a user interacting with the game.</li>
        <li>Advanced threading setup, to make the tests more repoducible.</li>
        <li>Network synchronization, to ensure packets are handled consistently.</li>
        <li>Herobrine removal, to bring peace to the Kingdom of Tiny Potato.</li>
      </ul>
      <p>For more information checkout the full documentation <a href="https://maven.fabricmc.net/docs/fabric-api-0.119.2+1.21.5/net/fabricmc/fabric/api/client/gametest/v1/package-summary.html">here</a>.
      </p>
      <h3 id="hud-render-events">HUD Render Events</h3>
      <p>Fabric API 0.116.0 added <code class="language-plaintext highlighter-rouge">HudLayerRegistrationCallback</code> event, providing full control over the HUD rendering process. The new API assigns idenftifiers to each layer that can be used to specify where things will be rendered. The new API also allows replacing or removing existing layers. A big thanks to kevinthegreat1 and many other people for making this happen!</p>
      <h2 id="minecraft-changes">Minecraft changes</h2>
      <h3 id="nbt">NBT</h3>
      <p>Significant changes to NBT handling code have been made.</p>
      <p>
        <code class="language-plaintext highlighter-rouge">NbtCompound</code> methods now return <code class="language-plaintext highlighter-rouge">Optional</code> instead of the value. If the key is not in the compound or if the value is not of the correct type, an empty optional is now returned instead of that type’s default value.</p>
      <div class="language-diff highlighter-rouge">
        <div class="highlight">
          <pre class="highlight">
            <code>
              <span class="gd">- int value = nbt.getInt("value"); </span>
              <span class="gi">+ Optional&lt;Integer&gt; value = nbt.getInt("value"); // not OptionalInt </span>
            </code>
          </pre>
        </div>
      </div>
      <p>For primitives (numbers and strings), instead of checking for the existence of a key and handling a fallback, the fallback can now be passed to <code class="language-plaintext highlighter-rouge">get</code> methods:</p>
      <div class="language-diff highlighter-rouge">
        <div class="highlight">
          <pre class="highlight">
            <code>
              <span class="gd">- int value; - if (nbt.contains("value", NbtElement.NUMBER_TYPE)) { - value = nbt.getInt("value"); - } else { - value = 1000; - } </span>
              <span class="gi">+ int value = nbt.getInt("value", 1000); </span>
            </code>
          </pre>
        </div>
      </div>
      <p>Also note that <code class="language-plaintext highlighter-rouge">NbtElement#NUMBER_TYPE</code> and type-aware <code class="language-plaintext highlighter-rouge">contains</code> have been removed. There is no fallback method for <code class="language-plaintext highlighter-rouge">getIntArray</code>,        <code class="language-plaintext highlighter-rouge">getLongArray</code>, and <code class="language-plaintext highlighter-rouge">getByteArray</code>. (Use <code class="language-plaintext highlighter-rouge">Optional#orElse</code>.)
      </p>
      <p>For <code class="language-plaintext highlighter-rouge">getCompound</code> and <code class="language-plaintext highlighter-rouge">getList</code> methods, methods with the previous behavior (returning empty objects) are provided with <code class="language-plaintext highlighter-rouge">OrEmpty</code> suffix.</p>
      <div class="language-diff highlighter-rouge">
        <div class="highlight">
          <pre class="highlight">
            <code>
              <span class="gd">- NbtCompound config = nbt.getCompound("config"); </span>
              <span class="gi">+ NbtCompound config = nbt.getCompoundOrEmpty("config"); </span>
            </code>
          </pre>
        </div>
      </div>
      <p>Finally, for those who want to encode/decode codec-based values (such as <code class="language-plaintext highlighter-rouge">Identifier</code>) stored in a <code class="language-plaintext highlighter-rouge">NbtCompound</code> field, new methods simplify the process:</p>
      <pre>
        <code class="language-java=">NbtCompound nbt = new NbtCompound(); nbt.put("Id", Identifier.CODEC, id); // for reading Optional&lt;Identifier&gt; id = nbt.get("Id", Identifier.CODEC); </code>
      </pre>
      <p>And if there is a codec for the whole object:</p>
      <pre>
        <code class="language-java=">NbtCompound nbt = new NbtCompound(); // have to use the RegistryOps since an item is a registry entry nbt.copyFromCodec(ItemStack.MAP_CODEC, wrapperLookup.getOps(NbtOps.INSTANCE), stack); // for reading Optional&lt;ItemStack&gt; stack = nbt.decode(ItemStack.MAP_CODEC, wrapperLookup.getOps(NbtOps.INSTANCE)); </code>
      </pre>
      <p>Typed arrays (<code class="language-plaintext highlighter-rouge">ByteArray</code>,        <code class="language-plaintext highlighter-rouge">IntArray</code>, and <code class="language-plaintext highlighter-rouge">LongArray</code>) are no longer <code class="language-plaintext highlighter-rouge">List</code>s. They can be converted to a list using <code class="language-plaintext highlighter-rouge">.stream().toList()</code>, but this is usually not necessary. <code class="language-plaintext highlighter-rouge">NbtList</code> can now contain values of differing types, but this should be a transparent change unless you work with binary data.</p>
      <h3 id="gametest">GameTest</h3>
      <p>In Minecraft <a href="https://www.minecraft.net/en-us/article/minecraft-snapshot-25w03a">25w03a</a>, Mojang totally refactored the vanilla testing framework, exposing it to datapack developers. Unfortunately, the new API is a little bit cumbersome for mod developers. Fabric API now provides its own <code class="language-plaintext highlighter-rouge">@GameTest</code> annotation that functions similarly to the old one. The options in the new Fabric-provided <code class="language-plaintext highlighter-rouge">@GameTest</code> annotation directly map the vanilla data-driven options, removing the need to have a JSON file for each test function. Data driven tests will still work if you wish to use the vanilla system.</p>
      <h3 id="miscellaneous">Miscellaneous</h3>
      <ul>
        <li>
          <code class="language-plaintext highlighter-rouge">DataPool</code> has been replaced with <code class="language-plaintext highlighter-rouge">Pool</code>.
        </li>
        <li>
          <code class="language-plaintext highlighter-rouge">AbstractBlock#onStateReplaced</code> has been significantly changed, the state provided is the old state and it now runs after block entities get removed. Block entities should use <code class="language-plaintext highlighter-rouge">BlockEntity#onBlockReplaced</code> instead.</li>
      </ul>
    </content>
    <author>
      <name/>
    </author>
    <summary type="html">A new version of Minecraft is coming soon with some changes that affect most mod makers. As always, we ask all players to be patient, and give mod developers time to update to this new version. We kindly ask everyone not to pester them. We also recommend all players make backups of their worlds.</summary>
  </entry>
  <entry>
    <title type="html">Fabric for Minecraft 1.21.4</title>
    <link href="https://fabricmc.net/2024/12/02/1214.html" rel="alternate" type="text/html" title="Fabric for Minecraft 1.21.4"/>
    <published>2024-12-02T00:00:00+00:00</published>
    <updated>2024-12-02T00:00:00+00:00</updated>
    <id>https://fabricmc.net/2024/12/02/1214</id>
    <content type="html" xml:base="https://fabricmc.net/2024/12/02/1214.html">
      <p>Minecraft 1.21.4, the Garden Awakens drop, releases December 3rd. Like with other updates, this drop contains some significant changes affecting mod makers.</p>
      <p>As always, <strong>we ask all players to be patient, and give mod developers time to update to this new version.</strong> We kindly ask everyone not to pester them. <strong>We also recommend all players make backups of their worlds.</strong>
      </p>
      <p>Here is a list of several major modder-facing changes in this version. Note that all code references are using Yarn mappings; modders using alternative mappings may need to use different names.</p>
      <h2 id="fabric-changes">Fabric changes</h2>
      <p>Developers should use Loom 1.9 (at the time of writing) to develop mods for Minecraft 1.21.4. Players should install the latest stable version of Fabric Loader (currently 0.16.9).</p>
      <h3 id="deprecations-and-removals">Deprecations and removals</h3>
      <p>The following deprecated module was removed: <code class="language-plaintext highlighter-rouge">fabric-rendering-v0</code>.        <code class="language-plaintext highlighter-rouge">FabricModelPredicateProviderRegistry</code>, which was previously deprecated, was also removed.</p>
      <p>
        <code class="language-plaintext highlighter-rouge">BuiltinItemRenderer</code> and <code class="language-plaintext highlighter-rouge">BuiltinItemRendererRegistry</code> from the Rendering v1 module were removed and have been replaced by a transitive access widener to <code class="language-plaintext highlighter-rouge">SpecialModelTypes.ID_MAPPER</code>.
      </p>
      <p>
        <code class="language-plaintext highlighter-rouge">AttachmentRegistry#builder</code> was deprecated in favor of <code class="language-plaintext highlighter-rouge">create</code> methods. The old method is inconvenient, as it requires explicit type parameters. (See the “Data Attachment Syncing” section for an example.)</p>
      <p>
        <code class="language-plaintext highlighter-rouge">BlockPickInteractionAware</code> was removed, the new pick item events should be used instead.</p>
      <h3 id="breaking-change">Breaking change</h3>
      <p>
        <code class="language-plaintext highlighter-rouge">CustomIngredient#getMatchingStacks</code> must now return a stream, not a list.</p>      <!-- NOTE: despite what the semver suggests, Biome API DID NOT receive a breaking change in 24w44a. -->
      <h3 id="new-fabric-api-changes">New Fabric API changes</h3>
      <p>With the help of many contributors, Fabric API has received some new features since the last update blog post:</p>
      <ul>
        <li>Convention Tags: Add more tags (JT122406, TelepathicGrunt, IThundxr)</li>
        <li>Data Attachments: Registration enhancements (forgetmenot13579)</li>
        <li>Data Attachments: Sync API (Syst3ms)</li>
        <li>Lifecycle Events: Add <code class="language-plaintext highlighter-rouge">ServerChunkEvents.Generate</code> (jpenilla)</li>
        <li>Lifecycle Events: Add <code class="language-plaintext highlighter-rouge">AFTER_CLIENT_WORLD_CHANGE</code> (fishshi)</li>
        <li>Transfer API: Add support for Item-containing Items (BasiqueEvangelist)</li>
      </ul>
      <p>In addition, a longstanding bug that caused language files to not load after overriding <code class="language-plaintext highlighter-rouge">assets/minecraft/lang/en_us.json</code> in a dedicated server mod was fixed.</p>
      <h4 id="data-attachment-syncing">Data Attachment Syncing</h4>
      <p>Fabric API can now sync data attachments. To make a syncable attachment, call <code class="language-plaintext highlighter-rouge">syncWith</code> inside the builder. The passed packet codec is used to serialize the attached data. Here is how a thirst attachment would look like:</p>
      <div class="language-java highlighter-rouge">
        <div class="highlight">
          <pre class="highlight">
            <code>
              <span class="kd">public</span>
              <span class="kd">static</span>
              <span class="kd">final</span>
              <span class="nc">AttachmentType</span>
              <span class="o">&lt;</span>
              <span class="nc">Integer</span>
              <span class="o">&gt;</span>
              <span class="no">THIRST</span>
              <span class="o">=</span>
              <span class="nc">AttachmentRegistry</span>
              <span class="o">.</span>
              <span class="na">create</span>
              <span class="o">(</span>
              <span class="nc">Identifier</span>
              <span class="o">.</span>
              <span class="na">of</span>
              <span class="o">(</span>
              <span class="s">"modid"</span>
              <span class="o">,</span>
              <span class="s">"thirst"</span>
              <span class="o">),</span>
              <span class="n">builder</span>
              <span class="o">-&gt;</span>
              <span class="n">builder</span>
              <span class="o">.</span>
              <span class="na">initializer</span>
              <span class="o">(()</span>
              <span class="o">-&gt;</span>
              <span class="mi">20</span>
              <span class="o">)</span>
              <span class="c1">// start with a default value like hunger</span>
              <span class="o">.</span>
              <span class="na">persistent</span>
              <span class="o">(</span>
              <span class="nc">Codec</span>
              <span class="o">.</span>
              <span class="na">INT</span>
              <span class="o">)</span>
              <span class="c1">// persist across restarts</span>
              <span class="o">.</span>
              <span class="na">syncWith</span>
              <span class="o">(</span>
              <span class="nc">PacketCodecs</span>
              <span class="o">.</span>
              <span class="na">VAR_INT</span>
              <span class="o">,</span>
              <span class="nc">AttachmentSyncPredicate</span>
              <span class="o">.</span>
              <span class="na">targetOnly</span>
              <span class="o">())</span>
              <span class="c1">// only the player's own client needs the value for rendering</span>
              <span class="o">);</span>
            </code>
          </pre>
        </div>
      </div>
      <p>The sync predicate (<code class="language-plaintext highlighter-rouge">AttachmentSyncPredicate</code>) controls who gets the synced data. For example, global data can be synced using <code class="language-plaintext highlighter-rouge">all()</code>. For more granular control, you can also pass a custom predicate.</p>
      <h4 id="pick-item-events">Pick item events</h4>
      <p>Minecraft 1.21.4 moves the ‘Pick Block’ functionality from the client to the logical server. As such, the existing client events have been replaced with new, server-side ones. This replaces <code class="language-plaintext highlighter-rouge">ClientPickBlockApplyCallback</code>,        <code class="language-plaintext highlighter-rouge">ClientPickBlockCallback</code>, and <code class="language-plaintext highlighter-rouge">ClientPickBlockGatherCallback</code>. This change also applies to entities (<code class="language-plaintext highlighter-rouge">EntityPickInteractionAware</code>).
      </p>
      <p>The new events are <code class="language-plaintext highlighter-rouge">PlayerPickItemEvents#BLOCK</code> for picking a block and <code class="language-plaintext highlighter-rouge">PlayerPickItemEvents#ENTITY</code> for picking an entity(‘s spawn egg). Return <code class="language-plaintext highlighter-rouge">ItemStack.EMPTY</code> to stop the picking, and return <code class="language-plaintext highlighter-rouge">null</code> to use the default behavior.</p>
      <div class="language-java highlighter-rouge">
        <div class="highlight">
          <pre class="highlight">
            <code>
              <span class="nc">PlayerPickItemEvents</span>
              <span class="o">.</span>
              <span class="na">BLOCK</span>
              <span class="o">.</span>
              <span class="na">register</span>
              <span class="o">((</span>
              <span class="n">player</span>
              <span class="o">,</span>
              <span class="n">pos</span>
              <span class="o">,</span>
              <span class="n">state</span>
              <span class="o">,</span>
              <span class="n">requestIncludeData</span>
              <span class="o">)</span>
              <span class="o">-&gt;</span>
              <span class="o">{</span>
              <span class="k">if</span>
              <span class="o">(</span>
              <span class="n">state</span>
              <span class="o">.</span>
              <span class="na">isIn</span>
              <span class="o">(</span>
              <span class="nc">MyTags</span>
              <span class="o">.</span>
              <span class="na">NOT_PICKABLE</span>
              <span class="o">))</span>
              <span class="k">return</span>
              <span class="nc">ItemStack</span>
              <span class="o">.</span>
              <span class="na">EMPTY</span>
              <span class="o">;</span>
              <span class="k">return</span>
              <span class="kc">null</span>
              <span class="o">;</span>
              <span class="c1">// use default behavior</span>
              <span class="o">})</span>
            </code>
          </pre>
        </div>
      </div>
      <p>
        <code class="language-plaintext highlighter-rouge">requestIncludeData</code> is <code class="language-plaintext highlighter-rouge">true</code> if the client requests NBT to be included in the returned item stack (by holding <code class="language-plaintext highlighter-rouge">Ctrl</code> while picking block). This parameter is also available to the entity pick item event, even though vanilla does not use this functionality (spawn eggs do not include the picked entity’s NBT).</p>
      <p>Note that this only checks if the client is asking NBT data, and does not check game mode or permission level. In vanilla, NBT data is only included for Creative mode players.</p>
      <h4 id="client-data-generation">Client Data Generation</h4>
      <p>Starting with Minecraft 1.21.4, Mojang has moved a number of data generation classes to the client. Loom 1.9 adds a new option that allows you to run your data generation against the client. See the following example if you are using the <code class="language-plaintext highlighter-rouge">fabricApi</code> utility to set up data generation:</p>
      <div class="language-diff highlighter-rouge">
        <div class="highlight">
          <pre class="highlight">
            <code> fabricApi { <span class="gd">- configureDataGeneration() </span>
              <span class="gi">+ configureDataGeneration { + client = true + } </span> } 
            </code>
          </pre>
        </div>
      </div>
      <p>If you are using the <code class="language-plaintext highlighter-rouge">createSourceSet</code> option, your <code class="language-plaintext highlighter-rouge">datagen</code> source set will now have access to Minecraft’s client-only classes and classes in your <code class="language-plaintext highlighter-rouge">client</code> source set. Other than updating the data generators themselves, no other changes will be necessary.</p>
      <p>If you are using the <code class="language-plaintext highlighter-rouge">splitEnvironmentSourceSets</code> option but not the <code class="language-plaintext highlighter-rouge">createSourceSet</code> option, you should move your <code class="language-plaintext highlighter-rouge">DataGeneratorEntrypoint</code> implementation from the <code class="language-plaintext highlighter-rouge">main</code> source set to the <code class="language-plaintext highlighter-rouge">client</code> source set.</p>
      <h4 id="model-loading-api">Model Loading API</h4>
      <p>
        <code class="language-plaintext highlighter-rouge">ModelModifier</code> events and callbacks have been split; there is now one set for static models and one set for block models. This was necessary because static models use <code class="language-plaintext highlighter-rouge">UnbakedModel</code> and are baked with settings while block models use <code class="language-plaintext highlighter-rouge">GroupableModel</code> (which no longer extends <code class="language-plaintext highlighter-rouge">UnbakedModel</code>) and are not baked with settings. It also allowed cleaning up the identifier getters and providing the <code class="language-plaintext highlighter-rouge">BlockState</code> directly to <code class="language-plaintext highlighter-rouge">ModelModifier.OnLoadBlock</code>.
      </p>
      <p>However, all <code class="language-plaintext highlighter-rouge">BeforeBake</code> and <code class="language-plaintext highlighter-rouge">AfterBake</code> events were removed. This is because their behavior can now be achieved using the <code class="language-plaintext highlighter-rouge">OnLoad</code> events, by wrapping the given model and overriding the <code class="language-plaintext highlighter-rouge">bake</code> method to replace the unbaked model passed to <code class="language-plaintext highlighter-rouge">super.bake</code> (to replicate <code class="language-plaintext highlighter-rouge">BeforeBake</code>) or replace the result of <code class="language-plaintext highlighter-rouge">super.bake</code> (to replicate <code class="language-plaintext highlighter-rouge">AfterBake</code>). This is possible because 1.21.4 made it so the parent of a <code class="language-plaintext highlighter-rouge">JsonUnbakedModel</code> no longer has to be another <code class="language-plaintext highlighter-rouge">JsonUnbakedModel</code>. To make this easier, the utility classes <code class="language-plaintext highlighter-rouge">WrapperUnbakedModel</code> and <code class="language-plaintext highlighter-rouge">WrapperGroupableModel</code> were added, which forward all method calls to a <code class="language-plaintext highlighter-rouge">wrapper</code> field. There were also some minor fundamental issues with <code class="language-plaintext highlighter-rouge">BeforeBake</code> and <code class="language-plaintext highlighter-rouge">AfterBake</code> events, which prompted their removal.</p>
      <p>
        <code class="language-plaintext highlighter-rouge">ModelModifier.OnLoad</code> can now accept a <code class="language-plaintext highlighter-rouge">null</code> model, which is a model that was requested during resolution but does not have a corresponding JSON file. With this change, <code class="language-plaintext highlighter-rouge">ModelResolver</code> was removed as its behavior could now be achieved with <code class="language-plaintext highlighter-rouge">ModelModifier.OnLoad</code> with <code class="language-plaintext highlighter-rouge">OVERRIDE_PHASE</code>.
      </p>
      <p>
        <code class="language-plaintext highlighter-rouge">DelegatingUnbakedModel</code> was removed as <code class="language-plaintext highlighter-rouge">GroupableModel</code> no longer extends <code class="language-plaintext highlighter-rouge">UnbakedModel</code>, so <code class="language-plaintext highlighter-rouge">BlockModelResolver</code>s can no longer use it, which was its original purpose.</p>
      <p>
        <code class="language-plaintext highlighter-rouge">textureGetter</code> was removed from <code class="language-plaintext highlighter-rouge">ModelModifier</code> callback contexts as it is now accessible through <code class="language-plaintext highlighter-rouge">Baker#getSpriteGetter</code>.
      </p>
      <p>FRAPI’s <code class="language-plaintext highlighter-rouge">WrapperBakedModel</code> was moved to Model Loading API and was renamed to <code class="language-plaintext highlighter-rouge">UnwrappableBakedModel</code> to avoid conflicts with vanilla’s new <code class="language-plaintext highlighter-rouge">WrapperBakedModel</code>.        <code class="language-plaintext highlighter-rouge">UnwrappableBakedModel</code> is also implemented and interface injected on vanilla’s <code class="language-plaintext highlighter-rouge">WrapperBakedModel</code>. A new static <code class="language-plaintext highlighter-rouge">UnwrappableBakedModel#unwrap</code> method was added which accepts a <code class="language-plaintext highlighter-rouge">Predicate</code> saying when to stop unwrapping. See the documentation for more details.</p>
      <h2 id="minecraft-changes">Minecraft changes</h2>
      <h3 id="block-models">Block Models</h3>
      <p>Previously, block entities could choose whether they rendered their block model in addition to any custom block entity rendering. This method has been removed, as now all block entities render their block models:</p>
      <div class="language-diff highlighter-rouge">
        <div class="highlight">
          <pre class="highlight">
            <code>
              <span class="gd">- @Override - protected BlockRenderType getRenderType(BlockState state) { - return BlockRenderType.ENTITYBLOCK_ANIMATED; - } </span>
            </code>
          </pre>
        </div>
      </div>
      <p>While block models were already used to provide particle textures in these cases, mods should still ensure their block entities’ block models are correct.</p>
      <h3 id="item-models">Item Models</h3>
      <p>Similar to the blockstate definition json files found in <code class="language-plaintext highlighter-rouge">assets/&lt;namespace&gt;/blockstates</code>, items now utilize new item model definition json files in <code class="language-plaintext highlighter-rouge">assets/&lt;namespace&gt;/items</code> to determine which models to use.</p>
      <p>These can be quite simple…</p>
      <div class="language-json highlighter-rouge">
        <div class="highlight">
          <pre class="highlight">
            <code>
              <span class="p">{</span>
              <span class="w"></span>
              <span class="nl">"model"</span>
              <span class="p">:</span>
              <span class="w"></span>
              <span class="p">{</span>
              <span class="w"></span>
              <span class="nl">"type"</span>
              <span class="p">:</span>
              <span class="w"></span>
              <span class="s2">"minecraft:model"</span>
              <span class="p">,</span>
              <span class="w"></span>
              <span class="nl">"model"</span>
              <span class="p">:</span>
              <span class="w"></span>
              <span class="s2">"modid:item/my_item"</span>
              <span class="w"></span>
              <span class="p">}</span>
              <span class="w"></span>
              <span class="p">}</span>
              <span class="w"></span>
            </code>
          </pre>
        </div>
      </div>
      <p>or more complex…</p>
      <div class="language-json highlighter-rouge">
        <div class="highlight">
          <pre class="highlight">
            <code>
              <span class="p">{</span>
              <span class="w"></span>
              <span class="nl">"model"</span>
              <span class="p">:</span>
              <span class="w"></span>
              <span class="p">{</span>
              <span class="w"></span>
              <span class="nl">"type"</span>
              <span class="p">:</span>
              <span class="w"></span>
              <span class="s2">"minecraft:condition"</span>
              <span class="p">,</span>
              <span class="w"></span>
              <span class="nl">"property"</span>
              <span class="p">:</span>
              <span class="w"></span>
              <span class="s2">"minecraft:fishing_rod/cast"</span>
              <span class="p">,</span>
              <span class="w"></span>
              <span class="nl">"on_false"</span>
              <span class="p">:</span>
              <span class="w"></span>
              <span class="p">{</span>
              <span class="w"></span>
              <span class="nl">"type"</span>
              <span class="p">:</span>
              <span class="w"></span>
              <span class="s2">"minecraft:model"</span>
              <span class="p">,</span>
              <span class="w"></span>
              <span class="nl">"model"</span>
              <span class="p">:</span>
              <span class="w"></span>
              <span class="s2">"modid:item/netherite_fishing_rod"</span>
              <span class="w"></span>
              <span class="p">},</span>
              <span class="w"></span>
              <span class="nl">"on_true"</span>
              <span class="p">:</span>
              <span class="w"></span>
              <span class="p">{</span>
              <span class="w"></span>
              <span class="nl">"type"</span>
              <span class="p">:</span>
              <span class="w"></span>
              <span class="s2">"minecraft:model"</span>
              <span class="p">,</span>
              <span class="w"></span>
              <span class="nl">"model"</span>
              <span class="p">:</span>
              <span class="w"></span>
              <span class="s2">"modid:item/netherite_fishing_rod_cast"</span>
              <span class="w"></span>
              <span class="p">}</span>
              <span class="w"></span>
              <span class="p">}</span>
              <span class="w"></span>
              <span class="p">}</span>
              <span class="w"></span>
            </code>
          </pre>
        </div>
      </div>
      <p>utilising conditions and other logic to determine which model to use.</p>
      <p>They also control applying color tints to item textures.</p>
      <div class="language-json highlighter-rouge">
        <div class="highlight">
          <pre class="highlight">
            <code>
              <span class="p">{</span>
              <span class="w"></span>
              <span class="nl">"model"</span>
              <span class="p">:</span>
              <span class="w"></span>
              <span class="p">{</span>
              <span class="w"></span>
              <span class="nl">"type"</span>
              <span class="p">:</span>
              <span class="w"></span>
              <span class="s2">"minecraft:model"</span>
              <span class="p">,</span>
              <span class="w"></span>
              <span class="nl">"model"</span>
              <span class="p">:</span>
              <span class="w"></span>
              <span class="s2">"minecraft:item/template_spawn_egg"</span>
              <span class="p">,</span>
              <span class="w"></span>
              <span class="nl">"tints"</span>
              <span class="p">:</span>
              <span class="w"></span>
              <span class="p">[</span>
              <span class="w"></span>
              <span class="p">{</span>
              <span class="w"></span>
              <span class="nl">"type"</span>
              <span class="p">:</span>
              <span class="w"></span>
              <span class="s2">"minecraft:constant"</span>
              <span class="p">,</span>
              <span class="w"></span>
              <span class="nl">"value"</span>
              <span class="p">:</span>
              <span class="w"></span>
              <span class="mi">6925483</span>
              <span class="w"></span>
              <span class="p">},</span>
              <span class="w"></span>
              <span class="p">{</span>
              <span class="w"></span>
              <span class="nl">"type"</span>
              <span class="p">:</span>
              <span class="w"></span>
              <span class="s2">"minecraft:constant"</span>
              <span class="p">,</span>
              <span class="w"></span>
              <span class="nl">"value"</span>
              <span class="p">:</span>
              <span class="w"></span>
              <span class="mi">12238402</span>
              <span class="w"></span>
              <span class="p">}</span>
              <span class="w"></span>
              <span class="p">]</span>
              <span class="w"></span>
              <span class="p">}</span>
              <span class="w"></span>
              <span class="p">}</span>
              <span class="w"></span>
            </code>
          </pre>
        </div>
      </div>
      <p>These tints can be constant or based on other factors such as potion contents, map colors, etc.</p>
      <p>As a result of these files being introduced, blocks whose item models previously simply referred to their block model no longer require a separate item model file, as the block model is referred to in the model definition file instead. For example,</p>
      <div class="language-diff highlighter-rouge">
        <div class="highlight">
          <pre class="highlight">
            <code>
              <span class="gd">- { - "parent": "modid:block/maple_planks" - } </span>
            </code>
          </pre>
        </div>
      </div>
      <p>at <code class="language-plaintext highlighter-rouge">assets/modid/models/item/maple_planks.json</code> can be removed, in favor of</p>
      <div class="language-diff highlighter-rouge">
        <div class="highlight">
          <pre class="highlight">
            <code>
              <span class="gi">+ { + "model": { + "type": "minecraft:model", + "model": "modid:block/maple_planks" + } + } </span>
            </code>
          </pre>
        </div>
      </div>
      <p>in <code class="language-plaintext highlighter-rouge">assets/modid/items/maple_planks.json</code>.
      </p>
      <p>Additionally, <code class="language-plaintext highlighter-rouge">ItemColors</code> and related APIs for tinting items have been removed, as item color tints are now controlled by these files.</p>
      <p>For further information, these jsons are well documented on <a href="https://minecraft.wiki/w/Items_model_definition">the vanilla Minecraft wiki here</a> and all the ones used by vanilla items can be easily found in the game files.</p>
      <p>For modders using data generation, these can be generated much like any other JSON asset.</p>
      <h3 id="miscellaneous">Miscellaneous</h3>
      <ul>
        <li>Resource Metadata files now use Codec serializers</li>
        <li>Equipment assets were moved from <code class="language-plaintext highlighter-rouge">assets/&lt;namespace&gt;/models/equipment</code> to <code class="language-plaintext highlighter-rouge">assets/&lt;namespace&gt;/equipment</code>
        </li>
        <li>The <code class="language-plaintext highlighter-rouge">minecraft:tall_flowers</code> block tag was removed</li>
        <li>The <code class="language-plaintext highlighter-rouge">minecraft:flowers</code>,          <code class="language-plaintext highlighter-rouge">minecraft:tall_flowers</code>, and <code class="language-plaintext highlighter-rouge">minecraft:trim_templates</code> item tags were removed</li>
        <li>The <code class="language-plaintext highlighter-rouge">minecraft:herobrine</code> entity was removed</li>
        <li>Trim Material jsons no longer specify an item model index, as trimmed items now use separate item models for each material</li>
        <li>Textures for item outlines shown in empty slots in certain GUIs are now located in <code class="language-plaintext highlighter-rouge">assets/&lt;namespace&gt;/textures/gui/sprites/container/slot</code>
        </li>
      </ul>
      <h2 id="yarn-changes">Yarn changes</h2>
      <p>There have been many changes to Yarn mappings to reflect refactors to the vanilla game, fix issues with the mappings, or to otherwise improve them.</p>
      <p>Some notable examples include:</p>
      <ul>
        <li>The <code class="language-plaintext highlighter-rouge">net/minecraft/data/client</code> package got moved to <code class="language-plaintext highlighter-rouge">net/minecraft/client/data</code>, to reflect the classes now being client-only</li>
        <li>To match this, the <code class="language-plaintext highlighter-rouge">net/minecraft/data/server</code> package was removed and its contents moved down to <code class="language-plaintext highlighter-rouge">net/minecraft/data</code>
        </li>
        <li>All references to <code class="language-plaintext highlighter-rouge">xp</code> got changed to <code class="language-plaintext highlighter-rouge">experience</code>
        </li>
        <li>
          <code class="language-plaintext highlighter-rouge">BlockStateModelGenerator.TintType</code> was changed to <code class="language-plaintext highlighter-rouge">BlockStateModelGenerator.CrossType</code>
        </li>
        <li>
          <code class="language-plaintext highlighter-rouge">CherryLeavesBlock</code> was changed to <code class="language-plaintext highlighter-rouge">ParticleLeavesBlock</code>
        </li>
        <li>
          <code class="language-plaintext highlighter-rouge">CherryLeavesParticle</code> was changed to <code class="language-plaintext highlighter-rouge">LeavesParticle</code>
        </li>
        <li>
          <code class="language-plaintext highlighter-rouge">LichenGrower</code> was changed to <code class="language-plaintext highlighter-rouge">MultifaceGrower</code>
        </li>
        <li>
          <code class="language-plaintext highlighter-rouge">EntityModelLoader</code> was changed to <code class="language-plaintext highlighter-rouge">LoadedEntityModels</code>
        </li>
        <li>
          <code class="language-plaintext highlighter-rouge">CocoaBeansTreeDecorator</code> was changed to <code class="language-plaintext highlighter-rouge">CocoaTreeDecorator</code>
        </li>
        <li>
          <code class="language-plaintext highlighter-rouge">BakedQuad#colorIndex</code> was changed to <code class="language-plaintext highlighter-rouge">tintIndex</code>
        </li>
      </ul>
    </content>
    <author>
      <name/>
    </author>
    <summary type="html">Minecraft 1.21.4, the Garden Awakens drop, releases December 3rd. Like with other updates, this drop contains some significant changes affecting mod makers.</summary>
  </entry>
  <entry>
    <title type="html">Fabric for Minecraft 1.21.2</title>
    <link href="https://fabricmc.net/2024/10/14/1212.html" rel="alternate" type="text/html" title="Fabric for Minecraft 1.21.2"/>
    <published>2024-10-14T00:00:00+00:00</published>
    <updated>2024-10-14T00:00:00+00:00</updated>
    <id>https://fabricmc.net/2024/10/14/1212</id>
    <content type="html" xml:base="https://fabricmc.net/2024/10/14/1212.html">
      <p>Minecraft 1.21.2, the “Bundles of Bravery” drop, is expected to release soon. Mojang has recently <a href="https://www.minecraft.net/en-us/article/the-future-of-minecrafts-development">announced</a> that they will release these “drops” throughout the year. Like with other updates, this drop contains some significant changes affecting mod makers.</p>
      <p>As always, <strong>we ask all players to be patient, and give mod developers time to update to this new version.</strong> We ask everyone kindly not to pester them. <strong>We also recommend all players to make a backup of their worlds.</strong>
      </p>
      <p>Here is a list of all major modder-facing changes in this version. Note that all code references are using Yarn mappings; modders using alternative mappings may need to use different names.</p>
      <h2 id="fabric-changes">Fabric changes</h2>
      <p>Developers should use Loom 1.8 (at the time of writing) to develop mods for Minecraft 1.21.2. Players should install the latest stable version of Fabric Loader (currently 0.16.7).</p>
      <h3 id="fabric-loader-changes">Fabric Loader changes</h3>
      <p>Fabric Loader 0.16.0 was released some time ago. Most notably, this release updates the bundled MixinExtras to 0.4.0.</p>
      <p>In addition, Fabric Loader 0.16.7 added support for Java 23. However, you should continue to use Java 21 for mod development and gameplay.</p>
      <h4 id="mixinextras-additions">MixinExtras additions</h4>
      <p>The following new features have been added:</p>
      <ul>
        <li>
          <a href="https://github.com/LlamaLad7/MixinExtras/wiki/WrapMethod">
            <code class="language-plaintext highlighter-rouge">@WrapMethod</code>
          </a>, which allows wrapping the entire method</li>
        <li>
          <a href="https://github.com/LlamaLad7/MixinExtras/wiki/Cancellable">
            <code class="language-plaintext highlighter-rouge">@Cancellable</code>
          </a>, which allows cancellation from all injectors.</li>
        <li>
          <code class="language-plaintext highlighter-rouge">namespace</code> parameter in <a href="https://github.com/LlamaLad7/MixinExtras/wiki/Share">
          <code class="language-plaintext highlighter-rouge">@Share</code>
        </a> to share values between Mixins</li>
    </ul>
    <h3 id="loom-18">Loom 1.8</h3>
    <p>Loom 1.8 adds support for configuration caches, Gradle 8.10, and other changes and fixes.</p>
    <p>Configuration cache is an opt-in Gradle performance enhancement feature that will be enabled by default in Gradle 9. Because this may break existing setup, we only recommend using this if you are familiar with Gradle buildscripts. To support this change, multi-project optimization has been removed.</p>
    <h3 id="new-fabric-api-changes">New Fabric API changes</h3>
    <p>With the help of many contributors, Fabric API has received some new features since the last update blog post:</p>
    <ul>
      <li>Convention Tags: Add more tags (TelepathicGrunt, Juuz)</li>
      <li>Crash Report Info: Print the full stack trace from the dedicated server watchdog (TelepathicGrunt)</li>
      <li>Entity Events: Add after damage event (TheDeathlyCow)</li>
      <li>Item API: Modify enchantment and add component map builder extensions (TheDeathlyCow)</li>
      <li>Item Group API: Add API to control creative inventory screen (modmuss50)</li>
      <li>Loot API: Loot API v3 (modmuss50)</li>
      <li>Networking: Add MinecraftClient/Server instances to networking contexts (modmuss50)</li>
      <li>Networking: Add <code class="language-plaintext highlighter-rouge">ClientConfigurationConnectionEvents#START</code> (modmuss50)</li>
      <li>Networking: Add access to ClientConfigurationNetworkHandler in context (Earthcomputer)</li>
      <li>Object Builder: Add an API to add additional supported blocks to block entity types (modmuss50)</li>
      <li>Renderer API: Add <code class="language-plaintext highlighter-rouge">ShadeMode</code> (PepperCode1)</li>
      <li>Renderer API: Quads overloads for joml interfaces (SHsuperCM)</li>
      <li>Resource Conditions: Allow conditions inside pack overlays (Apollo)</li>
      <li>Resource Loader: Add API to create reload listeners with a registry lookup (modmuss50)</li>
      <li>Removed Herobrine (Tiny Potato)</li>
      <li>Transfer API: Crafter support (modmuss50)</li>
      <li>Transfer API: Add <code class="language-plaintext highlighter-rouge">ItemVariant#withComponentChanges</code> (BasiqueEvangelist)</li>
    </ul>
    <h3 id="breaking-changes-and-deprecations">Breaking changes and deprecations</h3>
    <p>
      <em>Note: breaking changes related to vanilla changes are addressed separately below.</em>
    </p>
    <p>One deprecated module was removed: <code class="language-plaintext highlighter-rouge">fabric-renderer-registries-v1</code>.
    </p>
    <p>In Resource Condition, the <code class="language-plaintext highlighter-rouge">test</code> method now takes <code class="language-plaintext highlighter-rouge">RegistryOps.RegistryInfoGetter</code>. Tags can no longer have resource conditions. Similarly, in Resource Loader, <code class="language-plaintext highlighter-rouge">ResourceReloadListenerKeys#TAGS</code> was removed.</p>
    <p>The following deprecations were made since the last blogpost:</p>
    <ul>
      <li>Content Registries: <code class="language-plaintext highlighter-rouge">VillagerInteractionRegistries#registerCollectable</code> was deprecated. Use the vanilla tag, <code class="language-plaintext highlighter-rouge">minecraft:villager_picks_up</code>, instead.</li>
      <li>Loot API: Loot API v2 was deprecated. Use Loot API v3, which passes registry contexts, instead.</li>
      <li>Networking:<code class="language-plaintext highlighter-rouge">ClientConfigurationConnectionEvents#READY</code> was renamed to <code class="language-plaintext highlighter-rouge">COMPLETE</code>. (This was done during the 1.21 update cycle, but after we published the last blogpost.)</li>
    </ul>
    <h2 id="minecraft-changes">Minecraft changes</h2>
    <h3 id="serverworld-parameters">
      <code class="language-plaintext highlighter-rouge">ServerWorld</code> parameters</h3>
    <p>Many methods that must be executed on the server side only now require <code class="language-plaintext highlighter-rouge">ServerWorld</code> to be passed explicitly. <strong>Do not cast just to fix a type error;</strong> many events and overridden method are still called on both the client side and the server side.</p>
    <p>Instead, wrap all logic that must be run only on the server side with <code class="language-plaintext highlighter-rouge">if (world instanceof ServerWorld serverWorld)</code>. The <code class="language-plaintext highlighter-rouge">serverWorld</code> can be passed to those methods.</p>
    <p>For example, <code class="language-plaintext highlighter-rouge">Entity#damage</code> now requires <code class="language-plaintext highlighter-rouge">ServerWorld</code>, and is therefore only called on the server side. There is an additional method, <code class="language-plaintext highlighter-rouge">clientDamage</code>, which is called only on the client side.</p>
    <h3 id="block-and-item-settings">Block and item settings</h3>
    <p>Minecraft 1.21.2 uses registry keys to pre-compute certain block or item settings. This allows referencing them in default item components. For example, rather than computing a default name based on an item’s registry key inside <code class="language-plaintext highlighter-rouge">getName</code> method if the <code class="language-plaintext highlighter-rouge">minecraft:item_name</code> component is not present, every item now contains the <code class="language-plaintext highlighter-rouge">minecraft:item_name</code> component.</p>
    <p>Because of this, you must <strong>manually set registry keys in the settings of every block and item</strong>. Failure to do so will result in crashes such as:</p>
    <ul>
      <li>
        <code class="language-plaintext highlighter-rouge">NullPointerException: Block id not set</code>
      </li>
      <li>
        <code class="language-plaintext highlighter-rouge">NullPointerException: Item id not set</code>
      </li>
    </ul>
    <p>Both settings classes provide a simple method which should be called for every item or block with their respective registry key:</p>
    <div class="language-java highlighter-rouge">
      <div class="highlight">
        <pre class="highlight">
          <code>
            <span class="nc">Identifier</span>
            <span class="n">id</span>
            <span class="o">=</span>
            <span class="nc">Identifier</span>
            <span class="o">.</span>
            <span class="na">of</span>
            <span class="o">(</span>
            <span class="s">"mymod"</span>
            <span class="o">,</span>
            <span class="s">"test_item"</span>
            <span class="o">);</span>
            <span class="nc">RegistryKey</span>
            <span class="o">&lt;</span>
            <span class="nc">Item</span>
            <span class="o">&gt;</span>
            <span class="n">key</span>
            <span class="o">=</span>
            <span class="nc">RegistryKey</span>
            <span class="o">.</span>
            <span class="na">of</span>
            <span class="o">(</span>
            <span class="nc">RegistryKeys</span>
            <span class="o">.</span>
            <span class="na">ITEM</span>
            <span class="o">,</span>
            <span class="n">id</span>
            <span class="o">);</span>
            <span class="nc">Item</span>
            <span class="o">.</span>
            <span class="na">Settings</span>
            <span class="n">settings</span>
            <span class="o">=</span>
            <span class="k">new</span>
            <span class="nc">Item</span>
            <span class="o">.</span>
            <span class="na">Settings</span>
            <span class="o">()</span>
            <span class="c1">// If your item is based on a block</span>
            <span class="o">.</span>
            <span class="na">useBlockPrefixedTranslationKey</span>
            <span class="o">()</span>
            <span class="o">.</span>
            <span class="na">registryKey</span>
            <span class="o">(</span>
            <span class="n">key</span>
            <span class="o">);</span>
            <span class="nc">Registry</span>
            <span class="o">.</span>
            <span class="na">register</span>
            <span class="o">(</span>
            <span class="nc">Registries</span>
            <span class="o">.</span>
            <span class="na">ITEM</span>
            <span class="o">,</span>
            <span class="n">key</span>
            <span class="o">,</span>
            <span class="k">new</span>
            <span class="nc">Item</span>
            <span class="o">(</span>
            <span class="n">settings</span>
            <span class="o">));</span>
          </code>
        </pre>
      </div>
    </div>
    <div class="language-java highlighter-rouge">
      <div class="highlight">
        <pre class="highlight">
          <code>
            <span class="nc">Identifier</span>
            <span class="n">id</span>
            <span class="o">=</span>
            <span class="nc">Identifier</span>
            <span class="o">.</span>
            <span class="na">of</span>
            <span class="o">(</span>
            <span class="s">"mymod"</span>
            <span class="o">,</span>
            <span class="s">"test_block"</span>
            <span class="o">);</span>
            <span class="nc">RegistryKey</span>
            <span class="o">&lt;</span>
            <span class="nc">Block</span>
            <span class="o">&gt;</span>
            <span class="n">key</span>
            <span class="o">=</span>
            <span class="nc">RegistryKey</span>
            <span class="o">.</span>
            <span class="na">of</span>
            <span class="o">(</span>
            <span class="nc">RegistryKeys</span>
            <span class="o">.</span>
            <span class="na">BLOCK</span>
            <span class="o">,</span>
            <span class="n">id</span>
            <span class="o">);</span>
            <span class="nc">Block</span>
            <span class="o">.</span>
            <span class="na">Settings</span>
            <span class="n">settings</span>
            <span class="o">=</span>
            <span class="k">new</span>
            <span class="nc">Block</span>
            <span class="o">.</span>
            <span class="na">Settings</span>
            <span class="o">()</span>
            <span class="o">.</span>
            <span class="na">registryKey</span>
            <span class="o">(</span>
            <span class="n">key</span>
            <span class="o">);</span>
            <span class="nc">Registry</span>
            <span class="o">.</span>
            <span class="na">register</span>
            <span class="o">(</span>
            <span class="nc">Registries</span>
            <span class="o">.</span>
            <span class="na">BLOCK</span>
            <span class="o">,</span>
            <span class="n">key</span>
            <span class="o">,</span>
            <span class="k">new</span>
            <span class="nc">Block</span>
            <span class="o">(</span>
            <span class="n">settings</span>
            <span class="o">));</span>
          </code>
        </pre>
      </div>
    </div>
    <p>Make sure to call the <code class="language-plaintext highlighter-rouge">Item.Settings#useBlockPrefixedTranslationKey</code> method for block items so that they use the <code class="language-plaintext highlighter-rouge">block.&lt;namespace&gt;.&lt;path&gt;</code> translation key format.</p>
    <p>This change affects the following traits:</p>
    <ul>
      <li>Item names (<code class="language-plaintext highlighter-rouge">minecraft:item_name</code> component)</li>
      <li>Item models (<code class="language-plaintext highlighter-rouge">minecraft:item_model</code> component)</li>
      <li>Block models</li>
      <li>Block loot table key</li>
    </ul>
    <p>Some traits, such as the cooldown group of items with cooldowns, still dynamically look up a registry key, but this pattern should be avoided as much as possible.</p>
    <p>
      <code class="language-plaintext highlighter-rouge">Block#getLootTableKey</code> now returns <code class="language-plaintext highlighter-rouge">Optional&lt;RegistryKey&gt;</code>. A block without a corresponding loot table now returns an empty optional instead of the <code class="language-plaintext highlighter-rouge">minecraft:empty</code> loot table registry key.</p>
    <p>In Fabric API, the previously-deprecated <code class="language-plaintext highlighter-rouge">FabricBlockSettings</code> class was removed. Use the vanilla <code class="language-plaintext highlighter-rouge">AbstractBlock.Settings</code> class instead.</p>
    <h3 id="furnace-fuels">Furnace fuels</h3>
    <p>Furnace fuels are now registered through an event, which allows access to new parameters:</p>
    <div class="language-diff highlighter-rouge">
      <div class="highlight">
        <pre class="highlight">
          <code>
            <span class="gd">- FuelRegistry.INSTANCE.add(ModItems.TEST_ITEM, 50); </span>
            <span class="gi">+ FuelRegistryEvents.BUILD.register((builder, context) -&gt; { + builder.add(ModItems.TEST_ITEM, context.baseSmeltTime() / 4); + }); </span>
          </code>
        </pre>
      </div>
    </div>
    <p>The base smelt time can be used to express a fuel’s smelt time in terms of a ratio. The default base smelt time is 200 ticks, or 10 seconds.</p>
    <h3 id="entities">Entities</h3>
    <p>
      <code class="language-plaintext highlighter-rouge">EntityType</code> received a registry key change similar to the block and item one described above. When building an <code class="language-plaintext highlighter-rouge">EntityType</code>, pass a <code class="language-plaintext highlighter-rouge">RegistryKey</code> for the entity type. The no-argument version of the <code class="language-plaintext highlighter-rouge">EntityType.Builder#build</code> method, injected by <code class="language-plaintext highlighter-rouge">FabricEntityTypeBuilder</code>, has been removed. For example:</p>
    <div class="language-java highlighter-rouge">
      <div class="highlight">
        <pre class="highlight">
          <code>
            <span class="nc">Identifier</span>
            <span class="n">id</span>
            <span class="o">=</span>
            <span class="nc">Identifier</span>
            <span class="o">.</span>
            <span class="na">of</span>
            <span class="o">(</span>
            <span class="s">"mymod"</span>
            <span class="o">,</span>
            <span class="s">"test_entity_type"</span>
            <span class="o">);</span>
            <span class="nc">RegistryKey</span>
            <span class="o">&lt;</span>
            <span class="nc">EntityType</span>
            <span class="o">&lt;?&gt;&gt;</span>
            <span class="n">key</span>
            <span class="o">=</span>
            <span class="nc">RegistryKey</span>
            <span class="o">.</span>
            <span class="na">of</span>
            <span class="o">(</span>
            <span class="nc">RegistryKeys</span>
            <span class="o">.</span>
            <span class="na">ENTITY_TYPE</span>
            <span class="o">,</span>
            <span class="n">id</span>
            <span class="o">);</span>
            <span class="nc">EntityType</span>
            <span class="o">&lt;</span>
            <span class="nc">TestEntity</span>
            <span class="o">&gt;</span>
            <span class="n">entityType</span>
            <span class="o">=</span>
            <span class="nc">EntityType</span>
            <span class="o">.</span>
            <span class="na">Builder</span>
            <span class="o">.&lt;</span>
            <span class="nc">TestEntity</span>
            <span class="o">&gt;</span>
            <span class="n">create</span>
            <span class="o">(</span>
            <span class="nl">TestEntity:</span>
            <span class="o">:</span>
            <span class="k">new</span>
            <span class="o">,</span>
            <span class="nc">SpawnGroup</span>
            <span class="o">.</span>
            <span class="na">MISC</span>
            <span class="o">)</span>
            <span class="o">.</span>
            <span class="na">build</span>
            <span class="o">(</span>
            <span class="n">key</span>
            <span class="o">);</span>
            <span class="nc">Registry</span>
            <span class="o">.</span>
            <span class="na">register</span>
            <span class="o">(</span>
            <span class="nc">Registries</span>
            <span class="o">.</span>
            <span class="na">ENTITY_TYPE</span>
            <span class="o">,</span>
            <span class="n">key</span>
            <span class="o">,</span>
            <span class="n">entityType</span>
            <span class="o">);</span>
          </code>
        </pre>
      </div>
    </div>
    <p>Mob conversion (such as zombie villager curing or slimes splitting on death) was overhauled. The exact behavior of conversion is now handled by methods implemented by values of the <code class="language-plaintext highlighter-rouge">EntityConversionType</code> enum. When using the <code class="language-plaintext highlighter-rouge">MobEntity#convertTo</code> method to convert a mob, an <code class="language-plaintext highlighter-rouge">EntityConversionContext</code> is now required. This context is also now passed to Fabric API’s <code class="language-plaintext highlighter-rouge">ServerLivingEntityEvents#MOB_CONVERSION</code> event.</p>
    <p>When creating an entity, a spawn reason is now required:</p>
    <div class="language-diff highlighter-rouge">
      <div class="highlight">
        <pre class="highlight">
          <code>
            <span class="gd">- Entity pig = EntityType.PIG.create(overworld); </span>
            <span class="gi">+ Entity pig = EntityType.PIG.create(overworld, SpawnReason.SPAWN_ITEM_USE); </span>
          </code>
        </pre>
      </div>
    </div>
    <p>The prefixes of attributes in <code class="language-plaintext highlighter-rouge">EntityAttributes</code>, like <code class="language-plaintext highlighter-rouge">GENERIC</code>, have been dropped. This matches a change in the identifiers of attributes:</p>
    <div class="language-diff highlighter-rouge">
      <div class="highlight">
        <pre class="highlight">
          <code>
            <span class="gd">- public static final RegistryEntry&lt;EntityAttribute&gt; GENERIC_ATTACK_KNOCKBACK = register( - "generic.attack_knockback", - new ClampedEntityAttribute("attribute.name.generic.attack_knockback", 0, 0, 5) </span>
            <span class="err">);</span> + public static final RegistryEntry&lt;EntityAttribute&gt; ATTACK_KNOCKBACK = register( "attack_knockback", new ClampedEntityAttribute("attribute.name.attack_knockback", 0, 0, 5) <span class="err">);</span>
          </code>
        </pre>
      </div>
    </div>
    <h3 id="data-generation">Data generation</h3>
    <p>A recipe provider must now override <code class="language-plaintext highlighter-rouge">getRecipeGenerator</code> instead of <code class="language-plaintext highlighter-rouge">generate</code>. The new method takes the registries and <code class="language-plaintext highlighter-rouge">exporter</code>, and returns a new instance of <code class="language-plaintext highlighter-rouge">RecipeGenerator</code> that actually generates the recipes.</p>
    <div class="language-diff highlighter-rouge">
      <div class="highlight">
        <pre class="highlight">
          <code>
            <span class="gd">- public void generate(RecipeExporter exporter) { - offerPlanksRecipe2(exporter, SIMPLE_BLOCK, ItemTags.ACACIA_LOGS, 1); </span>
            <span class="gi">+ protected RecipeGenerator getRecipeGenerator(RegistryWrapper.WrapperLookup registries, RecipeExporter exporter) { + return new RecipeGenerator(registries, exporter) { + @Override + public void generate() { + offerPlanksRecipe2(SIMPLE_BLOCK, ItemTags.ACACIA_LOGS, 1); </span>
          </code>
        </pre>
      </div>
    </div>
    <h3 id="actionresult">ActionResult</h3>
    <p>Previously, action results have been represented in several ways, including the <code class="language-plaintext highlighter-rouge">ActionResult</code>,      <code class="language-plaintext highlighter-rouge">ItemActionResult</code>, and <code class="language-plaintext highlighter-rouge">TypedActionResult</code> classes. In Minecraft 1.21.2, these classes have been merged into a single <code class="language-plaintext highlighter-rouge">ActionResult</code> class, which provides direct replacements for the previous methods for all three classes:</p>
    <table>
      <thead>
        <tr>
          <th>Old</th>
          <th>New</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>
            <code class="language-plaintext highlighter-rouge">ActionResult.success(world.isClient())</code>
          </td>
          <td>
            <code class="language-plaintext highlighter-rouge">ActionResult.SUCCESS</code>
          </td>
        </tr>
        <tr>
          <td>
            <code class="language-plaintext highlighter-rouge">TypedActionResult.pass(stack)</code>
          </td>
          <td>
            <code class="language-plaintext highlighter-rouge">ActionResult.PASS</code>
          </td>
        </tr>
        <tr>
          <td>
            <code class="language-plaintext highlighter-rouge">TypedActionResult.fail(stack)</code>
          </td>
          <td>
            <code class="language-plaintext highlighter-rouge">ActionResult.FAIL</code>
          </td>
        </tr>
        <tr>
          <td>
            <code class="language-plaintext highlighter-rouge">TypedActionResult.success(stack, world.isClient())</code>
          </td>
          <td>
            <code class="language-plaintext highlighter-rouge">ActionResult.SUCCESS</code>
          </td>
        </tr>
        <tr>
          <td>
            <code class="language-plaintext highlighter-rouge">TypedActionResult.consume(stack)</code>
          </td>
          <td>
            <code class="language-plaintext highlighter-rouge">ActionResult.CONSUME</code>
          </td>
        </tr>
      </tbody>
    </table>
    <p>If an action replaces the hand stack with another instance of <code class="language-plaintext highlighter-rouge">ItemStack</code>, then it should be marked with the <code class="language-plaintext highlighter-rouge">ActionResult#withNewHandStack</code> method. For example, an <code class="language-plaintext highlighter-rouge">Item#use</code> implementation that replaces the hand stack might be:</p>
    <div class="language-java highlighter-rouge">
      <div class="highlight">
        <pre class="highlight">
          <code>
            <span class="kd">public</span>
            <span class="nc">ActionResult</span>
            <span class="nf">use</span>
            <span class="o">(</span>
            <span class="nc">World</span>
            <span class="n">world</span>
            <span class="o">,</span>
            <span class="nc">PlayerEntity</span>
            <span class="n">user</span>
            <span class="o">,</span>
            <span class="nc">Hand</span>
            <span class="n">hand</span>
            <span class="o">)</span>
            <span class="o">{</span>
            <span class="nc">ItemStack</span>
            <span class="n">stack</span>
            <span class="o">=</span>
            <span class="n">user</span>
            <span class="o">.</span>
            <span class="na">getStackInHand</span>
            <span class="o">(</span>
            <span class="n">hand</span>
            <span class="o">);</span>
            <span class="k">if</span>
            <span class="o">(</span>
            <span class="n">stack</span>
            <span class="o">.</span>
            <span class="na">getCount</span>
            <span class="o">()</span>
            <span class="o">&gt;</span>
            <span class="mi">16</span>
            <span class="o">)</span>
            <span class="o">{</span>
            <span class="nc">ItemStack</span>
            <span class="n">newStack</span>
            <span class="o">=</span>
            <span class="k">new</span>
            <span class="nc">ItemStack</span>
            <span class="o">(</span>
            <span class="nc">Items</span>
            <span class="o">.</span>
            <span class="na">BLAZE_ROD</span>
            <span class="o">,</span>
            <span class="mi">16</span>
            <span class="o">);</span>
            <span class="k">return</span>
            <span class="nc">ActionResult</span>
            <span class="o">.</span>
            <span class="na">SUCCESS</span>
            <span class="o">.</span>
            <span class="na">withNewHandStack</span>
            <span class="o">(</span>
            <span class="n">newStack</span>
            <span class="o">);</span>
            <span class="o">}</span>
            <span class="k">return</span>
            <span class="nc">ActionResult</span>
            <span class="o">.</span>
            <span class="na">PASS</span>
            <span class="o">;</span>
            <span class="o">}</span>
          </code>
        </pre>
      </div>
    </div>
    <p>On the other hand, if the <code class="language-plaintext highlighter-rouge">ItemStack</code> instance for the hand stack is the same as the one provided to an interaction method such as <code class="language-plaintext highlighter-rouge">Item#use</code>, the <code class="language-plaintext highlighter-rouge">ActionResult#withNewHandStack</code> method should not be called.</p>
    <p>This change affects all places where <code class="language-plaintext highlighter-rouge">TypedActionResult</code> and <code class="language-plaintext highlighter-rouge">ItemActionResult</code> were previously used in Minecraft’s code. In Fabric API, the <code class="language-plaintext highlighter-rouge">UseItemCallback</code> event in the Events Interaction module now returns <code class="language-plaintext highlighter-rouge">ActionResult</code> instead of <code class="language-plaintext highlighter-rouge">TypedActionResult&lt;ItemStack&gt;</code>.
    </p>
    <h3 id="item-components">Item components</h3>
    <p>Because elytra behavior is now controlled by a new item component, <code class="language-plaintext highlighter-rouge">minecraft:glider</code>,      <code class="language-plaintext highlighter-rouge">FabricElytraItem</code> was removed. Add the component to your elytra item instead.</p>
    <h3 id="block-entities">Block entities</h3>
    <p>In Minecraft 1.21.1 (released in August), a change was made that required mods to add all supported blocks to block entities. For example, a mod with a new sign block must add the block to <code class="language-plaintext highlighter-rouge">BlockEntityType#SIGN</code>:
    </p>
    <div class="language-java highlighter-rouge">
      <div class="highlight">
        <pre class="highlight">
          <code>
            <span class="nc">BlockEntityType</span>
            <span class="o">.</span>
            <span class="na">SIGN</span>
            <span class="o">.</span>
            <span class="na">addSupportedBlock</span>
            <span class="o">(</span>
            <span class="nc">ModBlocks</span>
            <span class="o">.</span>
            <span class="na">TEAL_SIGN</span>
            <span class="o">);</span>
          </code>
        </pre>
      </div>
    </div>
    <p>In Minecraft 1.21.2, block entity types are no longer constructed using builders. Therefore, <code class="language-plaintext highlighter-rouge">FabricBlockEntityType.Builder</code> was removed, while <code class="language-plaintext highlighter-rouge">FabricBlockEntityTypeBuilder</code> is no longer deprecated.</p>
    <h3 id="registries">Registries</h3>
    <p>
      <code class="language-plaintext highlighter-rouge">Registry</code> now implements <code class="language-plaintext highlighter-rouge">RegistryEntryLookup</code>. This resulted in several name changes. To query a <code class="language-plaintext highlighter-rouge">RegistryEntry</code> from <code class="language-plaintext highlighter-rouge">RegistryKey</code>, use <code class="language-plaintext highlighter-rouge">getOptional</code> or <code class="language-plaintext highlighter-rouge">getOrThrow</code>. (Same applies to <code class="language-plaintext highlighter-rouge">RegistryEntryList</code> from <code class="language-plaintext highlighter-rouge">TagKey</code>.) If you want to query the registry value, use <code class="language-plaintext highlighter-rouge">getValueOrThrow</code>. See the table below for all changes.</p>
    <table>
      <thead>
        <tr>
          <th>Old</th>
          <th>New</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>
            <code class="language-plaintext highlighter-rouge">getEntry</code>
          </td>
          <td>
            <code class="language-plaintext highlighter-rouge">getOptional</code>
          </td>
        </tr>
        <tr>
          <td>
            <code class="language-plaintext highlighter-rouge">entryOf</code>
          </td>
          <td>
            <code class="language-plaintext highlighter-rouge">getOrThrow</code>
          </td>
        </tr>
        <tr>
          <td>
            <code class="language-plaintext highlighter-rouge">getOrThrow</code>
          </td>
          <td>
            <code class="language-plaintext highlighter-rouge">getValueOrThrow</code>
          </td>
        </tr>
        <tr>
          <td>
            <code class="language-plaintext highlighter-rouge">getOrEmpty</code>
          </td>
          <td>
            <code class="language-plaintext highlighter-rouge">getOptionalValue</code>
          </td>
        </tr>
        <tr>
          <td>
            <code class="language-plaintext highlighter-rouge">getEntryList</code>
          </td>
          <td>
            <code class="language-plaintext highlighter-rouge">getOptional</code>
          </td>
        </tr>
      </tbody>
    </table>
    <p>Similarly, <code class="language-plaintext highlighter-rouge">DynamicRegistryManager#get</code> and <code class="language-plaintext highlighter-rouge">RegistryWrapper.WrapperLookup#getWrapperOrThrow</code> has been renamed to <code class="language-plaintext highlighter-rouge">getOrThrow</code>.      <code class="language-plaintext highlighter-rouge">getOptionalWrapper</code> was renamed tp <code class="language-plaintext highlighter-rouge">getOptional</code>.
    </p>
    <h3 id="rendering">Rendering</h3>
    <h4 id="entity-rendering">Entity rendering</h4>
    <p>Entity rendering has received a large refactor that decouples the <code class="language-plaintext highlighter-rouge">Entity</code> instance from its respective rendering calls. <code class="language-plaintext highlighter-rouge">EntityRenderer</code> now has an additional type parameter, <code class="language-plaintext highlighter-rouge">S extends EntityRenderState</code>, which represents a ‘render state’, which is a mutable class containing only the parameters of the entity that are used in rendering.</p>
    <p>Previously, renderer methods accessed the entity instance directly. However, accessing entity information now happens in three steps.</p>
    <p>First, the <code class="language-plaintext highlighter-rouge">EntityRenderer#createRenderState</code> method is called to construct an instance of <code class="language-plaintext highlighter-rouge">S</code> for the given entity with placeholder values:</p>
    <div class="language-java highlighter-rouge">
      <div class="highlight">
        <pre class="highlight">
          <code>
            <span class="kd">public</span>
            <span class="no">T</span>
            <span class="nf">createRenderState</span>
            <span class="o">()</span>
            <span class="o">{</span>
            <span class="k">return</span>
            <span class="k">new</span>
            <span class="nf">T</span>
            <span class="o">();</span>
            <span class="o">}</span>
          </code>
        </pre>
      </div>
    </div>
    <p>Next, the <code class="language-plaintext highlighter-rouge">EntityRenderer#updateRenderState</code> method performs the operation of copying information from the entity to its render state:</p>
    <div class="language-java highlighter-rouge">
      <div class="highlight">
        <pre class="highlight">
          <code>
            <span class="kd">public</span>
            <span class="kt">void</span>
            <span class="nf">updateRenderState</span>
            <span class="o">(</span>
            <span class="no">T</span>
            <span class="n">entity</span>
            <span class="o">,</span>
            <span class="no">S</span>
            <span class="n">state</span>
            <span class="o">,</span>
            <span class="kt">float</span>
            <span class="n">tickDelta</span>
            <span class="o">)</span>
            <span class="o">{</span>
            <span class="kd">super</span>
            <span class="o">.</span>
            <span class="na">updateRenderState</span>
            <span class="o">(</span>
            <span class="n">entity</span>
            <span class="o">,</span>
            <span class="n">state</span>
            <span class="o">,</span>
            <span class="n">tickDelta</span>
            <span class="o">);</span>
            <span class="c1">// Example: entity has an 'is saddled' field</span>
            <span class="n">state</span>
            <span class="o">.</span>
            <span class="na">isSaddled</span>
            <span class="o">=</span>
            <span class="n">entity</span>
            <span class="o">.</span>
            <span class="na">isSaddled</span>
            <span class="o">();</span>
            <span class="o">}</span>
          </code>
        </pre>
      </div>
    </div>
    <p>Finally, the <code class="language-plaintext highlighter-rouge">EntityRenderer#render</code> method (as well as other renderer methods) accesses information from the entity’s render state:</p>
    <div class="language-java highlighter-rouge">
      <div class="highlight">
        <pre class="highlight">
          <code>
            <span class="kd">public</span>
            <span class="kt">void</span>
            <span class="nf">render</span>
            <span class="o">(</span>
            <span class="no">S</span>
            <span class="n">state</span>
            <span class="o">,</span>
            <span class="nc">MatrixStack</span>
            <span class="n">matrices</span>
            <span class="o">,</span>
            <span class="nc">VertexConsumerProvider</span>
            <span class="n">vertexConsumers</span>
            <span class="o">,</span>
            <span class="kt">int</span>
            <span class="n">light</span>
            <span class="o">)</span>
            <span class="o">{</span>
            <span class="kd">super</span>
            <span class="o">.</span>
            <span class="na">render</span>
            <span class="o">(</span>
            <span class="n">state</span>
            <span class="o">,</span>
            <span class="n">matrices</span>
            <span class="o">,</span>
            <span class="n">vertexConsumers</span>
            <span class="o">,</span>
            <span class="n">light</span>
            <span class="o">);</span>
            <span class="k">if</span>
            <span class="o">(</span>
            <span class="n">state</span>
            <span class="o">.</span>
            <span class="na">isSaddled</span>
            <span class="o">)</span>
            <span class="o">{</span>
            <span class="c1">// Render the saddle</span>
            <span class="o">}</span>
            <span class="o">}</span>
          </code>
        </pre>
      </div>
    </div>
    <h4 id="shaders">Shaders</h4>
    <p>In Fabric Rendering API, <code class="language-plaintext highlighter-rouge">CoreShaderRegistrationCallback</code> was removed. Vanilla resource pack now allows loading modded core shaders.</p>
    <h4 id="other-changes">Other changes</h4>
    <p>
      <code class="language-plaintext highlighter-rouge">WorldRenderer</code> methods for rendering certain vertices (like a box) were transferred to <code class="language-plaintext highlighter-rouge">VertexRendering</code>.
    </p>    <!-- TODO Shader changes. Models. -->
    <h3 id="recipes">Recipes</h3>
    <p>The recipe system was reworked. To summarize:</p>
    <ul>
      <li>Recipes are now identified using <code class="language-plaintext highlighter-rouge">RegistryKey&lt;? extends Recipe&gt;</code>, not <code class="language-plaintext highlighter-rouge">Identifier</code>.
      </li>
      <li>
        <code class="language-plaintext highlighter-rouge">Recipe</code> and the recipe ID is now server-side only. It cannot be accessed from the client.</li>
      <li>Instead, clients receive <code class="language-plaintext highlighter-rouge">RecipeDisplayEntry</code>. It contains all information needed to display and run the recipe book. Recipes are identified using an integer (<code class="language-plaintext highlighter-rouge">NetworkRecipeId</code>) on the client. A recipe can have multiple display entries.</li>
      <li>
        <code class="language-plaintext highlighter-rouge">IngredientPlacement</code> controls the placement of ingredients on the crafting table, while <code class="language-plaintext highlighter-rouge">RecipeMatcher</code> handles recipe matching.</li>
    </ul>
    <p>
      <code class="language-plaintext highlighter-rouge">Ingredient</code> is now internally a list of items, not item stacks.</p>
    <p>In Fabric API, <code class="language-plaintext highlighter-rouge">CustomIngredientSerializer#getCodec</code>:      <code class="language-plaintext highlighter-rouge">allowEmpty</code> param removed, empty now always disallowed.</p>
    <h3 id="biome">Biome</h3>
    <p>Water cave carvers (which, before 1.18, were seen in seabeds) were removed, along with <code class="language-plaintext highlighter-rouge">GenerationStep.Carver</code>.
    </p>
    <p>In Fabric Biome API, biome modification methods like <code class="language-plaintext highlighter-rouge">addCarver</code> and <code class="language-plaintext highlighter-rouge">removeCarver</code> no longer takes <code class="language-plaintext highlighter-rouge">GenerationStep.Carver</code> argument.</p>
    <h3 id="profiler">Profiler</h3>
    <p>The shared profiler is now accessed using <code class="language-plaintext highlighter-rouge">Profilers#get</code>.
    </p>
    <div class="language-diff highlighter-rouge">
      <div class="highlight">
        <pre class="highlight">
          <code>
            <span class="gd">- world.getProfiler().push("tinyPotato"); </span>
            <span class="gi">+ Profilers.get().push("tinyPotato"); </span>
          </code>
        </pre>
      </div>
    </div>
    <h3 id="loot-tables">Loot tables</h3>
    <p>
      <code class="language-plaintext highlighter-rouge">LootTables#EMPTY</code> was removed. The game uses <code class="language-plaintext highlighter-rouge">Optional</code> to mark the lack of loot tables.</p>
    <p>Some loot context-related logics are now shared with recipes, resulting in name changes. <code class="language-plaintext highlighter-rouge">LootContextParameter</code> is now <code class="language-plaintext highlighter-rouge">ContextParameter</code>, and <code class="language-plaintext highlighter-rouge">LootContextType</code> is now <code class="language-plaintext highlighter-rouge">ContextType</code>.
    </p>
    <h3 id="yarn-renames">Yarn renames</h3>
    <p>
      <em>This section only affects those using the Yarn mapping.</em>
    </p>
    <p>As part of regular Yarn maintainace, the following changes were made. These should be a simple replacement:</p>
    <ul>
      <li>
        <code class="language-plaintext highlighter-rouge">ModelTransformationMode</code> is transferred to <code class="language-plaintext highlighter-rouge">net.minecraft.item</code>.
      </li>
      <li>
        <code class="language-plaintext highlighter-rouge">RealmsLoadingWidget</code> is renamed to <code class="language-plaintext highlighter-rouge">LoadingWidget</code> and transferred to <code class="language-plaintext highlighter-rouge">client.gui.widget</code>.
      </li>
      <li>Several <code class="language-plaintext highlighter-rouge">Brain</code> and <code class="language-plaintext highlighter-rouge">Task</code>-related names: see <a href="https://github.com/FabricMC/yarn/pull/3992">the pull request</a> for details.</li>
      <li>
        <code class="language-plaintext highlighter-rouge">registryLookupFuture</code> is renamed to <code class="language-plaintext highlighter-rouge">registriesFuture</code> in several locations.</li>
      <li>
        <code class="language-plaintext highlighter-rouge">Codecs#NONNEGATIVE_INT</code> is renamed to <code class="language-plaintext highlighter-rouge">NON_NEGATIVE_INT</code>.
      </li>
      <li>
        <code class="language-plaintext highlighter-rouge">QUATERNIONF</code> and <code class="language-plaintext highlighter-rouge">VECTOR3F</code> are renamed to <code class="language-plaintext highlighter-rouge">QUATERNION_F</code> and <code class="language-plaintext highlighter-rouge">VECTOR_3F</code>.
      </li>
      <li>
        <code class="language-plaintext highlighter-rouge">Screen#initTabNavigation</code> is renamed to <code class="language-plaintext highlighter-rouge">refreshWidgetPositions</code>.
      </li>
      <li>
        <code class="language-plaintext highlighter-rouge">ComponentMapImpl</code> is renamed to <code class="language-plaintext highlighter-rouge">MergedComponentMap</code>.
      </li>
      <li>
        <code class="language-plaintext highlighter-rouge">ContainerComponentModifier#create</code> is renamed to <code class="language-plaintext highlighter-rouge">apply</code>.
      </li>
      <li>
        <code class="language-plaintext highlighter-rouge">ItemStack#encode</code> is renamed to <code class="language-plaintext highlighter-rouge">toNbt</code>.
      </li>
    </ul>
  </content>
  <author>
    <name/>
  </author>
  <summary type="html">Minecraft 1.21.2, the “Bundles of Bravery” drop, is expected to release soon. Mojang has recently announced that they will release these “drops” throughout the year. Like with other updates, this drop contains some significant changes affecting mod makers.</summary>
</entry>
<entry>
  <title type="html">Fabric for Minecraft 1.21</title>
  <link href="https://fabricmc.net/2024/05/31/121.html" rel="alternate" type="text/html" title="Fabric for Minecraft 1.21"/>
  <published>2024-05-31T00:00:00+00:00</published>
  <updated>2024-05-31T00:00:00+00:00</updated>
  <id>https://fabricmc.net/2024/05/31/121</id>
  <content type="html" xml:base="https://fabricmc.net/2024/05/31/121.html">
    <p>Minecraft 1.21 is expected to be released on June 13, with some significant changes affecting mod makers.</p>
    <p>It’s been only a month and a half since we last released a blogpost. Yet, this update is nothing small - some changes are likely to affect most, if not all, mods.</p>
    <p>As always, <strong>we ask all players to be patient, and give mod developers time to update to this new version.</strong> We ask everyone kindly not to pester them. <strong>We also recommend all players to make a backup of their worlds.</strong>
    </p>
    <p>Here is a list of all major modder-facing changes in this version. Note that all code references are using Yarn mappings; modders using alternative mappings may need to use different names.</p>
    <h2 id="fabric-changes">Fabric changes</h2>
    <p>Developers should use Loom 1.6 (at the time of writing) to develop mods for Minecraft 1.21. Players should install the latest stable version of Fabric Loader (currently 0.15.11).</p>
    <h3 id="new-fabric-api-changes">New Fabric API changes</h3>
    <p>With the help of many contributors, Fabric API has received some new features since the last update blog post:</p>
    <ul>
      <li>Conventional Tags: Default English Translations for <code class="language-plaintext highlighter-rouge">c</code> namespaced tags (TelepathicGrunt)</li>
      <li>Data Generation: Support extending dynamic registries in datagen (SquidDev)</li>
      <li>Item API: Add API to modify default item components (modmuss50)</li>
      <li>Resource Conditions: Support loading a single resource condition instead of array (Apollo)</li>
      <li>Resource Conditions: Registry resource conditions (SquidDev)</li>
      <li>Removed Herobrine (Tiny Potato)</li>
    </ul>
    <h4 id="tag-translation">Tag translation</h4>
    <p>Mods are now strongly encouraged to provide an English translation for item tags it provides. For example, the translation for <code class="language-plaintext highlighter-rouge">test:potatoes</code> should be declared like this:</p>
    <div class="language-json highlighter-rouge">
      <div class="highlight">
        <pre class="highlight">
          <code>
            <span class="p">{</span>
            <span class="w"></span>
            <span class="nl">"tag.item.test.potatoes"</span>
            <span class="p">:</span>
            <span class="w"></span>
            <span class="s2">"Potatoes"</span>
            <span class="w"></span>
            <span class="p">}</span>
            <span class="w"></span>
          </code>
        </pre>
      </div>
    </div>
    <p>Although these are not used by the API itself, other mods (such as recipe viewers) rely on them for proper display.</p>
    <h3 id="breaking-changes">Breaking Changes</h3>
    <p>
      <em>Note: breaking changes related to vanilla changes are addressed separately below.</em>
    </p>
    <p>One deprecated module was removed: <code class="language-plaintext highlighter-rouge">fabric-models-v0</code>.
    </p>
    <p>In Item API, <code class="language-plaintext highlighter-rouge">EquipmentSlotProvider#getPreferredEquipmentSlot</code> is now passed a <code class="language-plaintext highlighter-rouge">LivingEntity</code>. Implementations are expected to check themselves whether the slot is available, using <code class="language-plaintext highlighter-rouge">entity.canUseSlot(EquipmentSlot)</code>.      <code class="language-plaintext highlighter-rouge">FabricItem#getAttributeModifiers</code> was removed; use Default Components API instead.</p>
    <p>Registry Sync now freezes the registry at an earlier point. This does not affect mods that register things in their <code class="language-plaintext highlighter-rouge">ModInitializer</code>s, but might affect more complex mods. Make sure to register everything during <code class="language-plaintext highlighter-rouge">ModInitializer</code>.
    </p>
    <h2 id="minecraft-changes">Minecraft changes</h2>
    <p>This version brought many breaking changes, including data-driven Enchantments. Data pack structures also changed, using singular nouns (instead of plurals) in many places.</p>
    <h3 id="identifier">Identifier</h3>
    <p>
      <code class="language-plaintext highlighter-rouge">Identifier</code> constructor is now <code class="language-plaintext highlighter-rouge">protected</code>. Use the static method <code class="language-plaintext highlighter-rouge">of</code> or <code class="language-plaintext highlighter-rouge">ofVanilla</code> to construct <code class="language-plaintext highlighter-rouge">Identifier</code>. Replacing <code class="language-plaintext highlighter-rouge">new Identifier</code> with <code class="language-plaintext highlighter-rouge">Identifier.of</code> using text editors or IDEs should be sufficient.</p>
    <div class="language-diff highlighter-rouge">
      <div class="highlight">
        <pre class="highlight">
          <code>
            <span class="gd">- var id = new Identifier("example", "foo_bar"); - var id2 = new Identifier("test:single_argument"); - var creeper = new Identifier("minecraft", "creeper"); - @Nullable var customId = Identifier.of("namespace", unsanitizedInput); </span>
            <span class="gi">+ var id = Identifier.of("example", "foo_bar"); + var id2 = Identifier.of("test:single_argument"); + var creeper = Identifier.ofVanilla("creeper"); // very slightly improved performance + @Nullable var customId = Identifier.tryParse("namespace", unsanitizedInput); </span>
          </code>
        </pre>
      </div>
    </div>
    <p>Pro tip: make a method to construct <code class="language-plaintext highlighter-rouge">Identifier</code> for your mod’s namespace; this can be imported later using <code class="language-plaintext highlighter-rouge">import static</code> to shorten your code.</p>
    <div class="language-java highlighter-rouge">
      <div class="highlight">
        <pre class="highlight">
          <code>
            <span class="kd">public</span>
            <span class="kd">static</span>
            <span class="nc">Identifier</span>
            <span class="nf">id</span>
            <span class="o">(</span>
            <span class="nc">String</span>
            <span class="n">path</span>
            <span class="o">)</span>
            <span class="o">{</span>
            <span class="k">return</span>
            <span class="nc">Identifier</span>
            <span class="o">.</span>
            <span class="na">of</span>
            <span class="o">(</span>
            <span class="s">"mod_namespace"</span>
            <span class="o">,</span>
            <span class="n">path</span>
            <span class="o">);</span>
            <span class="o">}</span>
          </code>
        </pre>
      </div>
    </div>
    <h3 id="enchantments">Enchantments</h3>
    <p>Enchantments are now data-driven. This means that they are no longer hardcoded - instead, they’re part of data packs. Consequentially, there are several important changes in how mods handle enchantments.</p>
    <ul>
      <li>Generally, enchantments either “do something” (like causing an explosion), or “modify a value” (like attack damage). Example: Instead of checking if the player has Thorns and applying damage to the attacker, a mod should now call <code class="language-plaintext highlighter-rouge">EnchantmentHelper#onTargetDamaged</code> which should automatically handle this. Example 2: Instead of checking the level of Knockback, a mod should now call <code class="language-plaintext highlighter-rouge">EnchantmentHelper#modifyKnockback</code> with the original knockback.</li>
      <li>Sometimes, a code needs to check if an item has certain enchantments. Because enchantments are no longer hard-coded, this is done using enchantment tags. Example 3: Breaking a beehive with Silk Touch prevents bees from getting released. Previously, this was done by checking for the Silk Touch enchantment. Now, this is done by calling <code class="language-plaintext highlighter-rouge">EnchantmentHelper#hasAnyEnchantmentsIn(stack, EnchantmentTags#PREVENTS_BEE_SPAWNS_WHEN_MINING)</code>.
      </li>
    </ul>
    <h3 id="enchantment-code-structures">Enchantment Code Structures</h3>
    <p>An <code class="language-plaintext highlighter-rouge">Enchantment</code> is, well, an enchantment. Because it is now defined by a dynamic registry, it is often handled as <code class="language-plaintext highlighter-rouge">RegistryEntry&lt;Enchantment&gt;</code>. These can be obtained from the dynamic registry, i.e. <code class="language-plaintext highlighter-rouge">world.getRegistryManager()</code> or the <code class="language-plaintext highlighter-rouge">registryLookup</code> passed to various methods.</p>
    <p>An enchantment has effect components, which is a map of effect types to list of effects. Effect types are pre-defined keys that enchantments can define behaviors for. For example, an enchantment may want to add “multiply by 2” behavior for <code class="language-plaintext highlighter-rouge">DAMAGE</code> effect type, or “explode” behavior for <code class="language-plaintext highlighter-rouge">POST_ATTACK</code> effect type. These are defined in <code class="language-plaintext highlighter-rouge">EnchantmentEffectComponentTypes</code>.
    </p>
    <p>The values of effect components are <code class="language-plaintext highlighter-rouge">EnchantmentEffectEntry</code>. This is a pair of the effect and an optional condition. <code class="language-plaintext highlighter-rouge">LootCondition</code> is reused for this purpose.</p>
    <p>Enchantment effects can be categorized into three categories:</p>
    <ul>
      <li>
        <code class="language-plaintext highlighter-rouge">EnchantmentValueEffect</code>. When given a value, the effect calculates the modified value. Examples include Protection (which modifies <code class="language-plaintext highlighter-rouge">DAMAGE_PROTECTION</code>), Lure (<code class="language-plaintext highlighter-rouge">FISHING_LUCK_BONUS</code>), Unbreaking (<code class="language-plaintext highlighter-rouge">ITEM_DAMAGE</code>), and Multishot (<code class="language-plaintext highlighter-rouge">PROJECTILE_COUNT</code>).
      </li>
      <li>
        <code class="language-plaintext highlighter-rouge">EnchantmentEntityEffect</code>. This effect does something when triggered. Examples include Thorns and Channeling (<code class="language-plaintext highlighter-rouge">POST_ATTACK</code>) and Flame (<code class="language-plaintext highlighter-rouge">PROJECTILE_SPAWNED</code>).
      </li>
      <li>
        <code class="language-plaintext highlighter-rouge">AttributeEnchantmentEffect</code>, which adds an attribute to the entity. Unlike entity effects, attributes persist until the enchantment becomes inapplicable.</li>
    </ul>
    <p>
      <code class="language-plaintext highlighter-rouge">EnchantmentLocationBasedEffect</code> is an interface implemented by <code class="language-plaintext highlighter-rouge">EnchantmentEntityEffect</code> and <code class="language-plaintext highlighter-rouge">AttributeEnchantmentEffect</code>. In addition, some enchantment effect types simply require effective values to be specified directly - like <code class="language-plaintext highlighter-rouge">CROSSBOW_CHARGING_SOUNDS</code>, which is a list of sounds. Some effects, like <code class="language-plaintext highlighter-rouge">PREVENT_ARMOR_CHANGE</code>, cannot be configured further.</p>
    <h3 id="using-vanilla-enchantments">Using Vanilla Enchantments</h3>
    <p>
      <code class="language-plaintext highlighter-rouge">EnchantmentHelper</code> methods can be used to handle vanilla enchantments.</p>
    <div class="language-java highlighter-rouge">
      <div class="highlight">
        <pre class="highlight">
          <code>
            <span class="c1">// Example of modifying a value</span>
            <span class="kt">float</span>
            <span class="n">newDamage</span>
            <span class="o">=</span>
            <span class="nc">EnchantmentHelper</span>
            <span class="o">.</span>
            <span class="na">getDamage</span>
            <span class="o">(</span>
            <span class="n">world</span>
            <span class="o">,</span>
            <span class="n">stack</span>
            <span class="o">,</span>
            <span class="n">attackTarget</span>
            <span class="o">,</span>
            <span class="n">damageSource</span>
            <span class="o">,</span>
            <span class="n">baseDamage</span>
            <span class="o">);</span>
            <span class="c1">// For values with no base value (such as Protection)</span>
            <span class="kt">float</span>
            <span class="n">protection</span>
            <span class="o">=</span>
            <span class="nc">EnchantmentHelper</span>
            <span class="o">.</span>
            <span class="na">getProtectionAmount</span>
            <span class="o">(</span>
            <span class="n">world</span>
            <span class="o">,</span>
            <span class="n">user</span>
            <span class="o">,</span>
            <span class="n">damageSource</span>
            <span class="o">);</span>
            <span class="c1">// Entity-based effect</span>
            <span class="nc">EnchantmentHelper</span>
            <span class="o">.</span>
            <span class="na">onTargetDamaged</span>
            <span class="o">(</span>
            <span class="n">world</span>
            <span class="o">,</span>
            <span class="n">attackTarget</span>
            <span class="o">,</span>
            <span class="n">damageSource</span>
            <span class="o">,</span>
            <span class="n">weapon</span>
            <span class="o">);</span>
            <span class="c1">// Checking if an ItemStack is enchanted with certain enchantments</span>
            <span class="k">if</span>
            <span class="o">(</span>
            <span class="nc">EnchantmentHelper</span>
            <span class="o">.</span>
            <span class="na">hasAnyEnchantmentsIn</span>
            <span class="o">(</span>
            <span class="n">stack</span>
            <span class="o">,</span>
            <span class="nc">EnchantmentTags</span>
            <span class="o">.</span>
            <span class="na">PREVENTS_BEE_SPAWNS_WHEN_MINING</span>
            <span class="o">))</span>
            <span class="o">{</span>
            <span class="k">return</span>
            <span class="o">;</span>
            <span class="o">}</span>
            <span class="c1">// Checking for nonconfigurable effects</span>
            <span class="c1">// e.g. checking for Curse of Binding</span>
            <span class="k">if</span>
            <span class="o">(</span>
            <span class="nc">EnchantmentHelper</span>
            <span class="o">.</span>
            <span class="na">hasAnyEnchantmentsWith</span>
            <span class="o">(</span>
            <span class="n">stack</span>
            <span class="o">,</span>
            <span class="nc">EnchantmentEffectComponentTypes</span>
            <span class="o">.</span>
            <span class="na">PREVENT_ARMOR_CHANGE</span>
            <span class="o">))</span>
            <span class="o">{</span>
            <span class="k">return</span>
            <span class="o">;</span>
            <span class="o">}</span>
          </code>
        </pre>
      </div>
    </div>
    <h3 id="adding-a-new-enchantment">Adding a new Enchantment</h3>
    <p>Adding a new enchantment is now done by writing JSON files. You can use Data Generation to generate enchantments easily.</p>
    <p>An enchantment can perform many tasks, like applying attributes, replacing blocks or summoning an entity. However, not all things are possible. To add a custom <strong>effect type</strong>, a new effect class must be created and its codec registered. <strong>An effect type must exist in both the client and the server.</strong>
    </p>
    <p>Enchantment tags are used to specify exclusive enchantments (e.g. Fortune and Silk Touch) and where the enchantments can be obtained. Make sure to add your enchantments to those tags.</p>
    <h3 id="enchantment-related-fabric-api-changes">Enchantment-related Fabric API changes</h3>
    <p>The following event callbacks now pass <code class="language-plaintext highlighter-rouge">RegistryEntry&lt;Enchantment&gt;</code> instead of <code class="language-plaintext highlighter-rouge">Enchantment</code>:
    </p>
    <ul>
      <li>
        <code class="language-plaintext highlighter-rouge">EnchantmentEvents.AllowEnchanting#allowEnchanting</code>
      </li>
      <li>
        <code class="language-plaintext highlighter-rouge">FabricItem#canBeEnchantedWith</code>
      </li>
      <li>
        <code class="language-plaintext highlighter-rouge">FabricItemStack#canBeEnchantedWith</code>
      </li>
    </ul>
    <p>
      <code class="language-plaintext highlighter-rouge">EnchantmentContext</code> was reworked. Previously, a context was one of <code class="language-plaintext highlighter-rouge">RANDOM_ENCHANTMENT</code>,      <code class="language-plaintext highlighter-rouge">ANVIL</code>,      <code class="language-plaintext highlighter-rouge">ENCHANT_COMMAND</code>, or <code class="language-plaintext highlighter-rouge">LOOT_RANDOM_ENCHANTMENT</code>. To clarify its purpose, they are now one of <code class="language-plaintext highlighter-rouge">ACCEPTABLE</code> (e.g. anvils) or <code class="language-plaintext highlighter-rouge">PRIMARY</code> (e.g. enchanting tables). For example, a helmet can be enchanted with Thorns using anvils but not in enchanting tables, because only chestplates are <code class="language-plaintext highlighter-rouge">PRIMARY</code> in case of Thorns.</p>
    <h3 id="teleportation">Teleportation</h3>
    <p>Both intra-dimensional and cross-dimensional teleportation can now be performed using <code class="language-plaintext highlighter-rouge">Entity#teleportTo</code> (previously known as <code class="language-plaintext highlighter-rouge">moveToWorld</code>).      <code class="language-plaintext highlighter-rouge">TeleportTarget</code> now contains the destination world and position.</p>
    <p>
      <code class="language-plaintext highlighter-rouge">FabricDimensions</code> was removed, because its only API, <code class="language-plaintext highlighter-rouge">teleport</code>, is effectively superseded with <code class="language-plaintext highlighter-rouge">Entity#teleportTo</code>.
    </p>
    <h3 id="data-pack-paths">Data Pack Paths</h3>
    <p>Data packs now use singular nouns in the following paths:</p>
    <ul>
      <li>Tag subdirectories such as <code class="language-plaintext highlighter-rouge">tags/blocks</code>,        <code class="language-plaintext highlighter-rouge">tags/entity_types</code>,        <code class="language-plaintext highlighter-rouge">tags/functions</code>. They are now <code class="language-plaintext highlighter-rouge">tags/block</code>,        <code class="language-plaintext highlighter-rouge">tags/entity_type</code>, and <code class="language-plaintext highlighter-rouge">tags/function</code>, respectively. <strong>The <code class="language-plaintext highlighter-rouge">tags</code> directory itself remains plural.</strong>
    </li>
    <li>Advancements (previously <code class="language-plaintext highlighter-rouge">advancements</code>, now <code class="language-plaintext highlighter-rouge">advancement</code>).
    </li>
    <li>Functions (<code class="language-plaintext highlighter-rouge">functions</code> to <code class="language-plaintext highlighter-rouge">function</code>).
    </li>
    <li>Item modifiers/loot functions (<code class="language-plaintext highlighter-rouge">item_modifiers</code> to <code class="language-plaintext highlighter-rouge">item_modifier</code>).
    </li>
    <li>Loot tables (<code class="language-plaintext highlighter-rouge">loot_tables</code> to <code class="language-plaintext highlighter-rouge">loot_table</code>).
    </li>
    <li>Predicates/loot conditions (<code class="language-plaintext highlighter-rouge">predicates</code> to <code class="language-plaintext highlighter-rouge">predicate</code>).
    </li>
    <li>Recipes (<code class="language-plaintext highlighter-rouge">recipes</code> to <code class="language-plaintext highlighter-rouge">recipe</code>).
    </li>
    <li>Structures (<code class="language-plaintext highlighter-rouge">structures</code> to <code class="language-plaintext highlighter-rouge">structure</code>).
    </li>
  </ul>
  <p>In Fabric API news, GameTest structure directories are now singular as well; instead of <code class="language-plaintext highlighter-rouge">gametest/structures</code>, they are now placed in <code class="language-plaintext highlighter-rouge">gametest/structure</code>.
  </p>
  <h3 id="rendering-changes">Rendering Changes</h3>
  <p>In the Fabric Rendering API, <code class="language-plaintext highlighter-rouge">HudRenderCallback</code> now passes <code class="language-plaintext highlighter-rouge">RenderTickCounter</code> instead of <code class="language-plaintext highlighter-rouge">tickDelta</code>.    <code class="language-plaintext highlighter-rouge">tickDelta</code> can be obtained from the counter. <code class="language-plaintext highlighter-rouge">WorldRenderContext</code>’s <code class="language-plaintext highlighter-rouge">tickDelta</code> and <code class="language-plaintext highlighter-rouge">limitTime</code> methods are also replaced with <code class="language-plaintext highlighter-rouge">tickCounter</code>.
  </p>
  <p>There are some other, significant internal refactors to rendering. For example, <code class="language-plaintext highlighter-rouge">BufferBuilder#next()</code> was removed, and the methods for beginning or ending the building process has changed:</p>
  <div class="language-diff highlighter-rouge">
    <div class="highlight">
      <pre class="highlight">
        <code>
          <span class="gd">- BufferBuilder builder = tessellator.getBuffer(); - builder.begin(...); </span>
          <span class="gi">+ BufferBuilder builder = tessellator.begin(...); </span>
          <span class="gd">- builder.vertex(...).texture(...).color(...).next(); </span>
          <span class="gi">+ builder.vertex(...).texture(...).color(...) </span>
          <span class="gd">- tessellator.draw(); </span>
          <span class="gi">+ BufferRenderer.drawWithGlobalProgram(builder.end()); </span>
        </code>
      </pre>
    </div>
  </div>
  <h3 id="miscellaneous">Miscellaneous</h3>
  <ul>
    <li>
      <code class="language-plaintext highlighter-rouge">FabricCodecProvider</code> now has a new constructor that takes <code class="language-plaintext highlighter-rouge">RegistryKey</code> instead of directory name. This can be used with, for example, item modifier providers. The old constructor can still be used for non-registered codecs.</li>
  </ul>
</content>
<author>
  <name/>
</author>
<summary type="html">Minecraft 1.21 is expected to be released on June 13, with some significant changes affecting mod makers.</summary>
</entry>
<entry>
<title type="html">Fabric for Minecraft 1.20.5 &amp; 1.20.6</title>
<link href="https://fabricmc.net/2024/04/19/1205.html" rel="alternate" type="text/html" title="Fabric for Minecraft 1.20.5 &amp; 1.20.6"/>
<published>2024-04-19T00:00:00+00:00</published>
<updated>2024-04-19T00:00:00+00:00</updated>
<id>https://fabricmc.net/2024/04/19/1205</id>
<content type="html" xml:base="https://fabricmc.net/2024/04/19/1205.html">
  <p>Minecraft 1.20.5 is to be released in the near future with significant changes affecting mod makers.</p>
  <p>But first, we need to make this clear: <strong>1.20.5 is a record-breaking update.</strong> This development cycle spans from December 18, 2023 to April of 2024, the longest for any “dot release”. We saw 15 snapshots, the first time it became two digits for a dot release (previous record was 1.20.3 for 8 snapshots). And no surprise: the amount of changes is also unprecedented.</p>
  <p>For this reason, <strong>we ask all players to be patient, and give mod developers time to update to this new version.</strong> We ask everyone kindly not to pester them. 1.20.5 is expected to be the last update of the 1.20 series.</p>
  <p>
    <strong>We recommend all players to make a backup of the world.</strong> For content mod users, creating a new world is recommended, as most mods do not handle world data upgrades of this magnitude.</p>
  <p>Here is a list of all major modder-facing changes in this version. Note that all code references are using Yarn mappings; modders using alternative mappings may need to use different names.</p>
  <h2 id="java-21">Java 21</h2>
  <p>Minecraft 1.20.5 now requires Java 21 to run. This means mods can be compiled for Java 21 and use the latest features. This also marks the end of 32-bit support.</p>
  <p>To set up a development environment you will need to use Java 21, Loom 1.6, and Gradle 8.6 or higher.</p>
  <h2 id="fabric-changes">Fabric changes</h2>
  <p>Developers should use Loom 1.6 (at the time of writing) to develop mods for Minecraft 1.20.5. Players should install the latest stable version of Fabric Loader (currently 0.15.10).</p>
  <h3 id="loom-15--16">Loom 1.5 &amp; 1.6</h3>
  <p>There has been two major updates to Loom since the last blogpost: 1.5 and 1.6.</p>
  <p>Loom 1.5 includes several performance boosts and small bug fixes. Notably, the mixins can now be remapped using the Tiny Remapper instead of Mixin annotation processor. When enabled, the mixins are remapped in-place and the output jar no longer contains a refmap. This is currently experimental and opt-in.</p>
  <p>Loom 1.6 also brought more performance improvements. Decompiler caches were added, meaning that changes to access wideners no longer cause the entire game to be decompiled. There is also an update to how Loom handles existing locks (such as when two Gradle runs occur simultaneously) - it will no longer clear the cache, instead waiting for one process to exit. The error message for locked files is now more detailed, as well.</p>
  <p>Please see the <a href="https://github.com/FabricMC/fabric-loom/releases/tag/1.5">Loom 1.5</a> and <a href="https://github.com/FabricMC/fabric-loom/releases/tag/1.6">Loom 1.6</a> release notes for all of the changes.</p>
  <h3 id="localization">Localization</h3>
  <p>Fabric has recently moved to using Crowdin to help manage translations for our projects. This makes it much easier to contribute translations across all Fabric projects.</p>
  <p>Current projects include Fabric API and installer.     <!-- Docs are WIP --> If you are able to help translate Fabric into your language, please visit    <a href="https://crowdin.com/project/fabricmc">the Crowdin website</a>.
  </p>
  <h3 id="new-fabric-api-changes">New Fabric API changes</h3>
  <p>With the help of many contributors, Fabric API has received some new features since the last update blog post:</p>
  <ul>
    <li>New API: Data Attachments. This allows attaching custom data to block entities, chunks, entites, and worlds. Attached data can be saved or persisted between mob conversions. (Syst3ms)</li>
    <li>Interaction Events: add client after block break event (kevinthegreat1)</li>
    <li>GameTest API: add a system property for a custom output directory for gametest structures (ErrorCraft)</li>
    <li>Entity Events: add mob conversion event (Syst3ms)</li>
    <li>Fabric Rendering: add <code class="language-plaintext highlighter-rouge">AtlasSourceTypeRegistry</code> (PepperCode1)</li>
    <li>Data Generation: add <code class="language-plaintext highlighter-rouge">FabricCodecDataProvider</code> (ErrorCraft)</li>
    <li>Resource Loader: significant refactors to support <code class="language-plaintext highlighter-rouge">pack.mcmeta</code> metadata like filters and overlays. (apple502j)</li>
    <li>Fabric Rendering: add support for custom <code class="language-plaintext highlighter-rouge">ColorResolver</code>s (PepperCode1)</li>
    <li>Fluids Rendering: expose a function for querying the non-default fluid renderer (jellysquid3)</li>
    <li>Lifecycle Events: add save events to <code class="language-plaintext highlighter-rouge">ServerLifecycleEvents</code> (MrNavaStar)</li>
    <li>Item API: add enchantments API (Syst3ms)</li>
  </ul>
  <p>There is one more addition for advanced developers: you can now declare Fabric API as a dependency using BOM or version catalogs. Check <a href="https://github.com/FabricMC/fabric/pull/3487">the pull request</a> for more details.</p>
  <h3 id="breaking-changes-and-deprecations">Breaking changes and deprecations</h3>
  <p>
    <em>Note: breaking changes related to vanilla changes are discussed below.</em>
  </p>
  <p>The following APIs were removed:</p>
  <ul>
    <li>
      <code class="language-plaintext highlighter-rouge">fabric-containers-v0</code> (previously deprecated)</li>
    <li>
      <code class="language-plaintext highlighter-rouge">fabric-events-lifecycle-v0</code> (previously deprecated)</li>
    <li>
      <code class="language-plaintext highlighter-rouge">fabric-mining-level-api-v1</code>
    </li>
    <li>
      <code class="language-plaintext highlighter-rouge">ScreenRegistry</code> and <code class="language-plaintext highlighter-rouge">ScreenHandlerRegistry</code>
    </li>
  </ul>
  <p>
    <code class="language-plaintext highlighter-rouge">ModifyItemAttributeModifiersCallback</code> from the Item API was removed without replacement due to code changes making it infeasible to port.</p>
  <p>In Object Builder API, <code class="language-plaintext highlighter-rouge">FabricItemSettings</code> was removed. Use vanilla <code class="language-plaintext highlighter-rouge">Item.Settings</code> instead; interface injection provides settings added by Fabric API. Similarly, <code class="language-plaintext highlighter-rouge">FabricBlockSettings</code> was deprecated and replaced with vanilla <code class="language-plaintext highlighter-rouge">AbstractBlock.Settings</code>.    <code class="language-plaintext highlighter-rouge">FabricEntityTypeBuilder</code> and <code class="language-plaintext highlighter-rouge">FabricBlockEntityTypeBuilder</code> were also deprecated; use vanilla builders instead.</p>
  <h3 id="codec-based-resource-conditions">Codec-based Resource Conditions</h3>
  <p>Unrelated to the 1.20.5 update, a significant change was made to Resource Conditions’ internal workings. This update was developed by Apollo and apple502j. The only breaking change to the JSON syntax is the removal of <code class="language-plaintext highlighter-rouge">(block/item/fluid)_tags_populated</code> conditions, but data generation is heavily affected.</p>
  <p>The <code class="language-plaintext highlighter-rouge">ConditionJsonProvider</code> interface has been removed and been replaced by <code class="language-plaintext highlighter-rouge">ResourceCondition</code>.    <code class="language-plaintext highlighter-rouge">ResourceCondition</code> has a <code class="language-plaintext highlighter-rouge">test</code> method, for determining whether the condition should pass, and <code class="language-plaintext highlighter-rouge">getType</code>, which returns a <code class="language-plaintext highlighter-rouge">ResourceConditionType</code>.    <code class="language-plaintext highlighter-rouge">withConditions</code> methods in data providers now take <code class="language-plaintext highlighter-rouge">ResourceCondition</code> instances. Methods in <code class="language-plaintext highlighter-rouge">DefaultResourceConditions</code> that created conditions have been moved to <code class="language-plaintext highlighter-rouge">ResourceConditions</code>. A custom <code class="language-plaintext highlighter-rouge">ResourceConditionType</code> should be registered with <code class="language-plaintext highlighter-rouge">ResourceConditions#register</code>.
  </p>
  <p>In addition, <code class="language-plaintext highlighter-rouge">fabric:true</code> condition was added. This condition always passes.</p>
  <h3 id="convention-tag-unification">Convention Tag unification</h3>
  <p>Another significant change was made in the Convention Tags. As part of collaborative efforts with NeoForge, TelepathicGrunt has prepared (and we released) the version 2 of the tags. Version 1 is now deprecated.</p>
  <p>As the changes are too long to list here, developers are encouraged to check the <a href="https://github.com/FabricMC/fabric/pull/3310">pull request</a>.
  </p>
  <h2 id="minecraft-changes">Minecraft changes</h2>
  <p>In short, these are the veeery major changes:</p>
  <ul>
    <li>Item Components. Item stacks no longer use NBT as runtime data storage, instead using predefined “components” to keep values like custom name, enchantments, or damage.</li>
    <li>Networking. Instead of manually processing <code class="language-plaintext highlighter-rouge">PacketByteBuf</code>, packets are now serialized using <code class="language-plaintext highlighter-rouge">PacketCodec</code>s. In Fabric Networking API, the previous <code class="language-plaintext highlighter-rouge">PacketByteBuf</code>-based APIs were removed; the newer, <code class="language-plaintext highlighter-rouge">FabricPacket</code>-based API was rewritten to make use of the vanilla <code class="language-plaintext highlighter-rouge">CustomPayload</code> interface.</li>
    <li>Registries. Likely as a preparation for data-driven blocks and items, serialization/deserialization of most objects now require <code class="language-plaintext highlighter-rouge">RegistryWrapper.WrapperLookup</code> instance. This is most noticeable in texts and data generation. In addition, loot tables are now managed by a new type of registry called “reloadable registries”.</li>
  </ul>
  <h3 id="item-components">Item Components</h3>
  <p>We skip the general description of the item components system, which you can check in the slicedlime’s video: <a href="https://www.youtube.com/watch?v=iY9OHAd4Aco">News in Data Pack Version 33 (24w09a): Item Components!</a>.
  </p>
  <p>Now, we begin the journey into the implementation of item components:</p>
  <p>There are five main objects in the item components:</p>
  <ul>
    <li>
      <code class="language-plaintext highlighter-rouge">DataComponentType</code>, a type of components, serving as keys;</li>
    <li>Component classes (can be any object), serving as values;</li>
    <li>
      <code class="language-plaintext highlighter-rouge">ComponentMap</code>, a read-only view of components;</li>
    <li>
      <code class="language-plaintext highlighter-rouge">ComponentMapImpl</code>, which is a <code class="language-plaintext highlighter-rouge">ComponentMap</code> that can be modified, and internally a pair of unmodifiable base <code class="language-plaintext highlighter-rouge">ComponentMap</code> and the “overrides” that are modified; and</li>
    <li>
      <code class="language-plaintext highlighter-rouge">ComponentChanges</code>, a map of component type to the changes for the value (either setting it to a specific value or removing it). This can be used as a diff applied to <code class="language-plaintext highlighter-rouge">ItemStack</code>; you apply an instance of <code class="language-plaintext highlighter-rouge">ComponentChanges</code> to <code class="language-plaintext highlighter-rouge">ItemStack</code>/      <code class="language-plaintext highlighter-rouge">ComponentMapImpl</code>, so that the overrides part of the map reflects the changes. In other parts of the code, <code class="language-plaintext highlighter-rouge">ComponentChanges</code> is just used as <code class="language-plaintext highlighter-rouge">ComponentMapImpl</code> minus the base.</li>
  </ul>
  <p>So, how does this work?</p>
  <p>Each item has the base components. In addition to the base components common to all items, like having empty <code class="language-plaintext highlighter-rouge">EnchantmentsComponent</code>, some items provide additional base components. A notable example is <code class="language-plaintext highlighter-rouge">DataComponentTypes#DAMAGE</code> for armors, tools, and weapons. A component type that exists in the base has a corresponding default value; here the default damage is <code class="language-plaintext highlighter-rouge">0</code>.
  </p>
  <p>An <code class="language-plaintext highlighter-rouge">ItemStack</code> can either 1) add an additional component not present in the base; 2) change the components from the one in the base; or 3) remove a component that exists in the base. The final components of <code class="language-plaintext highlighter-rouge">ItemStack</code>, obtainable as <code class="language-plaintext highlighter-rouge">ComponentMap</code> from <code class="language-plaintext highlighter-rouge">ItemStack#getComponents</code>, reflects all three.</p>
  <h4 id="using-item-components">Using Item Components</h4>
  <p>Item components on item stacks have a similar API surface to a map. Here are some common operations that can be done, using the example of an item’s custom name (note that <code class="language-plaintext highlighter-rouge">Text</code> is directly used as the component value):</p>
  <div class="language-java highlighter-rouge">
    <div class="highlight">
      <pre class="highlight">
        <code>
          <span class="c1">// Similar to Map#get</span>
          <span class="nd">@Nullable</span>
          <span class="nc">Text</span>
          <span class="n">name</span>
          <span class="o">=</span>
          <span class="n">stack</span>
          <span class="o">.</span>
          <span class="na">get</span>
          <span class="o">(</span>
          <span class="nc">DataComponentTypes</span>
          <span class="o">.</span>
          <span class="na">CUSTOM_NAME</span>
          <span class="o">);</span>
          <span class="c1">// Similar to Map#put</span>
          <span class="c1">// Returns the previous value, if any</span>
          <span class="nd">@Nullable</span>
          <span class="nc">Text</span>
          <span class="n">oldName</span>
          <span class="o">=</span>
          <span class="n">stack</span>
          <span class="o">.</span>
          <span class="na">set</span>
          <span class="o">(</span>
          <span class="nc">DataComponentTypes</span>
          <span class="o">.</span>
          <span class="na">CUSTOM_NAME</span>
          <span class="o">,</span>
          <span class="nc">Text</span>
          <span class="o">.</span>
          <span class="na">literal</span>
          <span class="o">(</span>
          <span class="s">"Lorem ipsum"</span>
          <span class="o">));</span>
          <span class="c1">// Similar to Map#getOrDefault</span>
          <span class="n">name</span>
          <span class="o">=</span>
          <span class="n">stack</span>
          <span class="o">.</span>
          <span class="na">getOrDefault</span>
          <span class="o">(</span>
          <span class="nc">DataComponentTypes</span>
          <span class="o">.</span>
          <span class="na">CUSTOM_NAME</span>
          <span class="o">,</span>
          <span class="nc">Text</span>
          <span class="o">.</span>
          <span class="na">empty</span>
          <span class="o">());</span>
          <span class="c1">// Similar to Map#remove</span>
          <span class="nd">@Nullable</span>
          <span class="nc">Text</span>
          <span class="n">removedName</span>
          <span class="o">=</span>
          <span class="n">stack</span>
          <span class="o">.</span>
          <span class="na">remove</span>
          <span class="o">(</span>
          <span class="nc">DataComponentTypes</span>
          <span class="o">.</span>
          <span class="na">CUSTOM_NAME</span>
          <span class="o">);</span>
          <span class="c1">// Similar to Map#compute</span>
          <span class="c1">// In this example, we change the color of the item name</span>
          <span class="c1">// (Note: stack#getName already checks for custom name, so in reality this does not need apply() call.)</span>
          <span class="n">stack</span>
          <span class="o">.</span>
          <span class="na">apply</span>
          <span class="o">(</span>
          <span class="nc">DataComponentTypes</span>
          <span class="o">.</span>
          <span class="na">CUSTOM_NAME</span>
          <span class="o">,</span>
          <span class="n">stack</span>
          <span class="o">.</span>
          <span class="na">getName</span>
          <span class="o">(),</span>
          <span class="n">current</span>
          <span class="o">-&gt;</span>
          <span class="n">current</span>
          <span class="o">.</span>
          <span class="na">copy</span>
          <span class="o">().</span>
          <span class="na">formatted</span>
          <span class="o">(</span>
          <span class="nc">Formatting</span>
          <span class="o">.</span>
          <span class="na">RED</span>
          <span class="o">))</span>
        </code>
      </pre>
    </div>
  </div>
  <p>Getting/setting the custom data (NBT). This is useful for datapack makers and server-side modders, because custom item components (see below) need to be synced to the clients, while custom data remains an unparsed NBT.</p>
  <p>Unlike the previous example, this uses a component record <code class="language-plaintext highlighter-rouge">NbtComponent</code>.
  </p>
  <p>Note: <strong>component values are supposed to be immutable</strong> - even if you can modify it, don’t. Always copy and <code class="language-plaintext highlighter-rouge">set()</code>.
  </p>
  <div class="language-java highlighter-rouge">
    <div class="highlight">
      <pre class="highlight">
        <code>
          <span class="nc">NbtCompound</span>
          <span class="n">nbt</span>
          <span class="o">=</span>
          <span class="o">...;</span>
          <span class="nc">NbtComponent</span>
          <span class="n">component</span>
          <span class="o">=</span>
          <span class="nc">NbtComponent</span>
          <span class="o">.</span>
          <span class="na">of</span>
          <span class="o">(</span>
          <span class="n">nbt</span>
          <span class="o">);</span>
          <span class="c1">// Setting</span>
          <span class="n">stack</span>
          <span class="o">.</span>
          <span class="na">set</span>
          <span class="o">(</span>
          <span class="nc">DataComponentTypes</span>
          <span class="o">.</span>
          <span class="na">CUSTOM_DATA</span>
          <span class="o">,</span>
          <span class="n">component</span>
          <span class="o">);</span>
          <span class="c1">// Getting a copy</span>
          <span class="nd">@Nullable</span>
          <span class="kt">var</span>
          <span class="n">data</span>
          <span class="o">=</span>
          <span class="n">stack</span>
          <span class="o">.</span>
          <span class="na">get</span>
          <span class="o">(</span>
          <span class="nc">DataComponentTypes</span>
          <span class="o">.</span>
          <span class="na">CUSTOM_DATA</span>
          <span class="o">);</span>
          <span class="k">if</span>
          <span class="o">(</span>
          <span class="n">data</span>
          <span class="o">!=</span>
          <span class="kc">null</span>
          <span class="o">)</span>
          <span class="o">{</span>
          <span class="nc">NbtCompound</span>
          <span class="n">value</span>
          <span class="o">=</span>
          <span class="n">data</span>
          <span class="o">.</span>
          <span class="na">copyNbt</span>
          <span class="o">();</span>
          <span class="o">}</span>
          <span class="c1">// Using NbtComponent#apply, which copies automatically, to modify the NBT</span>
          <span class="c1">// Note: you might want to use the static method NbtComponent#set instead,</span>
          <span class="c1">// which makes this a bit shorter</span>
          <span class="n">stack</span>
          <span class="o">.</span>
          <span class="na">apply</span>
          <span class="o">(</span>
          <span class="nc">DataComponentTypes</span>
          <span class="o">.</span>
          <span class="na">CUSTOM_DATA</span>
          <span class="o">,</span>
          <span class="nc">NbtComponent</span>
          <span class="o">.</span>
          <span class="na">DEFAULT</span>
          <span class="o">,</span>
          <span class="n">comp</span>
          <span class="o">-&gt;</span>
          <span class="n">comp</span>
          <span class="o">.</span>
          <span class="na">apply</span>
          <span class="o">(</span>
          <span class="n">currentNbt</span>
          <span class="o">-&gt;</span>
          <span class="o">{</span>
          <span class="n">currentNbt</span>
          <span class="o">.</span>
          <span class="na">putInt</span>
          <span class="o">(</span>
          <span class="s">"key"</span>
          <span class="o">,</span>
          <span class="mi">0</span>
          <span class="o">);</span>
          <span class="o">}));</span>
          <span class="c1">// Checking if a certain NBT is a subset of the stack NBT</span>
          <span class="c1">// (also known as: "non-strict matching")</span>
          <span class="nc">NbtCompound</span>
          <span class="n">requiredNbt</span>
          <span class="o">=</span>
          <span class="o">...;</span>
          <span class="kt">boolean</span>
          <span class="n">match</span>
          <span class="o">=</span>
          <span class="n">stack</span>
          <span class="o">.</span>
          <span class="na">getOrDefault</span>
          <span class="o">(</span>
          <span class="nc">DataComponentTypes</span>
          <span class="o">.</span>
          <span class="na">CUSTOM_DATA</span>
          <span class="o">,</span>
          <span class="nc">NbtComponent</span>
          <span class="o">.</span>
          <span class="na">DEFAULT</span>
          <span class="o">).</span>
          <span class="na">matches</span>
          <span class="o">(</span>
          <span class="n">requiredNbt</span>
          <span class="o">);</span>
          <span class="c1">// use createPredicate to make Predicate&lt;ItemStack&gt;</span>
        </code>
      </pre>
    </div>
  </div>
  <p>Using <code class="language-plaintext highlighter-rouge">ComponentChanges</code> to mass-modify the components of <code class="language-plaintext highlighter-rouge">ItemStack</code>:
  </p>
  <div class="language-java highlighter-rouge">
    <div class="highlight">
      <pre class="highlight">
        <code>
          <span class="c1">// stack is a damageable item.</span>
          <span class="c1">// Repair the item and remove custom name.</span>
          <span class="c1">// Note that the resulting stack has no components because 0 damage is the default from the base components.</span>
          <span class="kt">var</span>
          <span class="n">changes</span>
          <span class="o">=</span>
          <span class="nc">ComponentChanges</span>
          <span class="o">.</span>
          <span class="na">builder</span>
          <span class="o">().</span>
          <span class="na">add</span>
          <span class="o">(</span>
          <span class="nc">DataComponentTypes</span>
          <span class="o">.</span>
          <span class="na">DAMAGE</span>
          <span class="o">,</span>
          <span class="mi">0</span>
          <span class="o">).</span>
          <span class="na">remove</span>
          <span class="o">(</span>
          <span class="nc">DataComponentTypes</span>
          <span class="o">.</span>
          <span class="na">CUSTOM_NAME</span>
          <span class="o">).</span>
          <span class="na">build</span>
          <span class="o">();</span>
          <span class="n">stack</span>
          <span class="o">.</span>
          <span class="na">applyChanges</span>
          <span class="o">(</span>
          <span class="n">changes</span>
          <span class="o">);</span>
        </code>
      </pre>
    </div>
  </div>
  <p>Making an item with base components:</p>
  <div class="language-java highlighter-rouge">
    <div class="highlight">
      <pre class="highlight">
        <code>
          <span class="nc">Item</span>
          <span class="n">item</span>
          <span class="o">=</span>
          <span class="k">new</span>
          <span class="nc">Item</span>
          <span class="o">(</span>
          <span class="k">new</span>
          <span class="nc">Item</span>
          <span class="o">.</span>
          <span class="na">Settings</span>
          <span class="o">().</span>
          <span class="na">component</span>
          <span class="o">(</span>
          <span class="nc">DataComponentTypes</span>
          <span class="o">.</span>
          <span class="na">CUSTOM_NAME</span>
          <span class="o">,</span>
          <span class="nc">Text</span>
          <span class="o">.</span>
          <span class="na">literal</span>
          <span class="o">(</span>
          <span class="s">"Hello"</span>
          <span class="o">)));</span>
          <span class="c1">// Call #component multiple times for multiple base components.</span>
          <span class="c1">// Note: calling maxDamage automatically adds DAMAGE component.</span>
        </code>
      </pre>
    </div>
  </div>
  <p>Making a custom component. Note that like many registered entries, these must be present in both the client and the server.</p>
  <div class="language-java highlighter-rouge">
    <div class="highlight">
      <pre class="highlight">
        <code>
          <span class="kd">public</span>
          <span class="kd">static</span>
          <span class="kd">final</span>
          <span class="nc">DataComponentType</span>
          <span class="o">&lt;</span>
          <span class="nc">Integer</span>
          <span class="o">&gt;</span>
          <span class="no">WEIRDNESS</span>
          <span class="o">=</span>
          <span class="nc">DataComponentType</span>
          <span class="o">.</span>
          <span class="na">builder</span>
          <span class="o">().</span>
          <span class="na">codec</span>
          <span class="o">(</span>
          <span class="nc">Codec</span>
          <span class="o">.</span>
          <span class="na">INT</span>
          <span class="o">).</span>
          <span class="na">packetCodec</span>
          <span class="o">(</span>
          <span class="nc">PacketCodecs</span>
          <span class="o">.</span>
          <span class="na">VAR_INT</span>
          <span class="o">).</span>
          <span class="na">build</span>
          <span class="o">();</span>
          <span class="c1">// in the initializer</span>
          <span class="nc">Registry</span>
          <span class="o">.</span>
          <span class="na">register</span>
          <span class="o">(</span>
          <span class="nc">Registries</span>
          <span class="o">.</span>
          <span class="na">DATA_COMPONENT_TYPE</span>
          <span class="o">,</span>
          <span class="k">new</span>
          <span class="nc">Identifier</span>
          <span class="o">(</span>
          <span class="s">"example"</span>
          <span class="o">,</span>
          <span class="s">"weirdness"</span>
          <span class="o">),</span>
          <span class="no">WEIRDNESS</span>
          <span class="o">);</span>
        </code>
      </pre>
    </div>
  </div>
  <h4 id="some-caveats">Some caveats</h4>
  <ul>
    <li>Component values should not be modified directly. Using <code class="language-plaintext highlighter-rouge">Record</code> or other immutable object is highly recommended. Always copy, modify, then set.</li>
    <li>Setting an invalid value for a component does not cause an error immediately, but will lead to a crash during save, and possible data corruption. A common example is <code class="language-plaintext highlighter-rouge">NONNEGATIVE_INT</code> being used for an incrementing value; when it overflows and the value is set to negatives, saving it would crash.</li>
  </ul>
  <h3 id="blockentity-interaction-with-components">BlockEntity interaction with components</h3>
  <p>
    <code class="language-plaintext highlighter-rouge">BlockEntity</code> stores the components when placing a block item stack with components and when pick-blocking. Components are not currently used to serialize block entities themselves. A block entity that uses components, like custom containers, should override <code class="language-plaintext highlighter-rouge">addComponents</code>,    <code class="language-plaintext highlighter-rouge">readComponents</code>, and <code class="language-plaintext highlighter-rouge">removeFromCopiedStackNbt</code> methods:</p>
  <ul>
    <li>
      <code class="language-plaintext highlighter-rouge">addComponents</code> adds the block entity’s stored data to a component builder.</li>
    <li>
      <code class="language-plaintext highlighter-rouge">readComponents</code> reads the block entity data from components.</li>
    <li>
      <code class="language-plaintext highlighter-rouge">removeFromCopiedStackNbt</code> removes NBT keys which are now serialized using components when in item stacks. For example, a chest’s held stacks are stored under <code class="language-plaintext highlighter-rouge">Items</code> key when the block entity itself is serialized, and stored under a component when an item stack for the block entity is serialized. To prevent double serialization, this method removes <code class="language-plaintext highlighter-rouge">Items</code> from the item stack NBT.</li>
  </ul>
  <p>Note that <code class="language-plaintext highlighter-rouge">LootableContainerBlockEntity</code> handles component changes themselves, so you do not have to reinvent the wheel if you use them.</p>
  <h3 id="item-component-related-fabric-api-changes">Item Component-related Fabric API changes</h3>
  <p>
    <code class="language-plaintext highlighter-rouge">allowNbtUpdateAnimations</code> method of <code class="language-plaintext highlighter-rouge">FabricItem</code> was renamed to <code class="language-plaintext highlighter-rouge">allowComponentsUpdateAnimations</code>.    <code class="language-plaintext highlighter-rouge">FabricItem.getAttributeModifiers</code> changes? <code class="language-plaintext highlighter-rouge">isSuitableFor</code> and <code class="language-plaintext highlighter-rouge">getFoodComponents</code> of <code class="language-plaintext highlighter-rouge">FabricItemStack</code> removed/replaced with vanilla components.</p>
  <h4 id="recipe-api">Recipe API</h4>
  <p>
    <code class="language-plaintext highlighter-rouge">DefaultCustomIngredients#nbt</code> and support for NBT ingredients were removed, as the game no longer uses NBT to store item stack-specific data.</p>
  <p>To check for custom name, enchantments, etc that were previously kept inside the NBT but are now recorded in the components (see below for details), use the new <code class="language-plaintext highlighter-rouge">components</code> ingredient. To check for custom data component (a NBT data not used by the game but can be used by data packs or commands), use the <code class="language-plaintext highlighter-rouge">customData</code> ingredient.</p>
  <h4 id="transfer-api">Transfer API</h4>
  <p>
    <code class="language-plaintext highlighter-rouge">TransferVariant</code> (such as <code class="language-plaintext highlighter-rouge">FluidVariant</code> or <code class="language-plaintext highlighter-rouge">ItemVariant</code>) is now a pair of the object and the components, instead of the object and NBT. <code class="language-plaintext highlighter-rouge">getNbt</code>,    <code class="language-plaintext highlighter-rouge">hasNbt</code>, and <code class="language-plaintext highlighter-rouge">nbtMatches</code> methods were replaced with <code class="language-plaintext highlighter-rouge">getComponents</code>,    <code class="language-plaintext highlighter-rouge">hasComponents</code>, and <code class="language-plaintext highlighter-rouge">componentsMatch</code> methods. The following methods were removed: <code class="language-plaintext highlighter-rouge">copyNbt</code>,    <code class="language-plaintext highlighter-rouge">copyOrCreateNbt</code>,    <code class="language-plaintext highlighter-rouge">toNbt</code>, and <code class="language-plaintext highlighter-rouge">toPacket</code>.
  </p>
  <p>
    <code class="language-plaintext highlighter-rouge">FluidVariant#of</code> and <code class="language-plaintext highlighter-rouge">ItemVariant#of</code> now takes <code class="language-plaintext highlighter-rouge">ComponentChanges</code> instead of <code class="language-plaintext highlighter-rouge">@Nullable NbtCompound</code>.
  </p>
  <p>
    <code class="language-plaintext highlighter-rouge">TransferVariant</code> is now serialized using codecs and packet codecs. Therefore, <code class="language-plaintext highlighter-rouge">fromNbt</code> and <code class="language-plaintext highlighter-rouge">fromPacket</code> static methods were removed.</p>
  <p>
    <code class="language-plaintext highlighter-rouge">SingleVariantStorage#writeNbt</code> instance method was removed; subclasses now provide separate methods named <code class="language-plaintext highlighter-rouge">writeNbt</code>. Both <code class="language-plaintext highlighter-rouge">readNbt</code> and <code class="language-plaintext highlighter-rouge">writeNbt</code> now require passing a <code class="language-plaintext highlighter-rouge">RegistryWrapper.WrapperLookup</code> instance; they should be available in the methods from which they are called (or you can use the world’s <code class="language-plaintext highlighter-rouge">DynamicRegistryManager</code> instance).</p>
  <h3 id="other-item-changes">Other Item changes</h3>
  <ul>
    <li>As noted in the video, an empty item stack is now serialized as omitting the field or an empty object. <code class="language-plaintext highlighter-rouge">ItemStack#fromNbt</code> now returns <code class="language-plaintext highlighter-rouge">Optional&lt;ItemStack&gt;</code> while <code class="language-plaintext highlighter-rouge">fromNbtOrEmpty</code> supports empty NBT object. Both now require passing the registries. These methods log an error when an item with ID <code class="language-plaintext highlighter-rouge">minecraft:air</code> is encountered.</li>
    <li>
      <code class="language-plaintext highlighter-rouge">writeNbt</code> method was renamed to <code class="language-plaintext highlighter-rouge">encode</code>. The one with <code class="language-plaintext highlighter-rouge">NbtCompound</code> argument allows adding to the existing compound, like <code class="language-plaintext highlighter-rouge">writeNbt</code>.
    </li>
    <li>The methods in <code class="language-plaintext highlighter-rouge">ItemStack</code> that reference <code class="language-plaintext highlighter-rouge">Nbt</code> are generally renamed to reference <code class="language-plaintext highlighter-rouge">Components</code> instead.</li>
    <li>
      <code class="language-plaintext highlighter-rouge">Item#isNbtSynced</code> was removed, specify custom packet codecs instead.</li>
    <li>
      <code class="language-plaintext highlighter-rouge">Item#getBreakSound</code> was added.</li>
    <li>Attack damage and mining speed of <code class="language-plaintext highlighter-rouge">MiningToolItem</code> and <code class="language-plaintext highlighter-rouge">SwordItem</code> are now specified in item settings via <code class="language-plaintext highlighter-rouge">attributeModifiers</code> setting.</li>
    <li>Item tooltips are now given a “tooltip type”, and <code class="language-plaintext highlighter-rouge">TooltipContext</code> is now under <code class="language-plaintext highlighter-rouge">Item</code>.      <code class="language-plaintext highlighter-rouge">ItemTooltipCallback</code> Fabric API event now passes the type as well. Note that <code class="language-plaintext highlighter-rouge">hide_tooltip</code> item component prevents the event from being invoked.</li>
  </ul>
  <h4 id="item-damages">Item damages</h4>
  <p>When damaging an item stack held in the hands or in the armor slots, you now pass the <code class="language-plaintext highlighter-rouge">EquipmentSlot</code> instead of a callback:</p>
  <div class="language-diff highlighter-rouge">
    <div class="highlight">
      <pre class="highlight">
        <code>
          <span class="gd">- stack.damage(1, entity, p -&gt; p.sendToolBreakStatus(Hand.MAIN_HAND)); </span>
          <span class="gi">+ stack.damage(1, entity, EquipmentSlot.MAINHAND); </span>
        </code>
      </pre>
    </div>
  </div>
  <p>When damaging an item stack held by non-entities (like shears in dispensers), the stack must be broken by the newly passed callback, not by checking the return value.</p>
  <div class="language-diff highlighter-rouge">
    <div class="highlight">
      <pre class="highlight">
        <code>
          <span class="gd">- if (stack.damage(1, random, null)) stack.setCount(0); </span>
          <span class="gi">+ stack.damage(1, random, null, () -&gt; stack.setCount(0)); </span>
        </code>
      </pre>
    </div>
  </div>
  <p>In Fabric API, <code class="language-plaintext highlighter-rouge">CustomDamageHandler</code> callback’s signature was changed from <code class="language-plaintext highlighter-rouge">ItemStack stack, int amount, LivingEntity entity, Consumer breakCallback</code> to <code class="language-plaintext highlighter-rouge">ItemStack stack, int amount, LivingEntity entity, EquipmentSlot slot, Runnable breakCallback</code>. Additionally, calling <code class="language-plaintext highlighter-rouge">breakCallback</code> now ignores the return value and vanilla damage handler (as the item is already broken).</p>
  <h3 id="networking">Networking</h3>
  <p>Previously, networking code was simple: reading from, and writing to, <code class="language-plaintext highlighter-rouge">PacketByteBuf</code>. Although this method still works, Mojang has added an abstraction layor: <code class="language-plaintext highlighter-rouge">PacketCodec</code>.
  </p>
  <p>
    <code class="language-plaintext highlighter-rouge">PacketCodec</code> works like the DataFixerUpper codecs used in JSON/NBT serialization - although they are not compatible with each other. To keep it simple, <strong>
    <code class="language-plaintext highlighter-rouge">PacketCodec</code> is a pair of deserializers and serializers</strong> - or, decoders and encoders. This change reduces bugs related to wrong read/write order - which is one of the most difficult bugs to identify.</p>
<h4 id="how-to-create-a-packetcodec">How to create a PacketCodec</h4>
<p>Note: A new subclass of <code class="language-plaintext highlighter-rouge">PacketByteBuf</code>,  <strong>
    <code class="language-plaintext highlighter-rouge">RegistryByteBuf</code>, is used for PLAY-phase networking</strong> (the one you’re probably using). For <code class="language-plaintext highlighter-rouge">ConfigurationNetworking</code>, use <code class="language-plaintext highlighter-rouge">PacketByteBuf</code> instead of <code class="language-plaintext highlighter-rouge">RegistryByteBuf</code>.  <code class="language-plaintext highlighter-rouge">PacketCodec</code>s are usually stored in a <code class="language-plaintext highlighter-rouge">public static final</code> field.</p>
<p>Suppose we are serializing this record:</p>
<div class="language-java highlighter-rouge">
  <div class="highlight">
    <pre class="highlight">
      <code>
        <span class="kd">public</span>
        <span class="n">record</span>
        <span class="nf">VirtualHugs</span>
        <span class="o">(</span>
        <span class="kt">int</span>
        <span class="n">count</span>
        <span class="o">)</span>
        <span class="o">{</span>
        <span class="c1">// Note: replaced PacketByteBuf with RegistryByteBuf</span>
        <span class="kd">public</span>
        <span class="nf">VirtualHugs</span>
        <span class="o">(</span>
        <span class="nc">RegistryByteBuf</span>
        <span class="n">buf</span>
        <span class="o">)</span>
        <span class="o">{</span>
        <span class="k">this</span>
        <span class="o">(</span>
        <span class="n">buf</span>
        <span class="o">.</span>
        <span class="na">readVarInt</span>
        <span class="o">());</span>
        <span class="o">}</span>
        <span class="c1">// Instance method</span>
        <span class="kd">public</span>
        <span class="kt">void</span>
        <span class="nf">write</span>
        <span class="o">(</span>
        <span class="nc">RegistryByteBuf</span>
        <span class="n">buf</span>
        <span class="o">)</span>
        <span class="o">{</span>
        <span class="n">buf</span>
        <span class="o">.</span>
        <span class="na">writeVarInt</span>
        <span class="o">(</span>
        <span class="n">count</span>
        <span class="o">);</span>
        <span class="o">}</span>
        <span class="c1">// Static method, buffer-first</span>
        <span class="kd">public</span>
        <span class="kd">static</span>
        <span class="kt">void</span>
        <span class="nf">write2</span>
        <span class="o">(</span>
        <span class="nc">RegistryByteBuf</span>
        <span class="n">buf</span>
        <span class="o">,</span>
        <span class="nc">VirtualHugs</span>
        <span class="n">hugs</span>
        <span class="o">)</span>
        <span class="o">{</span>
        <span class="n">buf</span>
        <span class="o">.</span>
        <span class="na">writeVarInt</span>
        <span class="o">(</span>
        <span class="n">hugs</span>
        <span class="o">.</span>
        <span class="na">count</span>
        <span class="o">())</span>
        <span class="o">}</span>
        <span class="o">}</span>
      </code>
    </pre>
  </div>
</div>
<ol>
  <li>The easy method - adopting existing code</li>
</ol>
<div class="language-java highlighter-rouge">
  <div class="highlight">
    <pre class="highlight">
      <code>
        <span class="nc">PacketCodec</span>
        <span class="o">&lt;</span>
        <span class="nc">RegistryByteBuf</span>
        <span class="o">,</span>
        <span class="nc">VirtualHugs</span>
        <span class="o">&gt;</span>
        <span class="no">PACKET_CODEC</span>
        <span class="o">=</span>
        <span class="nc">PacketCodec</span>
        <span class="o">.</span>
        <span class="na">of</span>
        <span class="o">(</span>
        <span class="nl">VirtualHugs:</span>
        <span class="o">:</span>
        <span class="n">write</span>
        <span class="o">,</span>
        <span class="nl">VirtualHugs:</span>
        <span class="o">:</span>
        <span class="k">new</span>
        <span class="o">);</span>
        <span class="c1">// Or, using static method:</span>
        <span class="no">PACKET_CODEC</span>
        <span class="o">=</span>
        <span class="nc">PacketCodec</span>
        <span class="o">.</span>
        <span class="na">ofStatic</span>
        <span class="o">(</span>
        <span class="nl">VirtualHugs:</span>
        <span class="o">:</span>
        <span class="n">write2</span>
        <span class="o">,</span>
        <span class="nl">VirtualHugs:</span>
        <span class="o">:</span>
        <span class="k">new</span>
        <span class="o">);</span>
      </code>
    </pre>
  </div>
</div>
<ol>
  <li>The new method - building codecs from other codecs, like in DataFixerUpper</li>
</ol>
<div class="language-java highlighter-rouge">
  <div class="highlight">
    <pre class="highlight">
      <code>
        <span class="c1">// "tuple" is an ordered, un-keyed set of stuff.</span>
        <span class="c1">// Up to 3 fields can be serialized with vanilla method.</span>
        <span class="c1">// The constructor always comes last.</span>
        <span class="no">CODEC</span>
        <span class="o">=</span>
        <span class="nc">PacketCodec</span>
        <span class="o">.</span>
        <span class="na">tuple</span>
        <span class="o">(</span>
        <span class="nc">PacketCodecs</span>
        <span class="o">.</span>
        <span class="na">VAR_INT</span>
        <span class="o">,</span>
        <span class="nl">VirtualHugs:</span>
        <span class="o">:</span>
        <span class="n">count</span>
        <span class="o">,</span>
        <span class="nl">VirtualHugs:</span>
        <span class="o">:</span>
        <span class="k">new</span>
        <span class="o">);</span>
        <span class="c1">// Or, since there is only one field in VirtualHugs, this works too.</span>
        <span class="no">CODEC</span>
        <span class="o">=</span>
        <span class="nc">PacketCodecs</span>
        <span class="o">.</span>
        <span class="na">VAR_INT</span>
        <span class="o">.</span>
        <span class="na">xmap</span>
        <span class="o">(</span>
        <span class="nl">VirtualHugs:</span>
        <span class="o">:</span>
        <span class="k">new</span>
        <span class="o">,</span>
        <span class="nl">VirtualHugs:</span>
        <span class="o">:</span>
        <span class="n">count</span>
        <span class="o">);</span>
      </code>
    </pre>
  </div>
</div>
<p>
  <strong>You might see some nasty casting errors in some cases. Call <code class="language-plaintext highlighter-rouge">.cast()</code> on the codec to make it go away;</strong> it’s generally safe to do so.</p>
<h4 id="advanced-packetcodecs-examples">Advanced PacketCodecs examples</h4>
<p>Here are some more examples:</p>
<div class="language-java highlighter-rouge">
  <div class="highlight">
    <pre class="highlight">
      <code>
        <span class="c1">// For a singleton (like an empty packet). Encoding something other than INSTANCE will error.</span>
        <span class="c1">// It does not actually touch the buffer.</span>
        <span class="kt">var</span>
        <span class="n">singleton</span>
        <span class="o">=</span>
        <span class="nc">PacketCodec</span>
        <span class="o">.</span>
        <span class="na">unit</span>
        <span class="o">(</span>
        <span class="no">INSTANCE</span>
        <span class="o">);</span>
        <span class="c1">// Using PacketCodec from classic API</span>
        <span class="nc">Text</span>
        <span class="n">text</span>
        <span class="o">=</span>
        <span class="nc">TextCodecs</span>
        <span class="o">.</span>
        <span class="na">PACKET_CODEC</span>
        <span class="o">.</span>
        <span class="na">decode</span>
        <span class="o">(</span>
        <span class="n">buf</span>
        <span class="o">);</span>
        <span class="nc">TextCodecs</span>
        <span class="o">.</span>
        <span class="na">PACKET_CODEC</span>
        <span class="o">.</span>
        <span class="na">encode</span>
        <span class="o">(</span>
        <span class="n">buf</span>
        <span class="o">,</span>
        <span class="n">text</span>
        <span class="o">);</span>
        <span class="c1">// Codec for Optional&lt;Text&gt;</span>
        <span class="c1">// Compatible with PacketByteBuf#readOptional</span>
        <span class="kt">var</span>
        <span class="n">optText</span>
        <span class="o">=</span>
        <span class="nc">TextCodecs</span>
        <span class="o">.</span>
        <span class="na">PACKET_CODEC</span>
        <span class="o">.</span>
        <span class="na">collect</span>
        <span class="o">(</span>
        <span class="nl">PacketCodecs:</span>
        <span class="o">:</span>
        <span class="n">optional</span>
        <span class="o">);</span>
        <span class="c1">// Codec for List&lt;String&gt;</span>
        <span class="kt">var</span>
        <span class="n">strings</span>
        <span class="o">=</span>
        <span class="nc">PacketCodecs</span>
        <span class="o">.</span>
        <span class="na">STRING</span>
        <span class="o">.</span>
        <span class="na">collect</span>
        <span class="o">(</span>
        <span class="nc">PacketCodecs</span>
        <span class="o">.</span>
        <span class="na">toList</span>
        <span class="o">());</span>
        <span class="c1">// or Set&lt;String&gt;, each max 16 chars</span>
        <span class="c1">// both work fine, compatible with PacketByteBuf#readCollection</span>
        <span class="kt">var</span>
        <span class="n">stringSet</span>
        <span class="o">=</span>
        <span class="nc">PacketCodecs</span>
        <span class="o">.</span>
        <span class="na">string</span>
        <span class="o">(</span>
        <span class="mi">16</span>
        <span class="o">).</span>
        <span class="na">collect</span>
        <span class="o">(</span>
        <span class="nc">PacketCodecs</span>
        <span class="o">.</span>
        <span class="na">toCollection</span>
        <span class="o">(</span>
        <span class="nl">HashSet:</span>
        <span class="o">:</span>
        <span class="k">new</span>
        <span class="o">));</span>
        <span class="n">stringSet</span>
        <span class="o">=</span>
        <span class="nc">PacketCodecs</span>
        <span class="o">.</span>
        <span class="na">collection</span>
        <span class="o">(</span>
        <span class="nl">HashSet:</span>
        <span class="o">:</span>
        <span class="k">new</span>
        <span class="o">,</span>
        <span class="nc">PacketCodecs</span>
        <span class="o">.</span>
        <span class="na">string</span>
        <span class="o">(</span>
        <span class="mi">16</span>
        <span class="o">));</span>
        <span class="c1">// Map&lt;String, BlockPos&gt;</span>
        <span class="kt">var</span>
        <span class="n">positions</span>
        <span class="o">=</span>
        <span class="nc">PacketCodecs</span>
        <span class="o">.</span>
        <span class="na">map</span>
        <span class="o">(</span>
        <span class="nl">HashMap:</span>
        <span class="o">:</span>
        <span class="k">new</span>
        <span class="o">,</span>
        <span class="nc">PacketCodecs</span>
        <span class="o">.</span>
        <span class="na">STRING</span>
        <span class="o">,</span>
        <span class="nc">BlockPos</span>
        <span class="o">.</span>
        <span class="na">PACKET_CODEC</span>
        <span class="o">);</span>
        <span class="c1">// What? DataFixerUpper codecs?</span>
        <span class="c1">// Nah, these are just serialized as NBTs.</span>
        <span class="kt">var</span>
        <span class="n">advancement</span>
        <span class="o">=</span>
        <span class="nc">PacketCodecs</span>
        <span class="o">.</span>
        <span class="na">codec</span>
        <span class="o">(</span>
        <span class="nc">Advancement</span>
        <span class="o">.</span>
        <span class="na">CODEC</span>
        <span class="o">);</span>
        <span class="c1">// Serializing NbtCompound</span>
        <span class="kt">var</span>
        <span class="n">nbt</span>
        <span class="o">=</span>
        <span class="nc">PacketCodecs</span>
        <span class="o">.</span>
        <span class="na">NBT_COMPOUND</span>
        <span class="o">;</span>
        <span class="c1">// Serializing a registry value (by raw ID)</span>
        <span class="c1">// Note: these require RegistryByteBuf!</span>
        <span class="nc">PacketCodec</span>
        <span class="o">&lt;</span>
        <span class="nc">RegistryByteBuf</span>
        <span class="o">,</span>
        <span class="nc">Item</span>
        <span class="o">&gt;</span>
        <span class="n">item</span>
        <span class="o">=</span>
        <span class="nc">PacketCodecs</span>
        <span class="o">.</span>
        <span class="na">registryValue</span>
        <span class="o">(</span>
        <span class="nc">RegistryKeys</span>
        <span class="o">.</span>
        <span class="na">ITEM</span>
        <span class="o">);</span>
        <span class="c1">// Or, RegistryEntry</span>
        <span class="nc">PacketCodec</span>
        <span class="o">&lt;</span>
        <span class="nc">RegistryByteBuf</span>
        <span class="o">,</span>
        <span class="nc">Biome</span>
        <span class="o">&gt;</span>
        <span class="n">biome</span>
        <span class="o">=</span>
        <span class="nc">PacketCodecs</span>
        <span class="o">.</span>
        <span class="na">registryEntry</span>
        <span class="o">(</span>
        <span class="nc">RegistryKeys</span>
        <span class="o">.</span>
        <span class="na">BIOME</span>
        <span class="o">);</span>
        <span class="c1">// Serializing an Enum</span>
        <span class="kt">var</span>
        <span class="n">axis</span>
        <span class="o">=</span>
        <span class="nc">PacketCodecs</span>
        <span class="o">.</span>
        <span class="na">indexed</span>
        <span class="o">(</span>
        <span class="n">i</span>
        <span class="o">-&gt;</span>
        <span class="nc">Direction</span>
        <span class="o">.</span>
        <span class="na">Axis</span>
        <span class="o">.</span>
        <span class="na">VALUES</span>
        <span class="o">[</span>
        <span class="n">i</span>
        <span class="o">],</span>
        <span class="nc">Direction</span>
        <span class="o">.</span>
        <span class="na">Axis</span>
        <span class="o">::</span>
        <span class="n">ordinal</span>
        <span class="o">);</span>
      </code>
    </pre>
  </div>
</div>
<h4 id="fabric-networking-api">Fabric Networking API</h4>
<p>Networking API no longer directly uses <code class="language-plaintext highlighter-rouge">PacketByteBuf</code>, except in <code class="language-plaintext highlighter-rouge">LoginNetworking</code>. Instead, you need to subclass <code class="language-plaintext highlighter-rouge">CustomPayload</code> and register it. Note that <code class="language-plaintext highlighter-rouge">CustomPayload</code> is a vanilla interface. While this is similar to the packet object-based networking introduced recently, it is different in some ways. (<code class="language-plaintext highlighter-rouge">PacketType</code> and <code class="language-plaintext highlighter-rouge">FabricPacket</code> were, therefore, removed.)</p>
<p>Compare the following, pre-snapshot packet:</p>
<div class="language-java highlighter-rouge">
  <div class="highlight">
    <pre class="highlight">
      <code>
        <span class="kd">public</span>
        <span class="n">record</span>
        <span class="nf">SlapPacket</span>
        <span class="o">(</span>
        <span class="no">UUID</span>
        <span class="n">slapped</span>
        <span class="o">)</span>
        <span class="kd">implements</span>
        <span class="nc">FabricPacket</span>
        <span class="o">{</span>
        <span class="kd">public</span>
        <span class="kd">static</span>
        <span class="kd">final</span>
        <span class="nc">Identifier</span>
        <span class="no">ID</span>
        <span class="o">=</span>
        <span class="k">new</span>
        <span class="nc">Identifier</span>
        <span class="o">(...);</span>
        <span class="kd">public</span>
        <span class="kd">static</span>
        <span class="kd">final</span>
        <span class="nc">PacketType</span>
        <span class="o">&lt;</span>
        <span class="nc">SlapPacket</span>
        <span class="o">&gt;</span>
        <span class="no">TYPE</span>
        <span class="o">=</span>
        <span class="nc">PacketType</span>
        <span class="o">.</span>
        <span class="na">create</span>
        <span class="o">(</span>
        <span class="no">ID</span>
        <span class="o">,</span>
        <span class="nl">SlapPacket:</span>
        <span class="o">:</span>
        <span class="k">new</span>
        <span class="o">);</span>
        <span class="kd">public</span>
        <span class="nf">SlapPacket</span>
        <span class="o">(</span>
        <span class="nc">PacketByteBuf</span>
        <span class="n">buf</span>
        <span class="o">)</span>
        <span class="o">{</span>
        <span class="k">this</span>
        <span class="o">(</span>
        <span class="n">buf</span>
        <span class="o">.</span>
        <span class="na">readUuid</span>
        <span class="o">());</span>
        <span class="o">}</span>
        <span class="nd">@Override</span>
        <span class="kd">public</span>
        <span class="kt">void</span>
        <span class="nf">write</span>
        <span class="o">(</span>
        <span class="nc">PacketByteBuf</span>
        <span class="n">buf</span>
        <span class="o">)</span>
        <span class="o">{</span>
        <span class="n">buf</span>
        <span class="o">.</span>
        <span class="na">writeUuid</span>
        <span class="o">(</span>
        <span class="n">slapped</span>
        <span class="o">);</span>
        <span class="o">}</span>
        <span class="o">}</span>
      </code>
    </pre>
  </div>
</div>
<p>And a new one:</p>
<div class="language-java highlighter-rouge">
  <div class="highlight">
    <pre class="highlight">
      <code>
        <span class="kd">public</span>
        <span class="n">record</span>
        <span class="nf">SlapPacket</span>
        <span class="o">(</span>
        <span class="no">UUID</span>
        <span class="n">slapped</span>
        <span class="o">)</span>
        <span class="kd">implements</span>
        <span class="nc">CustomPayload</span>
        <span class="o">{</span>
        <span class="kd">public</span>
        <span class="kd">static</span>
        <span class="kd">final</span>
        <span class="nc">CustomPayload</span>
        <span class="o">.</span>
        <span class="na">Id</span>
        <span class="o">&lt;</span>
        <span class="nc">SlapPacket</span>
        <span class="o">&gt;</span>
        <span class="no">PACKET_ID</span>
        <span class="o">=</span>
        <span class="k">new</span>
        <span class="nc">CustomPayload</span>
        <span class="o">.</span>
        <span class="na">Id</span>
        <span class="o">&lt;&gt;(</span>
        <span class="k">new</span>
        <span class="nc">Identifier</span>
        <span class="o">(...));</span>
        <span class="kd">public</span>
        <span class="kd">static</span>
        <span class="kd">final</span>
        <span class="nc">PacketCodec</span>
        <span class="o">&lt;</span>
        <span class="nc">RegistryByteBuf</span>
        <span class="o">,</span>
        <span class="nc">SlapPacket</span>
        <span class="o">&gt;</span>
        <span class="no">PACKET_CODEC</span>
        <span class="o">=</span>
        <span class="nc">Uuids</span>
        <span class="o">.</span>
        <span class="na">PACKET_CODEC</span>
        <span class="o">.</span>
        <span class="na">xmap</span>
        <span class="o">(</span>
        <span class="nl">SlapPacket:</span>
        <span class="o">:</span>
        <span class="k">new</span>
        <span class="o">,</span>
        <span class="nl">SlapPacket:</span>
        <span class="o">:</span>
        <span class="n">slapped</span>
        <span class="o">).</span>
        <span class="na">cast</span>
        <span class="o">();</span>
        <span class="o">}</span>
      </code>
    </pre>
  </div>
</div>
<p>There are three differences you will notice:</p>
<ul>
  <li>Instead of now-removed <code class="language-plaintext highlighter-rouge">FabricPacket</code>, we implement <code class="language-plaintext highlighter-rouge">CustomPayload</code>.
  </li>
  <li>Each <code class="language-plaintext highlighter-rouge">CustomPayload</code> implementation has its own <code class="language-plaintext highlighter-rouge">CustomPayload.Id</code>. Unlike <code class="language-plaintext highlighter-rouge">PacketType</code>, it lacks reference to the decoder.</li>
  <li>The latter does not have a <code class="language-plaintext highlighter-rouge">write</code> method or <code class="language-plaintext highlighter-rouge">PacketByteBuf</code>-taking constructor. Instead, <code class="language-plaintext highlighter-rouge">PACKET_CODEC</code> field was added. (Note, you can make your <code class="language-plaintext highlighter-rouge">PacketCodec</code> from the constructor and the <code class="language-plaintext highlighter-rouge">write</code> method, so don’t just remove those!)</li>
</ul>
<p>But, you may ask, how do you get the decoder if it’s not in <code class="language-plaintext highlighter-rouge">Id</code>? Good question. The answer: <strong>you need to register it in <code class="language-plaintext highlighter-rouge">ModInitializer</code> on both ends (sender and receiver)</strong>. In fact, Fabric API will happily crash if you don’t before calling <code class="language-plaintext highlighter-rouge">registerGlobalReceiver</code>.
</p>
<div class="language-java highlighter-rouge">
<div class="highlight">
  <pre class="highlight">
    <code>
      <span class="c1">// SlapPacket is sent during gameplay</span>
      <span class="c1">// from the client to the server (serverbound; C2S)</span>
      <span class="nc">PayloadTypeRegistry</span>
      <span class="o">.</span>
      <span class="na">playC2S</span>
      <span class="o">().</span>
      <span class="na">register</span>
      <span class="o">(</span>
      <span class="nc">SlapPacket</span>
      <span class="o">.</span>
      <span class="na">PACKET_ID</span>
      <span class="o">,</span>
      <span class="nc">SlapPacket</span>
      <span class="o">.</span>
      <span class="na">PACKET_CODEC</span>
      <span class="o">);</span>
      <span class="c1">// Replace with configurationS2C, playS2C, etc.</span>
    </code>
  </pre>
</div>
</div>
<p>Then, you can change the receiver. Instead of long parameters, the event callback now gets only 2 parameters: the payload that was sent, and a context object. (Don’t worry, it won’t eat the RAM.)</p>
<div class="language-diff highlighter-rouge">
<div class="highlight">
  <pre class="highlight">
    <code>
      <span class="gd">- ServerPlayNetworking.registerGlobalReceiver(SlapPacket.TYPE, (packet, player, sender) -&gt; { - var world = player.getServerWorld(); </span>
      <span class="gi">+ServerPlayNetworking.registerGlobalReceiver(SlapPacket.PACKET_ID, (payload, context) -&gt; { + var world = context.player().getServerWorld(); </span> var entity = world.getEntity(packet.slapped()); <span class="err">});</span>
    </code>
  </pre>
</div>
</div>
<p>Here are the available fields in the context object:</p>
<table>
<thead>
  <tr>
    <th>
      <code class="language-plaintext highlighter-rouge">PayloadTypeRegistry</code>
    </th>
    <th>Class</th>
    <th>Context Fields</th>
  </tr>
</thead>
<tbody>
  <tr>
    <td>
      <code class="language-plaintext highlighter-rouge">playC2S</code>
    </td>
    <td>
      <code class="language-plaintext highlighter-rouge">ServerPlayNetworking</code>
    </td>
    <td>
      <code class="language-plaintext highlighter-rouge">player</code>,      <code class="language-plaintext highlighter-rouge">responseSender</code>
    </td>
  </tr>
  <tr>
    <td>
      <code class="language-plaintext highlighter-rouge">playS2C</code>
    </td>
    <td>
      <code class="language-plaintext highlighter-rouge">ClientPlayNetworking</code>
    </td>
    <td>
      <code class="language-plaintext highlighter-rouge">client</code>,      <code class="language-plaintext highlighter-rouge">player</code>,      <code class="language-plaintext highlighter-rouge">responseSender</code>
    </td>
  </tr>
  <tr>
    <td>
      <code class="language-plaintext highlighter-rouge">configurationC2S</code>
    </td>
    <td>
      <code class="language-plaintext highlighter-rouge">ServerConfigurationNetworking</code>
    </td>
    <td>
      <code class="language-plaintext highlighter-rouge">networkHandler</code>,      <code class="language-plaintext highlighter-rouge">responseSender</code>
    </td>
  </tr>
  <tr>
    <td>
      <code class="language-plaintext highlighter-rouge">configurationS2C</code>
    </td>
    <td>
      <code class="language-plaintext highlighter-rouge">ClientConfigurationNetworking</code>
    </td>
    <td>
      <code class="language-plaintext highlighter-rouge">responseSender</code>
    </td>
  </tr>
</tbody>
</table>
<p>Note that the field shortcuts might be added later.</p>
<p>Finally, sending the packet also uses <code class="language-plaintext highlighter-rouge">CustomPayload</code>.<strong>Remember to register the codec first</strong>!
</p>
<div class="language-java highlighter-rouge">
<div class="highlight">
  <pre class="highlight">
    <code>
      <span class="nc">ClientPlayNetworking</span>
      <span class="o">.</span>
      <span class="na">send</span>
      <span class="o">(</span>
      <span class="nc">SlapPacket</span>
      <span class="o">.</span>
      <span class="na">PACKET_ID</span>
      <span class="o">,</span>
      <span class="k">new</span>
      <span class="nc">SlapPacket</span>
      <span class="o">(...));</span>
      <span class="c1">// for PacketSender:</span>
      <span class="n">sender</span>
      <span class="o">.</span>
      <span class="na">sendPacket</span>
      <span class="o">(</span>
      <span class="k">new</span>
      <span class="nc">SlapPacket</span>
      <span class="o">(...));</span>
    </code>
  </pre>
</div>
</div>
<p>Note: <strong>
<code class="language-plaintext highlighter-rouge">PacketSender</code> no longer provides APIs that use <code class="language-plaintext highlighter-rouge">PacketByteBuf</code>.
</strong> For login networking where custom payloads are not used yet, use the subinterface <code class="language-plaintext highlighter-rouge">LoginPacketSender</code>.
</p>
<p>Some other Networking API related changes:</p>
<ul>
<li>
<code class="language-plaintext highlighter-rouge">FutureListeners</code> was removed.</li>
<li>
<code class="language-plaintext highlighter-rouge">GenericFutureListener</code>-taking methods in <code class="language-plaintext highlighter-rouge">PacketSender</code> were removed. Use the one taking <code class="language-plaintext highlighter-rouge">PacketCallbacks</code>.
</li>
<li>
<code class="language-plaintext highlighter-rouge">ServerPlayNetworking#getServer</code> was removed. <code class="language-plaintext highlighter-rouge">handler.player.server</code> should work.</li>
</ul>
<h3 id="networking-adjacent-changes-in-fabric-api">Networking-adjacent changes in Fabric API</h3>
<h4 id="particles-api">Particles API</h4>
<p>
<code class="language-plaintext highlighter-rouge">FabricParticleTypes#complex</code> now requires you to pass both <code class="language-plaintext highlighter-rouge">Codec</code> and <code class="language-plaintext highlighter-rouge">PacketCodec</code> for serializing the particle type. The string-based parser, <code class="language-plaintext highlighter-rouge">ParticleType.Factory</code>, was removed.</p>
<h4 id="recipe-api-1">Recipe API</h4>
<p>
<code class="language-plaintext highlighter-rouge">CustomIngredientSerializer</code> must now override <code class="language-plaintext highlighter-rouge">getPacketCodec</code>. The <code class="language-plaintext highlighter-rouge">read</code> and <code class="language-plaintext highlighter-rouge">write</code> methods were removed. Use <code class="language-plaintext highlighter-rouge">Ingredient#PACKET_CODEC</code> for representing another ingredient (which Fabric API patches up to also support ours).</p>
<h4 id="screen-handler-api">Screen Handler API</h4>
<p>
<code class="language-plaintext highlighter-rouge">ExtendedScreenHandlerType</code> now uses a payload object instead of <code class="language-plaintext highlighter-rouge">PacketByteBuf</code>. In the type constructor, you now need to pass <code class="language-plaintext highlighter-rouge">PacketCodec</code>:
</p>
<div class="language-java highlighter-rouge">
<div class="highlight">
<pre class="highlight">
  <code>
    <span class="kd">public</span>
    <span class="kd">static</span>
    <span class="kd">final</span>
    <span class="nc">ExtendedScreenHandlerType</span>
    <span class="o">&lt;</span>
    <span class="nc">OvenScreenHandler</span>
    <span class="o">&gt;</span>
    <span class="no">OVEN</span>
    <span class="o">=</span>
    <span class="k">new</span>
    <span class="nc">ExtendedScreenHandlerType</span>
    <span class="o">((</span>
    <span class="n">syncId</span>
    <span class="o">,</span>
    <span class="n">inventory</span>
    <span class="o">,</span>
    <span class="n">data</span>
    <span class="o">)</span>
    <span class="o">-&gt;</span>
    <span class="o">...,</span>
    <span class="nc">OvenData</span>
    <span class="o">.</span>
    <span class="na">PACKET_CODEC</span>
    <span class="o">);</span>
  </code>
</pre>
</div>
</div>
<p>Notice that the callback got <code class="language-plaintext highlighter-rouge">data</code> instead of <code class="language-plaintext highlighter-rouge">buf</code>, as well. Note that the payload object can be of any type, whether it be <code class="language-plaintext highlighter-rouge">Identifier</code> or your custom record. (These don’t have to be registered in <code class="language-plaintext highlighter-rouge">PayloadTypeRegistry</code>.)
</p>
<p>
<code class="language-plaintext highlighter-rouge">ExtendedScreenHandlerFactory#writeScreenOpeningData</code> was replaced with <code class="language-plaintext highlighter-rouge">getScreenOpeningData</code>. It takes the player as the sole argument and returns the data class, in this case, <code class="language-plaintext highlighter-rouge">OvenData</code>.
</p>
<h3 id="registries">Registries</h3>
<h4 id="registrywrapper--datagen">RegistryWrapper &amp; datagen</h4>
<p>Many methods for serialization now require <code class="language-plaintext highlighter-rouge">RegistryWrapper.WrapperLookup</code> instance. This is used to query registries, and <code class="language-plaintext highlighter-rouge">DynamicRegistryManager</code> instance can be used for this purpose. This change is most prominent in text and data generation-related code. This registry is used to query data-driven values during serialization.</p>
<p>Data provider constructors in Fabric API now take <code class="language-plaintext highlighter-rouge">RegistryWrapper.WrapperLookup</code> as a parameter; modders should change their constructors to take the instance and pass to the <code class="language-plaintext highlighter-rouge">super</code> constructor. In addition, <code class="language-plaintext highlighter-rouge">FabricAdvancementProvider#generateAdvancement</code> now also passes the instance.</p>
<div class="language-diff highlighter-rouge">
<div class="highlight">
<pre class="highlight">
  <code>
    <span class="p">public class TestBlockLootTableProvider extends FabricBlockLootTableProvider { </span>
    <span class="gd">- private TestBlockLootTableProvider(FabricDataOutput output) { - super(output); </span>
    <span class="gi">+ private TestBlockLootTableProvider(FabricDataOutput output, CompletableFuture&lt;RegistryWrapper.WrapperLookup&gt; registryLookup) { + super(output, registryLookup); </span> } 
  </code>
</pre>
</div>
</div>
<h4 id="loot-registries">Loot Registries</h4>
<p>Loot tables (including loot-adjacent stuff, namely predicates and item modifiers) are now managed by a special type of registry, called “reloadable registries”. Unlike ordinary registries, they are reloaded during <code class="language-plaintext highlighter-rouge">/reload</code>.
</p>
<p>
<code class="language-plaintext highlighter-rouge">LootDataLookup</code> was removed; <code class="language-plaintext highlighter-rouge">ReloadableRegistries.Lookup</code> can be obtained from <code class="language-plaintext highlighter-rouge">server.getReloadableRegistries()</code>. From there, item modifiers and predicates can be looked up via <code class="language-plaintext highlighter-rouge">getRegistryManager</code>; a shortcut exists for loot tables via <code class="language-plaintext highlighter-rouge">getLootTable</code>.
</p>
<p>Registry-ification of loot table also means that they are now identified with <code class="language-plaintext highlighter-rouge">RegistryKey</code>. Use <code class="language-plaintext highlighter-rouge">RegistryKey.of(RegistryKeys.LOOT_TABLE, id)</code> to get the registry key. In Fabric API, <code class="language-plaintext highlighter-rouge">VillagerInteractionRegistries#registerGiftLootTable</code> now takes the registry key, while the ID-taking method is deprecated.</p>
<p>Fabric API’s Loot API received breaking changes. For the arguments passed to events, <code class="language-plaintext highlighter-rouge">ResourceMaanger</code> and <code class="language-plaintext highlighter-rouge">LootManager</code> is gone. In the <code class="language-plaintext highlighter-rouge">LOAD_ALL</code> event, the loot manager was replaced with <code class="language-plaintext highlighter-rouge">Registry&lt;LootTable&gt;</code>. In all places, <code class="language-plaintext highlighter-rouge">Identifier</code> is replaced with <code class="language-plaintext highlighter-rouge">RegistryKey</code> as described above. In addition, because mutating registry is impossible now, the loot tables are modified before addition; this means that per-table events don’t get the table registry anymore.</p>
<h4 id="other-changes">Other changes</h4>
<p>A new syncing protocol is in place for <code class="language-plaintext highlighter-rouge">DynamicRegistryManager</code> entries. Vanilla data packs provide <code class="language-plaintext highlighter-rouge">knownPackInfo</code> fields, which are sent by the server on joined clients. Clients then reply with the subset of the info they understand (i.e. loaded on their side). When a registry entry is loaded from a pack with <code class="language-plaintext highlighter-rouge">knownPackInfo</code>, and the client has acknowledged the info for the pack, the server tells the client to refer to its own copy of the data, skipping sending the serialized entry over the network. Most importantly, <strong>this is currently not used by mod-provided packs</strong>, so the registry entries from mods will be sent even if the client has the same mod.</p>
<p>
<code class="language-plaintext highlighter-rouge">SimpleRegistry</code> no longer supports changing the registered value post-registration (such as by the <code class="language-plaintext highlighter-rouge">set</code> method). For this reason, the <code class="language-plaintext highlighter-rouge">RegistryEntryRemovedCallback</code> event and the <code class="language-plaintext highlighter-rouge">registeyEntryRemoved</code> shortcut in <code class="language-plaintext highlighter-rouge">DynamicRegistryView</code> were removed.</p>
<p>Finally, <code class="language-plaintext highlighter-rouge">SculkSensorFrequencyRegistry.register</code> now takes <code class="language-plaintext highlighter-rouge">RegistryKey&lt;GameEvent&gt;</code> instead of <code class="language-plaintext highlighter-rouge">GameEvent</code>.
</p>
<h3 id="blocks">Blocks</h3>
<p>All <code class="language-plaintext highlighter-rouge">AbstractBlock</code> public methods to be overridden were made <code class="language-plaintext highlighter-rouge">protected</code> and no longer marked as <code class="language-plaintext highlighter-rouge">@Deprecated</code>.
</p>
<div class="language-diff highlighter-rouge">
<div class="highlight">
<pre class="highlight">
  <code>
    <span class="gd">- public ActionResult onUse(BlockState state, World world, BlockPos pos, PlayerEntity entity, BlockHitResult hit) { </span>
    <span class="gi">+ protected ActionResult onUse(BlockState state, World world, BlockPos pos, PlayerEntity entity, BlockHitResult hit) { </span>
    <span class="err">}</span>
  </code>
</pre>
</div>
</div>
<h3 id="enchantments">Enchantments</h3>
<p>
<code class="language-plaintext highlighter-rouge">Enchantment</code> constructor now takes <code class="language-plaintext highlighter-rouge">Enchantment.Properties</code>, a record of enchantment properties. <code class="language-plaintext highlighter-rouge">EnchantmentTarget</code> enum was replaced with tags that specifies enchantment-supporting items.</p>
<h3 id="brewing">Brewing</h3>
<p>
<code class="language-plaintext highlighter-rouge">FabricBrewingRecipeRegistry</code> was replaced with <code class="language-plaintext highlighter-rouge">FabricBrewingRecipeRegistryBuilder</code>. The new <code class="language-plaintext highlighter-rouge">FabricBrewingRecipeRegistryBuilder.BUILD</code> event can be used to add new recipes to the brewing stand.</p>
<h3 id="entities">Entities</h3>
<p>
<code class="language-plaintext highlighter-rouge">SpawnRestriction.Location</code> enum was replaced with an interface, <code class="language-plaintext highlighter-rouge">SpawnLocation</code>.<code class="language-plaintext highlighter-rouge">SpawnLocationTypes</code> provides predefined <code class="language-plaintext highlighter-rouge">SpawnLocation</code>s.</p>
<h3 id="client">Client</h3>
<p>In GUI, setting the initial focus of a screen is now done by overriding <code class="language-plaintext highlighter-rouge">setInitialFocus</code>, rather than calling it in <code class="language-plaintext highlighter-rouge">init</code>.<code class="language-plaintext highlighter-rouge">MatrixStack</code> was replaced with the actual matrix in several rendering code.</p>
<h4 id="rendering">Rendering</h4>
<p>Some places that previously take <code class="language-plaintext highlighter-rouge">rgb</code> was updated to take <code class="language-plaintext highlighter-rouge">argb</code> instead. The new <code class="language-plaintext highlighter-rouge">DyedColorComponent</code> takes <code class="language-plaintext highlighter-rouge">argb</code>. Item color providers also take <code class="language-plaintext highlighter-rouge">argb</code> instead of <code class="language-plaintext highlighter-rouge">rgb</code>, so make sure to wrap your color with <code class="language-plaintext highlighter-rouge">ColorHelper.Argb.fullAlpha()</code> or else your item may appear transparent if it is registered to the translucent render layer. Block color providers also <code class="language-plaintext highlighter-rouge">argb</code> now, but passing <code class="language-plaintext highlighter-rouge">rgb</code> still works.</p>
<h3 id="other">Other</h3>
<p>DataFixerUpper was updated. This includes several breaking changes, such as <code class="language-plaintext highlighter-rouge">MapCodec</code> being used in places defining extra fields. Use <code class="language-plaintext highlighter-rouge">RecordCodecBuilder#mapCodec</code> instead of <code class="language-plaintext highlighter-rouge">create</code> in this case. Another significant change: <code class="language-plaintext highlighter-rouge">optionalFieldOf</code> is now strict by default. This means that a decoding error in the field value is now treated as an error, instead of being silently skipped. The <code class="language-plaintext highlighter-rouge">lenientOptionalFieldOf</code> method restores old behavior.</p>
<p>On the Minecraft game code side, <code class="language-plaintext highlighter-rouge">Util#getResult</code> was replaced with <code class="language-plaintext highlighter-rouge">decode(...).getOrThrow()</code> method. Several methods and fields in <code class="language-plaintext highlighter-rouge">Codecs</code> were moved to the DFU itself, such as <code class="language-plaintext highlighter-rouge">either</code>,<code class="language-plaintext highlighter-rouge">xor</code>, and <code class="language-plaintext highlighter-rouge">withAlternative</code> (formerly <code class="language-plaintext highlighter-rouge">Codecs#alternatively</code>).
</p>
</content>
<author>
<name/>
</author>
<summary type="html">Minecraft 1.20.5 is to be released in the near future with significant changes affecting mod makers.</summary>
</entry>
<entry>
<title type="html">Fabric for Minecraft 1.20.3 &amp; 1.20.4</title>
<link href="https://fabricmc.net/2023/11/30/1203.html" rel="alternate" type="text/html" title="Fabric for Minecraft 1.20.3 &amp; 1.20.4"/>
<published>2023-11-30T00:00:00+00:00</published>
<updated>2023-11-30T00:00:00+00:00</updated>
<id>https://fabricmc.net/2023/11/30/1203</id>
<content type="html" xml:base="https://fabricmc.net/2023/11/30/1203.html">
<p>It’s only been two months since we published the last article on Minecraft updates, but here we are. Minecraft 1.20.3 is to be released in the near future with some changes affecting mod makers.</p>
<p>As usual, we ask players to be patient, and give mod developers time to update to this new version. Given the rather short interval between updates, some authors may choose to have a rest and skip some versions; we ask everyone kindly not to pester them.</p>
<p>Here is a list of all major modder-facing changes in this version. Note that all code references are using Yarn mappings; modders using alternative mappings may need to use different names.</p>
<h2 id="fabric-changes">Fabric changes</h2>
<p>Fabric is about to celebrate its 5th birthday on December 10th! As we approach this milestone, we’re thrilled to share that our team is actively working on introducing exciting new features and enhancements. The following sections outline some of these advancements.</p>
<p>Developers should use Loom 1.4 (at the time of writing) to develop mods for Minecraft 1.20.3. Players should install the latest stable version of Fabric Loader (currently 0.14.25), or the 0.15 beta if feeling adventurous (see below).</p>
<h3 id="loader-015">Loader 0.15</h3>
<p>Fabric Loader 0.15 has been released recently, which features built-in support for LlamaLad7’s <a href="https://github.com/LlamaLad7/MixinExtras">MixinExtras</a> library. This version is currently in beta. Should you discover compatibility issues with mods that already bundle MixinExtras, please <a href="https://github.com/FabricMC/fabric-loader/issues">file a bug report</a>.
</p>
<p>MixinExtras is a companion library to Mixin, providing <a href="https://github.com/LlamaLad7/MixinExtras/wiki">new annotations</a> to write your mixins in more expressive and compatible ways. It also features an easier way of specifying local captures. Due to its usefulness, MixinExtras is currently being Jar-in-Jar’d by a large amount of mods, increasing modpack sizes. With Fabric Loader bundling it now, all mods can use the library without needing to worry about distribution.</p>
<p>Please note that Fabric Loader 0.15 went through a number of internal changes, notably the transition from <a href="https://github.com/FabricMC/tiny-mappings-parser">TMP</a> to <a href="https://github.com/FabricMC/mapping-io">Mapping-IO</a> and improvements to the lazy mapping loading, which reduce memory consumption. These changes do not affect most users, but mods that depend on unsupported, internal code might break with this update.</p>
<h3 id="loom-14">Loom 1.4</h3>
<p>Loom 1.4 includes enhancement for decompilers, support for deprecated modules in <code class="language-plaintext highlighter-rouge">fabricApi.module</code> (which allows dependencies on individual Fabric API modules), and many more bug fixes and performance improvements. Loom 1.4 requires Gradle 8.3 or later.</p>
<p>Loom now includes built-in support for the Vineflower decompiler. It’s a fork of Fernflower, but with drastically improved output quality compared to the original. CFR remains the default decompiler for the time being. To decompile with Vineflower, use <code class="language-plaintext highlighter-rouge">genSourcesWithVineflower</code> instead of <code class="language-plaintext highlighter-rouge">genSources</code>.
</p>
<p>A new DSL has been introduced to make configuring data generation with best practices easier. This DSL automatically creates a run configuration and optional source set for data generation while also excluding the cache from the built JAR:</p>
<div class="language-gradle highlighter-rouge">
<div class="highlight">
<pre class="highlight">
  <code>
    <span class="n">fabricApi</span>
    <span class="o">{</span>
    <span class="n">configureDataGeneration</span>
    <span class="o">()</span>
    <span class="o">}</span>
  </code>
</pre>
</div>
</div>
<h3 id="new-fabric-api-changes">New Fabric API changes</h3>
<p>With the help of many contributors, Fabric API has received some new features since the last update blog post:</p>
<ul>
<li>Data Generation: add a method to register custom keys with priorities (ErrorCraft) <!-- added after the blogpost, before 1.20.2 release --></li>
<li>Loot API: add <code class="language-plaintext highlighter-rouge">LootTableEvents.LOADED</code> (LLytho)</li>
</ul>
<p>In addition to those new features, this update also contains performance improvements for <code class="language-plaintext highlighter-rouge">PacketType</code>-based networking. It now skips the serialization entirely in singleplayer, and the packet is now serialized on the network thread, not the main thread. Thanks to deirn for making these improvements!</p>
<h3 id="breaking-changes-in-1203">Breaking changes in 1.20.3</h3>
<p>
<code class="language-plaintext highlighter-rouge">BlockSetTypeRegistry</code> and <code class="language-plaintext highlighter-rouge">WoodTypeRegistry</code> of the Object Builder API, previously deprecated, were removed. Please use the builders provided in the same API.</p>
<p>The following APIs in the Transfer API module, all previously deprecated, were removed.</p>
<ul>
<li>
<code class="language-plaintext highlighter-rouge">ContainerItemContext#withInitial</code>
</li>
<li>
<code class="language-plaintext highlighter-rouge">Storage#simulateInsert</code>,<code class="language-plaintext highlighter-rouge">simulateExtract</code>,<code class="language-plaintext highlighter-rouge">exactView</code>
</li>
</ul>
<h2 id="minecraft-changes">Minecraft changes</h2>
<p>Minecraft 1.20.3 introduces some breaking changes to major developer-facing APIs.</p>
<h3 id="block-codecs">Block codecs</h3>
<p>Mojang now uses codecs to serialize blocks - specifically, instances of a particular type of block. You might need to implement the <code class="language-plaintext highlighter-rouge">getCodec</code> method in your <code class="language-plaintext highlighter-rouge">Block</code>s.</p>
<p>However, the block codecs are <strong>currently unused</strong>. This means that you can return <code class="language-plaintext highlighter-rouge">null</code> or throw <code class="language-plaintext highlighter-rouge">UnsupportedOperationException</code> in <code class="language-plaintext highlighter-rouge">getCodec</code> method.</p>
<p>That being said, it is still recommended to familiarize yourself with using codecs, to future-proof your code and prevent potential porting pains in the future.</p>
<h3 id="text">Text</h3>
<p>
<code class="language-plaintext highlighter-rouge">Text</code> also got a codec, and now is serialized using it (including when interacting with Gson). Over the network the text is now sent as an NBT.</p>
<ul>
<li>Important change: <strong>
<code class="language-plaintext highlighter-rouge">Text#translatable</code> now expects all arguments to be numbers, boolean, strings, or other <code class="language-plaintext highlighter-rouge">Text</code>s.</strong> To pass things like <code class="language-plaintext highlighter-rouge">BlockPos</code> or <code class="language-plaintext highlighter-rouge">Identifier</code>, which were previously implicitly converted to strings, use <code class="language-plaintext highlighter-rouge">stringifiedTranslatable</code>.
</li>
<li>For those who have previously used <code class="language-plaintext highlighter-rouge">Codecs.TEXT</code> or <code class="language-plaintext highlighter-rouge">STRINGIFIED_TEXT</code>, it’s time to switch to <code class="language-plaintext highlighter-rouge">TextCodecs.CODEC</code> or <code class="language-plaintext highlighter-rouge">TextCodecs.STRINGIFIED_CODEC</code>.
</li>
<li>
<code class="language-plaintext highlighter-rouge">Text.Serializer</code> inner class was split into <code class="language-plaintext highlighter-rouge">Serializer</code> (to use as a Gson adapter) and <code class="language-plaintext highlighter-rouge">Serialization</code> (contains static methods). The methods were also renamed; <code class="language-plaintext highlighter-rouge">toJson</code> is now <code class="language-plaintext highlighter-rouge">toJsonString</code> to clarify return value.</li>
<li>
<code class="language-plaintext highlighter-rouge">Style.Serializer</code> is gone; it is now <code class="language-plaintext highlighter-rouge">Style.Codecs</code> and holds the codec only.</li>
<li>In related news, <code class="language-plaintext highlighter-rouge">PacketByteBuf#readUnlimitedText</code> was added; this reads an infinite amount of text with no size limit. Most S2C packets now use this.</li>
</ul>
<h3 id="ticks">Ticks</h3>
<p>The <code class="language-plaintext highlighter-rouge">/tick</code> command from the Carpet mod arrived in the vanilla game. This change affects both the server and the client. To support this functionality in your mod:</p>
<ul>
<li>Use <code class="language-plaintext highlighter-rouge">getTickManager().shouldTick()</code> to check if things should tick in your <code class="language-plaintext highlighter-rouge">START_WORLD_TICK</code>/<code class="language-plaintext highlighter-rouge">END_WORLD_TICK</code>/<code class="language-plaintext highlighter-rouge">START_SERVER_TICK</code>/<code class="language-plaintext highlighter-rouge">END_SERVER_TICK</code> event.</li>
<li>
<code class="language-plaintext highlighter-rouge">TickManager</code> can be obtained from <code class="language-plaintext highlighter-rouge">MinecraftServer#getTickManager</code> or <code class="language-plaintext highlighter-rouge">World#getTickManager</code> (works with <code class="language-plaintext highlighter-rouge">ClientWorld</code> as well).</li>
<li>Use <code class="language-plaintext highlighter-rouge">shouldSkipTick</code> for checking if an entity should be ticked (beware, it is the inverse of <code class="language-plaintext highlighter-rouge">shouldTick</code>).
</li>
<li>Note: <strong>You do not need to call these checks inside <code class="language-plaintext highlighter-rouge">Entity</code>/<code class="language-plaintext highlighter-rouge">BlockEntity</code> tick methods or events.</strong> Only call inside server/world tick events.</li>
</ul>
<p>It is also now possible for the game to run faster or slower than 50 MSPT intentionally (as opposed to through lag). Call <code class="language-plaintext highlighter-rouge">TickManager#getMillisPerTick()</code> to determine the intended MSPT.</p>
<h3 id="blocks">Blocks</h3>
<ul>
<li>
<code class="language-plaintext highlighter-rouge">AbstractBlock#randomTick</code> no longer calls <code class="language-plaintext highlighter-rouge">scheduledTick</code>.
</li>
<li>
<code class="language-plaintext highlighter-rouge">BlockSetType</code> received new fields specifying pressure plate activation conditions and button interactions with projectiles/Breezes.</li>
<li>
<code class="language-plaintext highlighter-rouge">ColoredFallingBlock</code> was added, replacing <code class="language-plaintext highlighter-rouge">GravelBlock</code> and <code class="language-plaintext highlighter-rouge">SandBlock</code>.
</li>
<li>
<code class="language-plaintext highlighter-rouge">PowderSnowCauldronBlock</code> was removed; <code class="language-plaintext highlighter-rouge">LeveledCauldronBlock</code> handles the logic now.</li>
<li>
<code class="language-plaintext highlighter-rouge">TransparentBlock</code> was split into <code class="language-plaintext highlighter-rouge">TranslucentBlock</code>, which renders in a translucent way (like slime and ice blocks), and <code class="language-plaintext highlighter-rouge">TransparentBlock</code>, which extends <code class="language-plaintext highlighter-rouge">TranslucentBlock</code> and is used by grates and glass blocks. <code class="language-plaintext highlighter-rouge">AbstractGlassBlock</code> and <code class="language-plaintext highlighter-rouge">GlassBlock</code> were removed.</li>
<li>
<code class="language-plaintext highlighter-rouge">FernBlock</code> is renamed to <code class="language-plaintext highlighter-rouge">ShortPlantBlock</code>.
</li>
<li>
<code class="language-plaintext highlighter-rouge">SaplingGenerator</code> is now in <code class="language-plaintext highlighter-rouge">block</code> package, and individual generator classes were removed and replaced with fields.</li>
<li>
<code class="language-plaintext highlighter-rouge">AbstractBlock#onStateReplaced</code> implementations for block entities were consolidated to <code class="language-plaintext highlighter-rouge">ItemScatterer#onStateReplaced</code>. Make sure to call <code class="language-plaintext highlighter-rouge">super</code> AFTER calling <code class="language-plaintext highlighter-rouge">ItemScatterer</code>.
</li>
<li>
<code class="language-plaintext highlighter-rouge">LootableContainerBlockEntity</code> logics were split into <code class="language-plaintext highlighter-rouge">LootableInventory</code>.<code class="language-plaintext highlighter-rouge">checkLootInteraction</code> was renamed to <code class="language-plaintext highlighter-rouge">generateLoot</code>.<code class="language-plaintext highlighter-rouge">LootableContainerBlockEntity</code> still implements <code class="language-plaintext highlighter-rouge">LootableInventory</code>, but this allows other block entities like decorated pots to share the logic.</li>
</ul>
<h3 id="entities">Entities</h3>
<ul>
<li>Boats, minecarts, and other player-constructed vehicles should now extend <code class="language-plaintext highlighter-rouge">VehicleEntity</code>. This provides the wobble effect seen when hitting that entity.</li>
<li>Various non-living entities (including projectiles and TNT) received <code class="language-plaintext highlighter-rouge">copyFrom</code> override to copy the owner.</li>
<li>
<code class="language-plaintext highlighter-rouge">PersistentProjectileEntity</code> and its subclasses now take the <code class="language-plaintext highlighter-rouge">ItemStack</code> in the constructor, representing the item stack form that players can pick up. <code class="language-plaintext highlighter-rouge">getItemStack</code> returns the stack as-is, while <code class="language-plaintext highlighter-rouge">asItemStack</code> returns a copy (potentially reflecting the changes like potion override).</li>
<li>
<code class="language-plaintext highlighter-rouge">SpawnReason</code> got two methods: <code class="language-plaintext highlighter-rouge">isAnySpawner</code> (spawner &amp; trial spawner) and <code class="language-plaintext highlighter-rouge">isTrialSpawner</code>.<code class="language-plaintext highlighter-rouge">canSpawn</code> methods should check <code class="language-plaintext highlighter-rouge">isAnySpawner</code>, and make the entity exempt from biome/height requirements imposed for natural spawn.</li>
</ul>
<h3 id="client">Client</h3>
<ul>
<li>
<code class="language-plaintext highlighter-rouge">PopupScreen</code> was added. This screen, unlike other screens, renders on top of an existing screen. The popup can include a message, an image, and buttons (such as “Open Link”). To create an instance, use <code class="language-plaintext highlighter-rouge">Builder</code>.
</li>
<li>
<code class="language-plaintext highlighter-rouge">CheckboxWidget</code> is now built using a builder.</li>
<li>
<code class="language-plaintext highlighter-rouge">EntryListWidget</code> no longer takes the bottom coordinate in the constructor. It also actually became a <code class="language-plaintext highlighter-rouge">Widget</code>.
</li>
<li>
<code class="language-plaintext highlighter-rouge">ClickableWidget#render</code> was made <code class="language-plaintext highlighter-rouge">final</code> to prevent overrides of that method from not calling <code class="language-plaintext highlighter-rouge">super.render</code> and preventing the tooltip from rendering. Subclasses must override <code class="language-plaintext highlighter-rouge">renderWidget</code> instead.</li>
</ul>
<h3 id="misc">Misc</h3>
<ul>
<li>
<code class="language-plaintext highlighter-rouge">CommandManager#execute</code> methods no longer return an integer return value. To get the return value, use <code class="language-plaintext highlighter-rouge">ServerCommandSource#withReturnValueConsumer</code>.
</li>
<li>
<code class="language-plaintext highlighter-rouge">RecipeProvider</code> methods received some changes. Some JSON builders and <code class="language-plaintext highlighter-rouge">generateCookingRecipes</code> now require passing the constructor of recipe class, like <code class="language-plaintext highlighter-rouge">CampfireCookingRecipe::new</code>. Other builders no longer require the serializer.</li>
<li>
<code class="language-plaintext highlighter-rouge">EntityType#HEROBRINE</code> was removed. (Wait, was this ever added in the first place?)</li>
</ul>
</content>
<author>
<name/>
</author>
<summary type="html">It’s only been two months since we published the last article on Minecraft updates, but here we are. Minecraft 1.20.3 is to be released in the near future with some changes affecting mod makers.</summary>
</entry>
</feed>
